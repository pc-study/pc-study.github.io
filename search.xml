<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Oracle 查询如何做到 “四大皆空“（BUG）</title>
      <link href="/post/3588be57.html"/>
      <url>/post/3588be57.html</url>
      
        <content type="html"><![CDATA[<h1 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h1><p>首先，我们看一张图，我称之为 “四大皆空”，此图来源于 <a href="https://www.modb.pro/u/6583">刘晨</a> 的视频分享 <a href="https://www.modb.pro/video/5098">Oracle中新增字段的点点滴滴</a>，很有意思，从图中可以发现两段 SQL，看看一下这张图有什么奇怪的地方！</p><p><img src="https://img-blog.csdnimg.cn/ff3cff0c41224cc0b920dc17c67f2868.png"></p><p><em><strong>本文参考资料：</strong></em></p><ul><li><a href="http://yangtingkun.net/?p=1481">非空字段空值对查询的影响</a></li><li><a href="http://yangtingkun.net/?p=1483">非空字段空值的产生</a></li><li><a href="https://www.modb.pro/video/5098">Oracle中新增字段的点点滴滴</a></li></ul><h2 id="SQL-分析"><a href="#SQL-分析" class="headerlink" title="SQL 分析"></a>SQL 分析</h2><p><strong>第一段 SQL：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> c1 <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">no</span> <span class="keyword">rows</span> selected</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> c1 <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line">IDNAMEC1</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line"><span class="number">1</span>a</span><br></pre></td></tr></table></figure><ul><li>有一张 test 表有个 c1 字段；</li><li>当查询 c1 字段值为空时，没有记录返回，得出结论：<strong>test 表中不存在 c1 字段值为空的数据；</strong></li><li>当查询 c1 字段值不为空时，有一条记录返回，且 c1 字段是空值，得出结论：<strong>test 表中存在 c1 字段值不能空，但是 c1 字段值返回是空值？</strong></li></ul><p><strong><font color='orange'>看完第一段 SQL，是不是已经产生疑惑    😵？</font></strong> 先不急，接着看第二段 SQL！</p><p><strong>第二段 SQL：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> dump(c1) <span class="keyword">as</span> d <span class="keyword">from</span> test;</span><br><span class="line">D</span><br><span class="line"><span class="comment">-------</span></span><br><span class="line"><span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> nvl(c1,<span class="string">&#x27;is null&#x27;</span>) <span class="keyword">as</span> c1 <span class="keyword">from</span> test;</span><br><span class="line">C1</span><br><span class="line"><span class="comment">-------</span></span><br><span class="line"><span class="keyword">IS</span> <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure><ul><li>同一张 test 表的相同字段 c1；</li><li>当使用 <a href="https://docs.oracle.com/cd/E11882_01/server.112/e41084/functions055.htm#SQLRF00635">DUMP 函数</a> 来判断 c1 的值，返回值为空，根据官方文档描述：<strong>If expr is null, then this function returns NULL</strong>，可以得出结论：<strong>c1 字段值为空</strong>。</li><li>当使用 <a href="https://docs.oracle.com/cd/E11882_01/server.112/e41084/functions119.htm#SQLRF00684">NVL 函数</a> 来判断 c1 的值，返回值为 IS NULL，根据官方文档描述：<strong>If expr1 is null, then NVL returns expr2. If expr1 is not null, then NVL returns expr1</strong> ，得出结论：<strong>c1 字段值为空</strong>。</li></ul><p>看完第二段 SQL，得出统一的结论就是： <strong><font color='red'>c1 字段值为空。</font></strong></p><p>根据上面两段 SQL 的结论，也就有了上图中的 <code>where PK dump/nvl？</code> 的疑问，那么到底是什么导致的这个问题呢？</p><h1 id="猜测实践"><a href="#猜测实践" class="headerlink" title="猜测实践"></a>猜测实践</h1><p>首先，这明显不是一个正常的操作能够导致的问题，所以首先排除插入空值到非空字段的情况，需要从其他的思路的进行探讨。</p><p>通过 dbms_metadata.get_ddl 函数获取 test 表结构的定义：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dbms_metadata.get_ddl(<span class="string">&#x27;TABLE&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line">DBMS_METADATA.GET_DDL(<span class="string">&#x27;TABLE&#x27;</span>,<span class="string">&#x27;TEST&#x27;</span>)</span><br><span class="line"><span class="comment">--------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> &quot;TEST&quot;.&quot;TEST&quot;</span><br><span class="line">( &quot;ID&quot; NUMBER,</span><br><span class="line">&quot;NAME&quot; VARCHAR2(<span class="number">8</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;a&#x27;</span>,</span><br><span class="line">&quot;C1&quot; VARCHAR2(<span class="number">8</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> ENABLE</span><br><span class="line">) SEGMENT CREATION IMMEDIATE</span><br><span class="line">PCTFREE <span class="number">10</span> PCTUSED <span class="number">40</span> INITRANS <span class="number">1</span> MAXTRANS <span class="number">255</span></span><br><span class="line">NOCOMPRESS LOGGING</span><br><span class="line">STORAGE(<span class="keyword">INITIAL</span> <span class="number">65536</span> NEXT <span class="number">1048576</span> MINEXTENTS <span class="number">1</span> MAXEXTENTS <span class="number">2147483645</span></span><br><span class="line">PCTINCREASE <span class="number">0</span> FREELISTS <span class="number">1</span> FREELIST <span class="keyword">GROUPS</span> <span class="number">1</span></span><br><span class="line">BUFFER_POOL <span class="keyword">DEFAULT</span> FLASH_CACHE <span class="keyword">DEFAULT</span> CELL_FLASH_CACHE <span class="keyword">DEFAULT</span>)</span><br><span class="line">TABLESPACE &quot;USERS&quot;</span><br></pre></td></tr></table></figure><p><strong>小知识拓展：</strong></p><ul><li>Oracle 数据库中，对于 char 和 varchar2 字段来说，缺省值 ‘’ 就是 null；</li><li>但是 where 条件后的 ‘’ 不等于 null。</li></ul><p>可以发现，<strong>c1 字段是非空字段，且默认值为空。</strong> 为什么 Oracle 会允许空值插入到非空约束字段中？</p><p><font color='orage'><strong>想要搞明白原因，光靠猜测是没有用的，实践是检验真理的唯一标准。</strong></font></p><h2 id="猜测一"><a href="#猜测一" class="headerlink" title="猜测一"></a>猜测一</h2><p>有没有可能是，插入记录时有非空约束的列默认为空导致：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> TEST (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> TEST (id, name) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="operator">*</span></span><br><span class="line">ERROR <span class="keyword">at</span> line <span class="number">1</span>:</span><br><span class="line">ORA<span class="number">-01400</span>: cannot <span class="keyword">insert</span> <span class="keyword">NULL</span> <span class="keyword">into</span> (&quot;TEST&quot;.&quot;TEST&quot;.&quot;C1&quot;)</span><br></pre></td></tr></table></figure><p>可以看到插入报错了，说明这个思路是错的，此路不通。</p><h2 id="猜测二"><a href="#猜测二" class="headerlink" title="猜测二"></a>猜测二</h2><p>按理来说，Oracle 这么多版本的更新迭代之后，应该不会在 11G 版本还出现这种问题，综上所述，猜测可能是 11G 的新特性导致的 BUG。</p><p>查询官方文档中的 11G 新特性 <a href="https://docs.oracle.com/cd/B28359_01/server.111/b28279/chapter1.htm#OBJECTIVENO04548">Enhanced ADD COLUMN Functionality</a> 可以发现：</p><p><img src="https://img-blog.csdnimg.cn/1b007114c5e14038b61248a96e4b03d9.png"></p><p>在 11G 版本中，当添加带有默认值且非空约束的列时，不直接更新当前表的所有记录的该列默认值，而是将数据存储到数据字典中的 sys.col$ 表中，后续执行 DML 操作时会自动更新该列默认值。</p><p>接下来就是用新特性来测试一下，首先创建 TEST 表，不包含 C1 字段：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TEST (ID NUMBER, NAME VARCHAR2(<span class="number">8</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;a&#x27;</span>);</span><br></pre></td></tr></table></figure><p>手动添加 c1 列（非空约束+默认值为空）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> TEST <span class="keyword">add</span> c1 varchar2(<span class="number">8</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><p>再次查询：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> c1 <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line">IDNAMEC1</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line"><span class="number">1</span>a</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/8e173906ecef40f685202433ff815461.png"></p><p><strong>破案了</strong>，函数是对的，c1 字段值在默认的情况下确实为空，NOT NULL 列的默认值为 NULL，如果不指定默认值那么就相当于默认值为 NULL。</p><h1 id="深入研究"><a href="#深入研究" class="headerlink" title="深入研究"></a>深入研究</h1><p>上面通过猜测和实践得出了问题的原因，但还是有些不明所以：</p><ul><li>where PK dump&#x2F;nvl？函数的结果是对的，where 真的错了吗？</li><li>为什么要引入 Enhanced ADD COLUMN Functionality 新特性？</li><li><code>.......</code></li></ul><h2 id="Where-错了吗？"><a href="#Where-错了吗？" class="headerlink" title="Where 错了吗？"></a>Where 错了吗？</h2><p>通过 ”四大皆空“ 图看起来，使用 Where 条件返回了错误的数据，CBO 那么聪明，执行计划判断不出来？</p><p><img src="https://img-blog.csdnimg.cn/fdf3e897690441969b6ba6e13f1a7db8.png"></p><p><strong>第一个 SQL：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> c1 <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">no</span> <span class="keyword">rows</span> selected</span><br></pre></td></tr></table></figure><p>分析：当查询条件 c1 为空时，CBO 给出一个谓词 filter 过滤条件 <strong><code>NULL IS NOT NULL</code><strong>，这意味着</strong>查询条件恒假</strong>，当一个查询条件恒假的时候，Oracle 不需要真正执行语句，所以看到 <strong>Cost（%CPU）</strong> 为 0，所以当一个查询条件明显的违反表中的约束条件时，Oracle 并不会去执行这个查询语句，而是直接返回了 0 条记录。</p><p><strong>第二个 SQL 的执行计划：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test <span class="keyword">where</span> c1 <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line">IDNAMEC1</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line"><span class="number">1</span>a</span><br></pre></td></tr></table></figure><p>分析：当查询条件为 c1 不为空时，执行计划中并没有 filter 谓词条件，为什么呢？因为 c1 字段是非空约束，所以 <strong>CBO</strong> 判读 c1 is not null 这个查询条件是<strong>恒真</strong>的，也就不需要过滤，直接返回所有的数据。</p><p><strong>结论：</strong> 简单的说，导致这个问题的原因是由于错误的数据存储于表中，而这导致了 CBO 在判断时出现了错误，导致和预期相反的结果返回，所以 where 并没有错误，是新特性的 BUG 导致 CBO 的判断错误。</p><h2 id="新特性详解"><a href="#新特性详解" class="headerlink" title="新特性详解"></a>新特性详解</h2><p>Oracle 为什么要引入这个新特性？我们使用 3 种情况的分析一下！</p><ul><li>在 Oracle 11G 之前，向现有表添加一个新列需要修改该表中的所有行，以添加新列。</li><li>Oracle 11G 引入了元数据唯一默认值的概念。将默认子句添加到现有表的非空列，只涉及元数据更改，而不是对表中的所有行进行更改。优化器重写新列的查询，以确保结果与默认定义一致。</li><li>Oracle 12C 则更进一步，允许元数据默认值的强制和可选列。因此，在现有表中添加带有默认子句的新列将被作为一个元数据来处理，而不管该列是否被定义为不为空。这代表了空间保存和性能改进。</li></ul><h3 id="实践演示"><a href="#实践演示" class="headerlink" title="实践演示"></a>实践演示</h3><p>准备测试数据：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test(id number,name varchar2(<span class="number">1</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test <span class="keyword">values</span>(<span class="number">1</span>,a);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> test <span class="keyword">values</span>(<span class="number">2</span>,b);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test;</span><br></pre></td></tr></table></figure><p>通过 dump 操作来查看数据的实时情况：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dbms_rowid.rowid_relative_fno(rowid), dbms_rowid.rowid_block_number(rowid) <span class="keyword">from</span> test;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> dump datafile <span class="number">4</span> block <span class="number">173109</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/601fd39806e340bb90ff55a3ac9e03ec.png"></p><p><strong>第一种情况：增加一个字段，不带默认值，不带非空约束</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test <span class="keyword">add</span> a1 varchar2(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">desc</span> test</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/df697d8100a545249ec8fb8f1a98add6.png"></p><p>当为表增加一个不带默认值，不带非空约束的字段时，已存记录的数据块中不会立刻存储该新增字段：</p><p><img src="https://img-blog.csdnimg.cn/6dac666601f04cf2bfd8ae33a8e49537.png"></p><p>只有当更新字段或插入数据的时候，数据块中才会实际存储：</p><p><strong>更新操作：</strong></p><p><img src="https://img-blog.csdnimg.cn/29b5ace7d033431f8309e0e7a7136e73.png"></p><p><strong>插入操作：</strong></p><p><img src="https://img-blog.csdnimg.cn/5c29fdf0673c4fb1b9a8eb5d6fafdd97.png"></p><p><strong>第二种情况：增加一个字段，带默认值，不带非空约束</strong></p><blockquote><p>📢 注意：针对这种情况，12C 引入了新特性：MetaData-Only DEFAULT Column Values for  NULL Columns</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test <span class="keyword">add</span> a2 varchar2(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">desc</span> test</span><br></pre></td></tr></table></figure><p>Oracle 11g，新增一个带默认值，不带非空约束的字段，会立刻在表的数据块中增加该字段：</p><p><img src="https://img-blog.csdnimg.cn/c3e72035a624467ab24b65b3e3cb8be0.png"></p><p>并执行全表更新的操作，将该值更新为默认值，DDL操作的执行时间和表的数据量相关：</p><p><img src="https://img-blog.csdnimg.cn/f10ce825f9184ba78606ee05dd39c637.png"></p><p><strong>第三种情况：增加一个字段，带默认值，带非空约束</strong></p><blockquote><p>📢 注意：针对这种情况，11G 引入了新特性：Enhanced ADD COLUMN Functionality！</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test <span class="keyword">add</span> a2 varchar2(<span class="number">1</span>) <span class="keyword">default</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">desc</span> test</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/6bf03a9a094645e197a90a84e274fbab.png"></p><p>Oracle 11g，新增一个带默认值，带非空约束的字段，已存记录的数据块中不会立刻存储该新增字段：</p><p><img src="https://img-blog.csdnimg.cn/73f3c5eac10c493fbdb2e6b9364bfadf.png"></p><p>而是将其作为元数据存储在数据字典中的 <code>sys.col$</code> 中：</p><p><img src="https://img-blog.csdnimg.cn/f53c68ae7bbe460c98049e55f374b87f.png"></p><p>同时在 <code>sys.ecol$</code> 中可以看到：</p><p><img src="https://img-blog.csdnimg.cn/ea4c708095754d2494315f73831eae26.png"></p><p>但是，当改变新增列的默认值时，<code>sys.ecol$</code> 的数据不会实时变化，仅存储第一次增加列时的默认值：</p><p><img src="https://img-blog.csdnimg.cn/e45afa4755174f42894c4fb7a730b649.png"></p><p>只有当更新字段或插入数据的时候，数据块才会实际存储：</p><p><img src="https://img-blog.csdnimg.cn/92ec7130ca874602ba99d1286da39f31.png"></p><p><img src="https://img-blog.csdnimg.cn/3fccf24f5cad44caa30f759653b1b49b.png"></p><p>通过这种优化，缩短了DDL执行时间，这就是 Oracle 11G 引入 Enhanced ADD COLUMN Functionality 新特性的原因。</p><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>值得一提的是，Oracle 在 12C 以后已经修复了这个 BUG，增加了如下判断（DEFAULT 为 NULL 是禁止的）：</p><p><img src="https://img-blog.csdnimg.cn/680a70e2672c40a9b38752466686d990.png"></p><p>Oracle 学习路漫漫，茫茫文档需要看，直觉前路要变宽，到头还被 BUG 绊！😂</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>参数详解：Oracle数据库一键自动化部署SHELL脚本</title>
      <link href="/post/b7c5ea64.html"/>
      <url>/post/b7c5ea64.html</url>
      
        <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>在开始讲 Oracle 一键安装脚本之前，我们先简单了解下Oracle单机的通常部署流程：</p><ul><li>安装Linux操作系统</li><li>配置存储，网络</li><li>配置操作系统服务和参数等</li><li>配置Oracle相关用户目录等</li><li>上传解压安装介质</li><li>安装Oracle软件</li><li>创建数据库实例</li><li>数据库实例优化和配置等</li></ul><p><img src="https://img-blog.csdnimg.cn/20210613232723502.png"></p><p>通过上述流程介绍可以发现整个过程的操作步骤涉及很多，如果一行一行命令进行执行安装，即使有标准安装文档，复制粘贴也需要 <font color='red'><b>至少半天</b></font> 的时间完成整个安装。然而，通过 <font color='blue'><b>自动化部署脚本</b></font> 可以轻松在 <font color='red'><b>1小时以内</b></font> 完成整个安装过程，并且整个安装过程 <font color='blue'><b>无需人工干预</b></font>。</p><p>因此自动化部署脚本的由来其实很简单，如上所述：就是为了追求效率，稳定。换种说法就是：偷懒，解放双手。</p><div class="note success flat"><p>有句话说得好：<font color='red'><b>“懒人”推动世界的发展</b></font>。</p></div><h2 id="脚本实现"><a href="#脚本实现" class="headerlink" title="脚本实现"></a>脚本实现</h2><p>说到脚本的实现，由于日常工作中接触 Linux 系统较多，因此在实现脚本时选择了 <b><font color='blue'>Shell命令</font></b> 进行编写，并且仅支持 Linux 操作系统的安装。</p><h3 id="脚本实现过程"><a href="#脚本实现过程" class="headerlink" title="脚本实现过程"></a>脚本实现过程</h3><ul><li>大量的 Oracle 安装部署经验</li><li>标准的 Oracle 安装实施文档</li><li>参考 Oracle 官方文档</li><li>熟悉 Shell 命令的使用</li><li>严谨的程序逻辑思维</li><li>理清 Oracle 安装完整步骤顺序</li><li>按功能模块列出 Oracle 安装步骤</li><li>通过脚本实现各个功能模块</li><li>将所有功能模块组装为一个整体</li><li>无数次的安装测试以及调试修改</li></ul><p>经过一段漫长的测试和部署之后，成熟版本的 Oracle 一键安装脚本就诞生了！</p><h1 id="脚本介绍"><a href="#脚本介绍" class="headerlink" title="脚本介绍"></a>脚本介绍</h1><p>下面我们主要介绍下脚本的功能和参数。</p><h2 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h2><ul><li>支持 Oracle 版本：11GR2、12C、18C、19C</li><li>支持 Linux 版本(x86_64)：6、7、8</li><li>支持安装模式：单机，单机集群，RAC</li><li>帮助命令查看参数</li><li>安装日志记录</li><li>配置操作系统</li><li>安装 Grid 软件</li><li>安装 Oracle 软件</li><li>安装 PSU&amp;&amp;RU 补丁</li><li>创建数据库</li><li>建库后配置优化</li></ul><p><b>以上列举的功能为主要功能，更多功能将通过参数介绍一一列出。</b></p><h2 id="参数介绍"><a href="#参数介绍" class="headerlink" title="参数介绍"></a>参数介绍</h2><p><b>本脚本通过参数来预配置脚本命令，可通过帮助命令来查看有哪些参数：</b></p><div class="note success flat"><p>通过执行 <code>./OracleShellInstall --help</code> 可以查看参数介绍！</p></div><p>主要参数如下所示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">-i,--PUBLICIPPUBLICIP NETWORK ADDRESS</span><br><span class="line">-n,--HOSTNAMEHOSTNAME(orcl)</span><br><span class="line">-o,--ORACLE_SIDORACLE_SID(orcl)</span><br><span class="line">-c,--ISCDBIS CDB OR NOT(TRUE|FALSE)</span><br><span class="line">-pb,--PDBNAMEPDBNAME</span><br><span class="line">-op,--ORAPASSWDORACLE USER PASSWORD(oracle)</span><br><span class="line">-b,--ENV_BASE_DIRORACLE BASE DIR(/u01/app)</span><br><span class="line">-s,--CHARACTERSETORACLE CHARACTERSET(ZHS16GBK|AL32UTF8)</span><br><span class="line">-rs,--ROOTPASSWDROOT USER PASSWORD</span><br><span class="line">-gp,--GRIDPASSWDGRID USER PASSWORD(oracle)</span><br><span class="line">-pb1,--RAC1PUBLICIPRAC NODE ONE PUBLIC IP</span><br><span class="line">-pb2,--RAC2PUBLICIPRAC NODE SECONED PUBLIC IP</span><br><span class="line">-vi1,--RAC1VIPRAC NODE ONE VIRTUAL IP</span><br><span class="line">-vi2,--RAC2VIPRAC NODE SECOND VIRTUAL IP</span><br><span class="line">-pi1,--RAC1PRIVIPRAC NODE ONE PRIVATE IP</span><br><span class="line">-pi2,--RAC2PRIVIPRAC NODE SECOND PRIVATE IP</span><br><span class="line">-pi3,--RAC1PRIVIP1RAC NODE ONE PRIVATE IP</span><br><span class="line">-pi4,--RAC2PRIVIP1RAC NODE SECOND PRIVATE IP</span><br><span class="line">-puf,--RACPUBLICFCNAME        RAC PUBLIC FC NAME</span><br><span class="line">-prf,--RACPRIVFCNAMERAC PRIVATE FC NAME</span><br><span class="line">-prf1,--RACPRIVFCNAME1RAC PRIVATE FC NAME</span><br><span class="line">-si,--RACSCANIPRAC SCAN IP</span><br><span class="line">-dn,--ASMDATANAMERAC ASM DATADISKGROUP NAME(DATA)</span><br><span class="line">-on,--ASMOCRNAMERAC ASM OCRDISKGROUP NAME(OCR)</span><br><span class="line">-<span class="built_in">dd</span>,--DATA_BASEDISKRAC DATADISK DISKNAME</span><br><span class="line">-<span class="built_in">od</span>,--OCRP_BASEDISKRAC OCRDISK DISKNAME</span><br><span class="line">-or,--OCRREDUNRAC OCR REDUNDANCY(EXTERNAL|NORMAL|HIGH)</span><br><span class="line">-dr,--DATAREDUNRAC DATA REDUNDANCY(EXTERNAL|NORMAL|HIGH)</span><br><span class="line">-tsi,   --TIMESERVERIP              RAC TIME SERVER IP</span><br><span class="line">-txh    --TuXingHua                 Tu Xing Hua Install</span><br><span class="line">-udev   --UDEV                      Whether Auto Set UDEV</span><br><span class="line">-dns    --DNS                       RAC CONFIGURE DNS(Y|N)</span><br><span class="line">-dnss   --DNSSERVER                 RAC CONFIGURE DNSSERVER LOCAL(Y|N)</span><br><span class="line">-dnsn   --DNSNAME                   RAC DNSNAME(orcl.com)</span><br><span class="line">-dnsi   --DNSIP                     RAC DNS IP</span><br><span class="line">-m,--ONLYCONFIGOSONLY CONFIG SYSTEM PARAMETER(Y|N)</span><br><span class="line">-g,--ONLYINSTALLGRID ONLY INSTALL GRID SOFTWARE(Y|N)</span><br><span class="line">-w,--ONLYINSTALLORACLE ONLY INSTALL ORACLE SOFTWARE(Y|N)</span><br><span class="line">-ocd,--ONLYCREATEDB        ONLY CREATE DATABASE(Y|N)</span><br><span class="line">-gpa,--GRID RELEASE UPDATEGRID RELEASE UPDATE(32072711)</span><br><span class="line">-opa,--ORACLE RELEASE UPDATEORACLE RELEASE UPDATE(32072711)</span><br></pre></td></tr></table></figure><p><b><font color='blue'>看到上面的参数，是否感觉参数太多，但是这些参数基本都有用，容我一个个慢慢道来：</font></b></p><p><code>-i</code>  全称 PUBLICIP：当前主机用于访问的IP，<b><font color='red'>必填参数</font></b></p><div class="note success flat"><p>使用方式：<code>-i 10.211.55.100</code></p></div><p><code>-n</code> 全称 HOSTNAME：当前主机的主机名，默认值为 orcl。</p><div class="note success flat"><p>使用方式：<code>-n orcl</code></p><p>如果选择rac模式，节点1、2主机名自动取为：orcl01、orcl02。</p><p><img src="https://img-blog.csdnimg.cn/20210614005440752.png"></p></div><p><code>-o</code> 全称 ORACLE_SID：Oracle实例名称，默认值为 orcl。</p><div class="note success flat"><p>使用方式：<code>-o orcl</code></p></div><p><code>-c</code> 全称 ISCDB：判断是否为CDB模式，11GR2不支持该参数，默认值为FALSE。</p><div class="note success flat"><p>使用方式：<code>-c TRUE</code></p></div><p><code>-pb</code> 全称 PDBNAME：创建PDB的名称，11GR2不支持该参数。</p><div class="note success flat"><p>使用方式：<code>-pb pdb01</code></p></div><p><code>-op</code> 全称 ORAPASSWD：oracle用户的密码，默认值为oracle。</p><div class="note success flat"><p>使用方式：<code>-op oracle</code></p></div><p><code>-b</code> 全称 ENV_BASE_DIR：Oracle基础安装目录，默认值为&#x2F;u01&#x2F;app。</p><div class="note success flat"><p>使用方式：<code>-b /u01/app</code></p></div><p><code>-s</code> 全称 CHARACTERSET：Oracle数据库字符集，默认值为AL32UTF8。</p><div class="note success flat"><p>使用方式：<code>-s AL32UTF8</code></p></div><p><b><font color='blue'>以下为RAC模式安装的参数：</font></b></p><p><code>-rs</code> 全称 ROOTPASSWD：root用户的密码，默认值为oracle。</p><div class="note success flat"><p>使用方式：<code>-rs oracle</code></p></div><p><code>-gp</code> 全称 GRIDPASSWD：grid用户的密码，默认值为oracle。</p><div class="note success flat"><p>使用方式：<code>-gp oracle</code></p></div><p><code>-pb1</code> 全称 RAC1PUBLICIP：节点一的主机访问IP，<b><font color='red'>必填参数</font></b> 。</p><div class="note success flat"><p>用方式：<code>-pb1 10.211.55.100</code></p></div><p><code>-pb2</code> 全称 RAC2PUBLICIP：节点二的主机访问IP，<b><font color='red'>必填参数</font></b> 。</p><div class="note success flat"><p>使用方式：<code>-pb2 10.211.55.101</code></p></div><p><code>-vi1</code> 全称 RAC1VIP：节点一的主机虚拟IP，<b><font color='red'>必填参数</font></b> ，与主机访问IP网段必须相同。</p><div class="note success flat"><p>使用方式：<code>-vi1 10.211.55.102</code></p></div><p><code>-vi2</code> 全称 RAC2VIP：节点二的主机虚拟IP，<b><font color='red'>必填参数</font></b> ，与主机访问IP网段必须相同。</p><div class="note success flat"><p>使用方式：<code>-vi2 10.211.55.103</code></p></div><p><code>-pi1</code> 全称 ：RAC1PRIVIP，节点一的主机私有IP，<b><font color='red'>必填参数</font></b> ，可凭借喜好进行自定义。</p><div class="note success flat"><p>使用方式：<code>-pi1 10.10.1.1</code></p></div><p><code>-pi2</code> 全称 ：RAC2PRIVIP，节点二的主机私有IP，<b><font color='red'>必填参数</font></b> ，可凭借喜好进行自定义。</p><div class="note success flat"><p>使用方式：<code>-pi2 10.10.1.2</code></p></div><p><code>-pi3</code> 全称 ：RAC1PRIVIP1，节点一的第二个主机私有IP，<b><font color='blue'>可选参数</font></b> ，可凭借喜好进行自定义。</p><div class="note success flat"><p>使用方式：<code>-pi3 1.1.1.1</code></p></div><p><code>-pi4</code> 全称 ：RAC2PRIVIP1，节点二的第二个主机私有IP，<b><font color='blue'>可选参数</font></b> ，可凭借喜好进行自定义。</p><div class="note success flat"><p>使用方式：<code>-pi4 1.1.1.2</code></p></div><p><code>-puf</code> 全称 ：RACPUBLICFCNAME，主机的访问IP对应的网卡名称，<b><font color='red'>必填参数</font></b> ，节点1，2必须名称一致。</p><div class="note success flat"><p>使用方式：<code>-puf eth0</code></p></div><p><code>-prf</code> 全称 RACPRIVFCNAME：主机的私有IP对应的网卡名称，<b><font color='red'>必填参数</font></b>  ，节点1，2必须名称一致。</p><div class="note success flat"><p>使用方式：<code>-prf eth1</code></p></div><p><code>-prf1</code> 全称 RACPRIVFCNAME1：主机的第二私有IP对应的网卡名称，<b><font color='blue'>可选参数</font></b>  ，节点1，2必须名称一致。</p><div class="note success flat"><p>使用方式：<code>-prf1 eth2</code></p></div><p><code>-si</code> 全称 RACSCANIP：主机的SCANIP，<b><font color='red'>必填参数</font></b> ，与主机访问IP网段必须相同。当配置DNS解析时，最多可支持填写3个IP，通过逗号隔开。</p><div class="note success flat"><p>使用方式：<code>-si 10.211.55.104,10.211.55.105,10.211.55.106</code></p></div><p><code>-dn</code> 全称 ASMDATANAME：ASM数据盘名称，默认值为DATA。</p><div class="note success flat"><p>使用方式：<code>-dn DATA</code></p></div><p><code>-on</code> 全称 ASMOCRNAME：ASM裁决盘名称，默认值为OCR。</p><div class="note success flat"><p>使用方式：<code>-on OCR</code></p></div><p><code>-dd</code> 全称 DATA_BASEDISK：数据盘对应的磁盘名称，<b><font color='red'>必填参数</font></b> 。支持多块磁盘填写，用逗号隔开。</p><div class="note success flat"><p>使用方式：<code>-dd /dev/sdb,/dev/sdc,/dev/sdd</code></p></div><p><code>-od</code> 全称 OCR_BASEDISK：裁决盘对应的磁盘名称，<b><font color='red'>必填参数</font></b> 。支持多块磁盘填写，用逗号隔开。</p><div class="note success flat"><p>使用方式：<code>-od /dev/sde,/dev/sdf</code></p></div><p><code>-or</code> 全称 OCRREDUN：裁决盘的冗余选项，默认值为EXTERNAL。<font color='blue'>冗余选项EXTERNAL、NORMAL、HIGH对应磁盘最小数量为1、3、5。</font></p><div class="note success flat"><p>使用方式：<code>-or EXTERNAL</code></p></div><p><code>-dr</code> 全称 OCRREDUN：裁决盘的冗余选项，默认值为EXTERNAL。<font color='blue'>冗余选项EXTERNAL、NORMAL、HIGH对应磁盘最小数量为1、2、3。</font></p><div class="note success flat"><p>使用方式：<code>-dr EXTERNAL</code></p></div><p><code>-tsi</code> 全称 TIMESERVERIP：时间同步服务器IP，<b><font color='blue'>可选参数</font></b> ，根据实际情况进行填写。</p><div class="note success flat"><p>使用方式：<code>-tsi 10.211.55.200</code></p></div><p><code>-txh</code> 全称 TuXingHua：图形化界面安装，默认值为N。选择Y后将安装图形化界面所需依赖。</p><div class="note success flat"><p>使用方式：<code>-txh Y</code></p></div><p><code>-udev</code> 全称 UDEV：自动配置multipath+UDEV绑盘，默认值为Y。</p><div class="note success flat"><p>使用方式：<code>-udev Y</code></p></div><p><b><font color='blue'>以下参数为配置DNS解析：</font></b></p><p><code>-dns</code> 全称 DNS：配置DNS解析，默认值为N。</p><div class="note success flat"><p>使用方式：<code>-dns N</code></p></div><p><code>-dnss</code> 全称 DNSSERVER：当前主机配置为DNS服务器，默认值为N。前提是 <code>-dns Y</code> 才生效。</p><div class="note success flat"><p>使用方式：<code>-dnss N</code></p></div><p><code>-dnsn</code> 全称 DNSNAME：DNS服务器的解析名称，前提是 <code>-dns Y</code> 才生效。</p><div class="note success flat"><p>使用方式：<code>-dnsn orcl.com</code></p></div><p><code>-dnsi</code> 全称 DNSIP：DNS服务器的IP，前提是 <code>-dns Y</code> 才生效。</p><div class="note success flat"><p>使用方式：<code>-dnsi 10.211.55.200</code></p></div><p><code>-m</code> 全称 ONLYCONFIGOS：仅配置操作系统参数，默认值为N。值为Y时，脚本只执行到操作系统配置完成就结束，不会进行安装，通常可用于图形化安装的初始化。</p><div class="note success flat"><p>使用方式：<code>-m Y</code></p></div><p><code>-g</code> 全称 ONLYINSTALLGRID：仅安装Grid软件，默认值为N。</p><div class="note success flat"><p>使用方式：<code>-g Y</code></p></div><p><code>-w</code> 全称 ONLYINSTALLORACLE：仅安装Oracle软件，默认值为N。</p><div class="note success flat"><p>使用方式：<code>-w Y</code></p></div><p><code>-ocd</code> 全称 ONLYCREATEDB：仅创建Oracle数据库实例，默认值为N。</p><div class="note success flat"><p>使用方式：<code>-ocd Y</code></p></div><p><code>-gpa</code> 全称 GRID RELEASE UPDATE：Grid软件的PSU或者RU补丁的补丁号。</p><div class="note success flat"><p>使用方式：<code>-gpa 32072711</code></p></div><p><code>-opa</code> 全称 ORACLE RELEASE UPDATE：Oracle软件的PSU或者RU补丁的补丁号。</p><div class="note success flat"><p>使用方式：<code>-opa 32072711</code></p></div><p><b><font color='orage'>通过以上的参数介绍，相信大家对脚本的功能已经一览无余了，可以说是非常强大。是不是已经心动不如行动，想要尝试下进行安装了呢？下一章节即将介绍如何使用脚本。</font></b></p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> 11GR2 </category>
          
          <category> 脚本 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> 脚本 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单使用：Oracle数据库一键自动化部署SHELL脚本</title>
      <link href="/post/642e39e8.html"/>
      <url>/post/642e39e8.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我猜很多朋友拿到脚本后一脸懵逼，不知道如何下手，所以打算先教大家用脚本以最便捷的方式在 Linux 上安装一套 Oracle 数据库。</p><p>使用脚本的流程可以参照下方：</p><p><img src="https://img-blog.csdnimg.cn/20210603100942949.png"></p><ul><li><strong>Linux 系统安装可以参考：<a href="https://www.modb.pro/course/article/142?lsId=5898">保姆级 VirtualBox 虚拟机安装 Linux 系统</a></strong></li></ul><p>确保我们已经安装配置好 Linux 系统之后，<strong>就可以直接上命令： <code>./OracleShellInstall.sh -i 10.211.55.100</code></strong></p><p><strong>📢 注意： 最便捷安装方式，默认参数不设置，只需加上主机 IP，即可一键安装 Oracle 数据库。</strong></p><h1 id="环境初始化配置"><a href="#环境初始化配置" class="headerlink" title="环境初始化配置"></a>环境初始化配置</h1><p>本节详细讲解下脚本执行前需要做的一些预配置操作。</p><h2 id="创建软件目录"><a href="#创建软件目录" class="headerlink" title="创建软件目录"></a>创建软件目录</h2><p>软件目录用来存放 Oracle 安装所需的所有软件以及脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /soft</span><br></pre></td></tr></table></figure><p>本文以 &#x2F;soft 为例，以后均以此目录作为演示。</p><h2 id="挂载-Linux-安装镜像"><a href="#挂载-Linux-安装镜像" class="headerlink" title="挂载 Linux 安装镜像"></a>挂载 Linux 安装镜像</h2><p>安装 Oracle 数据库需要安装一些 rpm 依赖包，因此需要挂载 ISO 镜像来配置本地 yum 源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 1.通过cdrom挂载</span></span><br><span class="line">mount /dev/cdrom /mnt</span><br><span class="line"><span class="comment">## 2.通过安装镜像源挂载</span></span><br><span class="line">mount -o loop /soft/rhel-server-7.9-x86_64-dvd.iso /mnt</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210603104047853.png"></p><h2 id="上传安装介质和脚本到软件目录"><a href="#上传安装介质和脚本到软件目录" class="headerlink" title="上传安装介质和脚本到软件目录"></a>上传安装介质和脚本到软件目录</h2><p>本次演示以     11GR2 为例，上传 DB 安装包和脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 一键安装shell脚本</span></span><br><span class="line">140KOracleShellInstall.sh</span><br><span class="line"><span class="comment">## oracle 11GR2官方安装包</span></span><br><span class="line">1.3Gp13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">1.1Gp13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line"><span class="comment">## 授权脚本执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x OracleShellInstall.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210603104132703.png"></p><h2 id="执行安装"><a href="#执行安装" class="headerlink" title="执行安装"></a>执行安装</h2><p>确保以上步骤均已完成后，开始执行脚本安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 10.211.55.100</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210603104254309.png"></p><p><strong>等待5-10分钟左右，安装成功。</strong></p><p><img src="https://img-blog.csdnimg.cn/2021060310483362.png"></p><p><img src="https://img-blog.csdnimg.cn/20210603105049292.png"></p><h2 id="数据库连接使用"><a href="#数据库连接使用" class="headerlink" title="数据库连接使用"></a>数据库连接使用</h2><p>创建连接用户：</p><p><img src="https://img-blog.csdnimg.cn/20210603110123160.png"></p><p>PLSQL 连接：</p><ul><li>PLSQL的安装使用可以参考：<a href="https://www.modb.pro/course/article/142?lsId=5898">PL&#x2F;SQL Developer 安装与配置</a></li></ul><p><img src="https://img-blog.csdnimg.cn/20210603110313601.png"></p><p><img src="https://img-blog.csdnimg.cn/2021060311050120.png"></p><p>至此，体验结束！</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> 11GR2 </category>
          
          <category> 脚本 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> 脚本 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 安装 Oracle 11GR2 数据库保姆级教程</title>
      <link href="/post/6c26f851.html"/>
      <url>/post/6c26f851.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>相信大家第一次接触 Oracle，大都是在 windows 上安装，比较方便快捷，基本上是一直下一步就可以安装成功。然而企业级的数据库，基本上都是安装在 Linux 服务器上，安全且高效。</p><div class="note success flat"><p><strong><font color='orage'>没接触 Linux 的朋友不用害怕，跟着本篇文章一步步操作，安装 Oracle 如喝水般简单且标准。</font></strong></p></div><p>下面我就来手把手教大家如何在 Linux 上安装 Oracle 数据库。</p><p><img src="https://img-blog.csdnimg.cn/20210613232723502.png"></p><h1 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h1><h2 id="Linux系统安装"><a href="#Linux系统安装" class="headerlink" title="Linux系统安装"></a>Linux系统安装</h2><p>安装 Linux 服务器可选择：Centos，Redhat，Oracle Linux。</p><ul><li>RedHat 下载：<a href="https://developers.redhat.com/products/rhel/download">https://developers.redhat.com/products/rhel/download</a></li><li>OracleLinux 下载：<a href="https://yum.oracle.com/oracle-linux-isos.html">https://yum.oracle.com/oracle-linux-isos.html</a></li><li>Centos 下载：<a href="https://vault.centos.org/">https://vault.centos.org/</a></li></ul><p><strong>📢 注意：</strong> 上述 <strong>Linux 安装包</strong> 和 <strong>Oracle 安装包</strong> 可点击链接跳转获取：</p><p><strong>Linux 安装包</strong>： <a href="https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA">https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA</a></p><p><strong>Oracle 安装包</strong>： <a href="https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw">https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw</a></p><p><img src="https://img-blog.csdnimg.cn/20210717224232344.png"></p><p><strong>📢 注意：</strong> Linux 系统的安装本文不做详细演示！</p><h2 id="Linux远程连接工具"><a href="#Linux远程连接工具" class="headerlink" title="Linux远程连接工具"></a>Linux远程连接工具</h2><p>本文将使用 XShell 和 Xftp 工具，安装包可以在官网下载，也可私信博主获取。</p><p>其他工具也可以，比如：<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">putty</a>，<a href="https://www.vandyke.com/download/securecrt/6.7/index.html">SecureCRT</a> 等等工具。</p><div class="note success flat"><p><strong><font color='orage'>本篇博客将演示 RedHat Linux 7.6 版本安装 Oracle 11GR2 版本数据库。</font></strong></p></div><h1 id="Linux主机配置"><a href="#Linux主机配置" class="headerlink" title="Linux主机配置"></a>Linux主机配置</h1><p>安装 <code>Linux</code> 操作系统的步骤此处省略，主机内存 2G ，硬盘 50G 即可。</p><p>使用XShell工具连接Linux主机root用户：</p><p><img src="https://img-blog.csdnimg.cn/20210531151043479.png"></p><h2 id="主机名配置"><a href="#主机名配置" class="headerlink" title="主机名配置"></a>主机名配置</h2><p>如果安装时没有配置主机名，或者想要修改主机名，可以通过以下命令修改：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname orcl</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531151223440.png"></p><h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><p>如果安装时没有配置网络，或者想要修改网络，可以通过以下命令修改：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify eth0 ipv4.addresses 10.211.55.188/24 ipv4.gateway 10.211.55.1 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line">nmcli connection up eth0</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531151411783.png"></p><h2 id="配置Hosts文件"><a href="#配置Hosts文件" class="headerlink" title="配置Hosts文件"></a>配置Hosts文件</h2><p>根据上面配置好的主机名和 IP，配置 hosts 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">##OracleBegin##</span></span><br><span class="line"><span class="string">##Public IP</span></span><br><span class="line"><span class="string">10.211.55.188     orcl</span></span><br><span class="line"><span class="string">##OracleEnd##</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531151526712.png"></p><h2 id="防火墙配置"><a href="#防火墙配置" class="headerlink" title="防火墙配置"></a>防火墙配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531151651455.png"></p><h2 id="Selinux配置"><a href="#Selinux配置" class="headerlink" title="Selinux配置"></a>Selinux配置</h2><p>selinux修改后需要重启主机生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27;</span> /etc/selinux/config</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531151755794.png"></p><h2 id="ISO镜像源配置"><a href="#ISO镜像源配置" class="headerlink" title="ISO镜像源配置"></a>ISO镜像源配置</h2><p><strong>📢 注意：</strong> 需要先挂载主机镜像！</p><p>Parallels Desktop 挂载 Linux 主机镜像：</p><p><img src="https://img-blog.csdnimg.cn/202105311519447.png"></p><p>VMware Workstation 挂载 Linux 镜像：</p><p><img src="https://img-blog.csdnimg.cn/2021053115231055.png">​</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;/etc/yum.repos.d/local.repo</span></span><br><span class="line"><span class="string">[local]</span></span><br><span class="line"><span class="string">name=local</span></span><br><span class="line"><span class="string">baseurl=file:///mnt</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531152447379.png"></p><h2 id="安装Oracle依赖包"><a href="#安装Oracle依赖包" class="headerlink" title="安装Oracle依赖包"></a>安装Oracle依赖包</h2><p>如下依赖包从Oracle官方文档推荐获取：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">yum install -y bc \</span><br><span class="line">binutils \</span><br><span class="line">compat-libcap1 \</span><br><span class="line">compat-libstdc++-33 \</span><br><span class="line">gcc \</span><br><span class="line">gcc-c++ \</span><br><span class="line">elfutils-libelf \</span><br><span class="line">elfutils-libelf-devel \</span><br><span class="line">glibc \</span><br><span class="line">glibc-devel \</span><br><span class="line">ksh \</span><br><span class="line">libaio \</span><br><span class="line">libaio-devel \</span><br><span class="line">libgcc \</span><br><span class="line">libstdc++ \</span><br><span class="line">libstdc++-devel \</span><br><span class="line">libxcb \</span><br><span class="line">libX11 \</span><br><span class="line">libXau \</span><br><span class="line">libXi \</span><br><span class="line">libXtst \</span><br><span class="line">libXrender \</span><br><span class="line">libXrender-devel \</span><br><span class="line">make \</span><br><span class="line">net-tools \</span><br><span class="line">nfs-utils \</span><br><span class="line">smartmontools \</span><br><span class="line">sysstat \</span><br><span class="line">e2fsprogs \</span><br><span class="line">e2fsprogs-libs \</span><br><span class="line">fontconfig-devel \</span><br><span class="line">expect \</span><br><span class="line">unzip \</span><br><span class="line">openssh-clients \</span><br><span class="line">readline* \</span><br><span class="line">psmisc --skip-broken</span><br></pre></td></tr></table></figure><p>检查是否安装成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q bc binutils compat-libcap1 compat-libstdc++-33 gcc gcc-c++ elfutils-libelf elfutils-libelf-devel glibc glibc-devel ksh libaio libaio-devel libgcc libstdc++ libstdc++-devel libxcb libX11 libXau libXi libXtst libXrender libXrender-devel make net-tools nfs-utils smartmontools sysstat e2fsprogs e2fsprogs-libs fontconfig-devel expect unzip openssh-clients readline</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531152856876.png"></p><p>Linux7需要手动安装compat-libstdc++依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531153209642.png"></p><h2 id="配置ZeroConf"><a href="#配置ZeroConf" class="headerlink" title="配置ZeroConf"></a>配置ZeroConf</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##关闭Zeroconf service的服务守护进程</span></span><br><span class="line">systemctl stop avahi-daemon.socket</span><br><span class="line">systemctl stop avahi-daemon.service</span><br><span class="line">systemctl <span class="built_in">disable</span> avahi-daemon.service</span><br><span class="line">systemctl <span class="built_in">disable</span> avahi-daemon.socket</span><br><span class="line"></span><br><span class="line"><span class="comment">##关闭NOZEROCONF</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/etc/sysconfig/network</span></span><br><span class="line"><span class="string">#OracleBegin</span></span><br><span class="line"><span class="string">NOZEROCONF=yes</span></span><br><span class="line"><span class="string">#OracleEnd</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531153907611.png"></p><h2 id="关闭透明大页和numa"><a href="#关闭透明大页和numa" class="headerlink" title="关闭透明大页和numa"></a>关闭透明大页和numa</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/quiet/quiet transparent_hugepage=never numa=off/&#x27;</span> /etc/default/grub</span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021053115420611.png"></p><h2 id="配置系统参数文件"><a href="#配置系统参数文件" class="headerlink" title="配置系统参数文件"></a>配置系统参数文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##计算shmall和shmmax值</span></span><br><span class="line">memTotal=$(grep MemTotal /proc/meminfo | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">totalMemory=$((memTotal / <span class="number">2048</span>))</span><br><span class="line">shmall=$((memTotal / <span class="number">4</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$shmall</span> -lt 2097152 ]; <span class="keyword">then</span></span><br><span class="line">  shmall=2097152</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">shmmax=$((memTotal * <span class="number">1024</span> - <span class="number">1</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$shmmax</span>&quot;</span> -lt 4294967295 ]; <span class="keyword">then</span></span><br><span class="line">  shmmax=4294967295</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$shmall</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$shmmax</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##配置系统参数</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/etc/sysctl.conf</span></span><br><span class="line"><span class="string">#OracleBegin</span></span><br><span class="line"><span class="string">##shmmal&#x27;s Calculation formula: physical memory 8G：(8*1024*1024*1024)/4096=2097152</span></span><br><span class="line"><span class="string">##shmmax&#x27;s Calculation formula: physical memory 8G：(8/2)*1024*1024*1024 -1=4294967295</span></span><br><span class="line"><span class="string">fs.aio-max-nr = 1048576</span></span><br><span class="line"><span class="string">fs.file-max = 6815744</span></span><br><span class="line"><span class="string">kernel.shmall = $shmall</span></span><br><span class="line"><span class="string">kernel.shmmax = $shmmax</span></span><br><span class="line"><span class="string">kernel.shmmni = 4096</span></span><br><span class="line"><span class="string">kernel.sem = 250 32000 100 128</span></span><br><span class="line"><span class="string">net.ipv4.ip_local_port_range = 9000 65500</span></span><br><span class="line"><span class="string">net.core.rmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.rmem_max = 4194304</span></span><br><span class="line"><span class="string">net.core.wmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.wmem_max = 1048576</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##系统参数生效</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531154612937.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531154703153.png"></p><h2 id="配置系统资源限制"><a href="#配置系统资源限制" class="headerlink" title="配置系统资源限制"></a>配置系统资源限制</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/etc/security/limits.conf</span></span><br><span class="line"><span class="string">#OracleBegin</span></span><br><span class="line"><span class="string">oracle soft nofile 1024</span></span><br><span class="line"><span class="string">oracle hard nofile 65536</span></span><br><span class="line"><span class="string">oracle soft stack 10240</span></span><br><span class="line"><span class="string">oracle hard stack 32768</span></span><br><span class="line"><span class="string">oracle soft nproc 2047</span></span><br><span class="line"><span class="string">oracle hard nproc 16384</span></span><br><span class="line"><span class="string">oracle hard memlock 134217728</span></span><br><span class="line"><span class="string">oracle soft memlock 134217728</span></span><br><span class="line"><span class="string">#OracleEnd</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/etc/pam.d/login</span></span><br><span class="line"><span class="string">#OracleBegin</span></span><br><span class="line"><span class="string">session required pam_limits.so</span></span><br><span class="line"><span class="string">session required /lib64/security/pam_limits.so</span></span><br><span class="line"><span class="string">#OracleEnd</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531154952801.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531155119545.png"></p><h2 id="创建用户和组"><a href="#创建用户和组" class="headerlink" title="创建用户和组"></a>创建用户和组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/groupadd -g 54321 oinstall</span><br><span class="line">/usr/sbin/groupadd -g 54322 dba</span><br><span class="line">/usr/sbin/groupadd -g 54323 oper</span><br><span class="line"></span><br><span class="line">/usr/sbin/useradd -u 54321 -g oinstall -G dba,oper oracle</span><br><span class="line"><span class="built_in">echo</span> oracle | passwd --stdin oracle</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531155644693.png"></p><h2 id="创建Oracle安装目录"><a href="#创建Oracle安装目录" class="headerlink" title="创建Oracle安装目录"></a>创建Oracle安装目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/product/11.2.0/db</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oraInventory</span><br><span class="line"><span class="built_in">mkdir</span> -p /oradata</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /oradata</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /u01/app</span><br><span class="line"><span class="built_in">chmod</span> -R 775 /u01/app</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531155929742.png"></p><h2 id="配置用户环境变量"><a href="#配置用户环境变量" class="headerlink" title="配置用户环境变量"></a>配置用户环境变量</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;/home/oracle/.bash_profile</span></span><br><span class="line"><span class="string">################OracleBegin#########################</span></span><br><span class="line"><span class="string">umask 022</span></span><br><span class="line"><span class="string">export TMP=/tmp</span></span><br><span class="line"><span class="string">export TMPDIR=\$TMP</span></span><br><span class="line"><span class="string">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span></span><br><span class="line"><span class="string">export ORACLE_BASE=/u01/app/oracle</span></span><br><span class="line"><span class="string">export ORACLE_HOME=/u01/app/oracle/product/11.2.0/db</span></span><br><span class="line"><span class="string">export ORACLE_HOSTNAME=orcl</span></span><br><span class="line"><span class="string">export ORACLE_TERM=xterm</span></span><br><span class="line"><span class="string">export TNS_ADMIN=\$ORACLE_HOME/network/admin</span></span><br><span class="line"><span class="string">export LD_LIBRARY_PATH=\$ORACLE_HOME/lib:/lib:/usr/lib</span></span><br><span class="line"><span class="string">export ORACLE_SID=orcl</span></span><br><span class="line"><span class="string">export PATH=/usr/sbin:\$PATH</span></span><br><span class="line"><span class="string">export PATH=\$ORACLE_HOME/bin:\$ORACLE_HOME/OPatch:\$PATH</span></span><br><span class="line"><span class="string">alias sas=&#x27;sqlplus / as sysdba&#x27;</span></span><br><span class="line"><span class="string">export PS1=&quot;[\`whoami\`@\`hostname\`:&quot;&#x27;\$PWD]\$ &#x27;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531165145782.png"></p><h1 id="Oracle软件安装"><a href="#Oracle软件安装" class="headerlink" title="Oracle软件安装"></a>Oracle软件安装</h1><h2 id="Oracle软件包上传"><a href="#Oracle软件包上传" class="headerlink" title="Oracle软件包上传"></a>Oracle软件包上传</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@orcl soft]<span class="comment"># ll</span></span><br><span class="line">-rw-r--r--. 1 root root 1395582860 May 31 16:56 p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">-rw-r--r--. 1 root root 1151304589 May 31 16:56 p13390677_112040_Linux-x86-64_2of7.zip</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531165942856.png"></p><h2 id="解压Oracle软件安装包"><a href="#解压Oracle软件安装包" class="headerlink" title="解压Oracle软件安装包"></a>解压Oracle软件安装包</h2><p>需要按顺序解压1，2安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">##授权/soft给oracle读写权限</span></span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531170541605.png"></p><h2 id="安装VNC软件"><a href="#安装VNC软件" class="headerlink" title="安装VNC软件"></a>安装VNC软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install -y tigervnc*</span><br><span class="line"></span><br><span class="line">su - oracle</span><br><span class="line">vncserver</span><br><span class="line"><span class="comment">##输入密码</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531171020356.png"></p><h2 id="连接VNC远程工具或者直接打开虚拟机图形化界面"><a href="#连接VNC远程工具或者直接打开虚拟机图形化界面" class="headerlink" title="连接VNC远程工具或者直接打开虚拟机图形化界面"></a>连接VNC远程工具或者直接打开虚拟机图形化界面</h2><p><img src="https://img-blog.csdnimg.cn/20210531171225671.png"></p><p>右键打开终端工具：</p><p><img src="https://img-blog.csdnimg.cn/20210531171326904.png"></p><p>进入 &#x2F;soft&#x2F;database 开始安装 Oracle 软件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./runInstaller -jreLoc /etc/alternatives/jre_1.8.0</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531172656865.png"></p><p>不接收 Oracle 邮件推送：</p><p><img src="https://img-blog.csdnimg.cn/20210531171632653.png"></p><p>不更新 Oracle：</p><p><img src="https://img-blog.csdnimg.cn/20210531171647118.png"></p><p>只安装 Oracle 软件：</p><p><img src="https://img-blog.csdnimg.cn/20210531171701277.png"></p><p>单实例安装：</p><p><img src="https://img-blog.csdnimg.cn/20210531171715452.png"></p><p>选择企业版：</p><p><img src="https://img-blog.csdnimg.cn/20210531171728646.png"></p><p>选择安装目录：</p><p><img src="https://img-blog.csdnimg.cn/20210531171739957.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531171752742.png"></p><p>选择安装用户组：</p><p><img src="https://img-blog.csdnimg.cn/20210531171801876.png"></p><p>Oracle 安装前必要检查：</p><p><img src="https://img-blog.csdnimg.cn/20210531171917550.png"></p><p>上传 pdksh-5.2.14-37.el5.x86_64.rpm 依赖包并安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -e ksh-20120801-142.el7.x86_64</span><br><span class="line">rpm -ivh pdksh-5.2.14-37.el5.x86_64.rpm</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531172054678.png"></p><p>点击再次检查，忽略 Swap 警告：</p><p><img src="https://img-blog.csdnimg.cn/20210531172201548.png"></p><p><img src="https://img-blog.csdnimg.cn/2021053117283651.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531172855489.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531173205684.png"></p><p>解决方案：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">sed -i <span class="string">&#x27;s/^\(\s*\$(MK_EMAGENT_NMECTL)\)\s*$/\1 -lnnz11/g&#x27;</span> <span class="variable">$ORACLE_HOME</span>/sysman/lib/ins_emagent.mk</span><br></pre></td></tr></table></figure><p>执行完点击retry重试：</p><p><img src="https://img-blog.csdnimg.cn/20210531173429769.png"></p><p>执行 root 脚本：</p><p><img src="https://img-blog.csdnimg.cn/20210531173641716.png"></p><p>root用户下执行脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/u01/app/oraInventory/orainstRoot.sh</span><br><span class="line">/u01/app/oracle/product/11.2.0/db/root.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531173926391.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531174056289.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531174122126.png"></p><p>安装完成后，重启主机。</p><h1 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h1><h2 id="打开监听"><a href="#打开监听" class="headerlink" title="打开监听"></a>打开监听</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">lsnrctl start</span><br><span class="line">lsnrctl status</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210531174512675.png"></p><h2 id="连接VNC远程工具或者直接打开虚拟机图形化界面-1"><a href="#连接VNC远程工具或者直接打开虚拟机图形化界面-1" class="headerlink" title="连接VNC远程工具或者直接打开虚拟机图形化界面"></a>连接VNC远程工具或者直接打开虚拟机图形化界面</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021053117492276.png"></p><p>创建数据库：</p><p><img src="https://img-blog.csdnimg.cn/20210531175021476.png"></p><p>选择自定义模式：</p><p><img src="https://img-blog.csdnimg.cn/20210531175036151.png"></p><p>输入实例名：</p><p><img src="https://img-blog.csdnimg.cn/20210531175048186.png"></p><p>这里填写数据库实例名称和 dbname，本次填写 orcl。</p><p><img src="https://img-blog.csdnimg.cn/20210531175240947.png"></p><p>不安装EM工具。</p><p><img src="https://img-blog.csdnimg.cn/20210531175329342.png"></p><p>这里输入SYS和SYSTEM用户的密码，需要记住。</p><p><img src="https://img-blog.csdnimg.cn/20210531175819854.png"></p><p>这里选择前面建好的&#x2F;oradata目录用来存放数据文件。</p><p><img src="https://img-blog.csdnimg.cn/20210531175908479.png"></p><p>不开启闪回日志，不开启归档日志，可以建好库之后再手动修改。</p><p><img src="https://img-blog.csdnimg.cn/20210531175953761.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531180118511.png"></p><p>数据库内存分配，选择手动分配，占用物理内存70%左右。</p><p><img src="https://img-blog.csdnimg.cn/20210531180222432.png"></p><p>block_size根据实际情况选择，一旦建库无法修改，默认8K。</p><p><img src="https://img-blog.csdnimg.cn/20210531180325784.png"></p><p>字符集根据需要进行选择，默认AL32UTF8。</p><p><img src="https://img-blog.csdnimg.cn/20210531180418580.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531180441297.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531180507805.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531180531646.png"></p><p>等待建库完成即可。</p><p><img src="https://img-blog.csdnimg.cn/20210531185121835.png"></p><h1 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h1><p>确保监听正常启动，并监听数据库：</p><p><img src="https://img-blog.csdnimg.cn/20210531185400117.png"></p><h2 id="通过数据库主机连接"><a href="#通过数据库主机连接" class="headerlink" title="通过数据库主机连接"></a>通过数据库主机连接</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">sqlplus / as sysdba</span><br><span class="line">select sysdate from dual;</span><br><span class="line"></span><br><span class="line"><span class="comment">##创建数据库用户</span></span><br><span class="line">create user <span class="built_in">test</span> identified by <span class="built_in">test</span>;</span><br><span class="line">grant dba to <span class="built_in">test</span>;</span><br><span class="line">conn <span class="built_in">test</span>/test</span><br><span class="line"></span><br><span class="line"><span class="comment">##创建表</span></span><br><span class="line">create table <span class="built_in">test</span> (<span class="built_in">id</span> number not null,name varchar2(100));</span><br><span class="line">insert into <span class="built_in">test</span> values (1,<span class="string">&#x27;lucifer&#x27;</span>);</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><h2 id="通过PL-x2F-SQL连接test用户"><a href="#通过PL-x2F-SQL连接test用户" class="headerlink" title="通过PL&#x2F;SQL连接test用户"></a>通过PL&#x2F;SQL连接test用户</h2><p><img src="https://img-blog.csdnimg.cn/20210531190303447.png"></p><p><img src="https://img-blog.csdnimg.cn/20210531190329171.png"></p><p><strong><font color='orage'>至此，Oracle数据库已经安装完毕。</font></strong></p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> 11GR2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Oracle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手把手教你 Linux 安装 MySQL 详细教程</title>
      <link href="/post/afab429f.html"/>
      <url>/post/afab429f.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如何在 Linux 主机一步一步安装 MySQL 数据库？看这篇准没错！</p><p><img src="https://img-blog.csdnimg.cn/20210610002614429.png"></p><h1 id="Linux-服务器安装"><a href="#Linux-服务器安装" class="headerlink" title="Linux 服务器安装"></a>Linux 服务器安装</h1><p><strong>安装Linux服务器可选择：Centos，Redhat，Oracle Linux。</strong></p><p><strong><code>Linux 安装包下载</code>：</strong></p><p>安装 Linux 服务器可选择：Centos，Redhat，Oracle Linux。</p><ul><li>RedHat下载：<a href="https://developers.redhat.com/products/rhel/download">https://developers.redhat.com/products/rhel/download</a></li><li>OracleLinux下载：<a href="https://yum.oracle.com/oracle-linux-isos.html">https://yum.oracle.com/oracle-linux-isos.html</a></li><li>Centos下载：<a href="https://vault.centos.org/">https://vault.centos.org/</a></li></ul><p><strong>📢 注意：</strong> 上述 <strong>Linux 安装包</strong> 可点击链接跳转获取：</p><p><strong>Linux 安装包</strong>： <a href="https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA">https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA</a></p><p>参考官网文档，本次实战环境配置为：</p><ul><li>Redhat 7.9 x86_64</li><li>内存2G</li><li>硬盘50G</li></ul><p><img src="https://img-blog.csdnimg.cn/20210609223736448.png"></p><p><img src="https://img-blog.csdnimg.cn/20210609224031655.png"></p><h1 id="MySQL-安装介质下载"><a href="#MySQL-安装介质下载" class="headerlink" title="MySQL 安装介质下载"></a>MySQL 安装介质下载</h1><p><strong>MySQL 安装包官网下载地址：<a href="https://downloads.mysql.com/archives/community/">MySQL Product Archives</a> ！</strong></p><p>选择版本：</p><ul><li>经典版5.7.20</li><li>Linux-Generic</li><li>glibc-2.12 &amp;&amp; x86-64</li></ul><p><img src="https://img-blog.csdnimg.cn/20210609211435530.png"></p><p>下载完之后，安装包如下：<code>mysql-5.7.20-linux-glibc2.12-x86_64.tar.gz</code>，通过 ftp 工具上传至 Linux 服务器文件夹下。</p><h1 id="MySQL-安装"><a href="#MySQL-安装" class="headerlink" title="MySQL 安装"></a>MySQL 安装</h1><p>安装步骤参考官方文档：<a href="https://dev.mysql.com/doc/refman/5.7/en/binary-installation.html">Installing MySQL on Unix&#x2F;Linux Using Generic Binaries</a></p><h2 id="检查安装介质"><a href="#检查安装介质" class="headerlink" title="检查安装介质"></a>检查安装介质</h2><p>上传安装介质至 &#x2F;soft 目录下：</p><p><img src="https://img-blog.csdnimg.cn/20210609214357647.png"></p><h2 id="解压安装介质"><a href="#解压安装介质" class="headerlink" title="解压安装介质"></a>解压安装介质</h2><p>解压安装介质，并将解压出的文件夹名称修改为 <code>mysql</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">tar -xvf mysql-5.7.20-linux-glibc2.12-x86_64.tar.gz</span><br><span class="line"><span class="built_in">mv</span> mysql-5.7.20-linux-glibc2.12-x86_64 mysql</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609222624344.png"></p><p><img src="https://img-blog.csdnimg.cn/20210609222552662.png"></p><h2 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure><h2 id="建立用户和组"><a href="#建立用户和组" class="headerlink" title="建立用户和组"></a>建立用户和组</h2><p>安装 MySQL 需要创建 mysql 用户：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd -r -g mysql -s /bin/false mysql</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609222915258.png"></p><h2 id="创建相关目录"><a href="#创建相关目录" class="headerlink" title="创建相关目录"></a>创建相关目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /data/mysql</span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql /data</span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql /soft</span><br><span class="line"><span class="built_in">chmod</span> 750 /data</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609223245548.png"></p><h2 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h2><p>配置 root 用户环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt; /root/.bash_profile</span></span><br><span class="line"><span class="string">export PATH=\$PATH:/soft/mysql/bin</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##生效环境变量</span></span><br><span class="line"><span class="built_in">source</span> /root/.bash_profile</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021060923042979.png"></p><h2 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h2><p>配置 yum 源并安装 libaio 包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##挂载镜像源</span></span><br><span class="line">mount /dev/cdrom /mnt</span><br><span class="line"><span class="comment">##配置yum源</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/yum.repos.d/local.repo</span></span><br><span class="line"><span class="string">[local]</span></span><br><span class="line"><span class="string">name=local</span></span><br><span class="line"><span class="string">baseurl=file:///mnt</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##安装依赖包</span></span><br><span class="line">yum install -y libaio</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609225239130.png"></p><h2 id="卸载自带mariadb和mysql"><a href="#卸载自带mariadb和mysql" class="headerlink" title="卸载自带mariadb和mysql"></a>卸载自带mariadb和mysql</h2><ul><li>检查系统是否安装mysql：<code>rpm -qa | grep mysql</code>，因为我是最小化安装所以没有。</li><li>如果有则强制卸载：<code>rpm -e --nodeps $(rpm -qa | grep mysql)</code></li></ul><p><img src="https://img-blog.csdnimg.cn/20210609221149657.png"></p><ul><li>检查系统是否安装mariadb：<code>rpm -qa | grep mariadb</code></li><li>如果有则强制卸载：<code>rpm -e --nodeps $(rpm -qa | grep mariadb)</code>，这里卸载成功。</li></ul><p><img src="https://img-blog.csdnimg.cn/20210609221616590.png"></p><h1 id="MySQL-初始化"><a href="#MySQL-初始化" class="headerlink" title="MySQL 初始化"></a>MySQL 初始化</h1><h2 id="初始化-MySQL-数据库"><a href="#初始化-MySQL-数据库" class="headerlink" title="初始化 MySQL 数据库"></a>初始化 MySQL 数据库</h2><p>通过以下命令初始化创建 MySQL 数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --initialize --user=mysql --basedir=/soft/mysql --datadir=/data/mysql/</span><br></pre></td></tr></table></figure><p>参数： <code>--basedir</code> 为mysql解压目录，<code>--datadir</code> 为mysql数据存放目录。</p><p><img src="https://img-blog.csdnimg.cn/2021060923070866.png"></p><p><strong>📢 注意：这里框出的是root用户的初始密码：<code>yhfvt_rP,24M</code> ！</strong></p><h2 id="配置-my-cnf"><a href="#配置-my-cnf" class="headerlink" title="配置 my.cnf"></a>配置 my.cnf</h2><p>配置 my.cnf 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;/etc/my.cnf</span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string">user=mysql</span></span><br><span class="line"><span class="string">basedir=/soft/mysql</span></span><br><span class="line"><span class="string">datadir=/data/mysql</span></span><br><span class="line"><span class="string">server_id=6</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">socket=/tmp/mysql.sock</span></span><br><span class="line"><span class="string">##客户端</span></span><br><span class="line"><span class="string">[mysql]</span></span><br><span class="line"><span class="string">socket=/tmp/mysql.sock</span></span><br><span class="line"><span class="string">prompt=lucifer [\\\\d]&gt;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609233230196.png"><br>启动 MySQL 服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/soft/mysql/support-files/mysql.server start</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609233308118.png"></p><p><strong><font color='orage'>当然 MySQL 服务也可以配置开机自启动！</font></strong></p><h2 id="配置-MySQL-开机自启"><a href="#配置-MySQL-开机自启" class="headerlink" title="配置 MySQL 开机自启"></a>配置 MySQL 开机自启</h2><p><strong>Linux 6&amp;7 通用配置方式：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /soft/mysql/support-files/mysql.server /etc/init.d/mysqld</span><br><span class="line">chkconfig mysqld on</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609234824245.png"><br>配置完之后就可以用 <code>service mysqld start</code> 启动 MySQL 服务！</p><p><strong>Linux7配置方式：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置mysqld.service文件：</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/usr/lib/systemd/system/mysqld.service</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=MySQL Server</span></span><br><span class="line"><span class="string">Documentation=man:mysqld(8)</span></span><br><span class="line"><span class="string">Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">After=syslog.target</span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=mysql</span></span><br><span class="line"><span class="string">Group=mysql</span></span><br><span class="line"><span class="string">ExecStart=/soft/mysql/bin/mysqld --defaults-file=/etc/my.cnf</span></span><br><span class="line"><span class="string">LimitNOFILE = 5000</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210609235342134.png"></p><p>配置完之后就可以用 <code>systemctl start mysqld</code> 启动mysql服务！</p><p><img src="https://img-blog.csdnimg.cn/20210609235445986.png"></p><h2 id="修改-MySQL-ROOT-密码"><a href="#修改-MySQL-ROOT-密码" class="headerlink" title="修改 MySQL ROOT 密码"></a>修改 MySQL ROOT 密码</h2><p>尝试连接mysql数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pyhfvt_rP,24M</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210610000253651.png"></p><p><strong>由于初始密码不好记，因此需要修改数据库 root 用户初始密码！</strong></p><p>重设 root 密码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqladmin -uroot -pyhfvt_rP,24M password mysql</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210610000945275.png"></p><p>用新密码连接 MySQL 数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pmysql</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210610001439174.png"></p><h2 id="查询测试"><a href="#查询测试" class="headerlink" title="查询测试"></a>查询测试</h2><p>查看当前已创建的数据库：</p><p><img src="https://img-blog.csdnimg.cn/20210610001515952.png"></p><p>查看数据库 MySQL 的用户信息：</p><p><img src="https://img-blog.csdnimg.cn/20210610002358842.png"></p><p><img src="https://img-blog.csdnimg.cn/20210610001900197.png"></p><p><strong><font color='orage'>至此，MySQL 数据库已经安装完毕，可以连接进行测试操作！</font></strong></p>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手滑删错数据，一步步教你如何挽救？</title>
      <link href="/post/90828d04.html"/>
      <url>/post/90828d04.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong><font color='orage'>常在河边走，哪能不湿鞋？</font></strong></p><p>今天有客户联系说误更新数据表，导致数据错乱了，希望将这张表恢复到 <strong>一周前</strong> 的指定时间点。</p><ul><li>数据库版本为 <code>11.2.0.1</code></li><li>操作系统是 <code>Windows64</code></li><li>数据已经被更改超过1周时间</li><li>数据库已开启归档模式</li><li>没有DG容灾</li><li>有RMAN备份</li></ul><p><strong>下面模拟一下问题的详细解决过程！</strong></p><h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p><strong>以下只列出常规恢复手段：</strong></p><ul><li>数据已经误操作超过一周，所以排除使用UNDO快照来找回；</li><li>没有DG容灾环境，排除使用DG闪回；</li><li>主库已开启归档模式，并且存在RMAN备份，可使用RMAN异机恢复表对应表空间，使用DBLINK捞回数据表；</li><li>Oracle 12C后支持单张表恢复；</li></ul><div class="note success flat"><p><strong>结论：</strong> 安全起见，使用RMAN异机恢复表空间来捞回数据表。</p></div><h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>客户希望将表数据恢复到 &lt;2021&#x2F;06&#x2F;08 17:00:00&gt; 之前某个时间点。</p><p><strong><font color='orange'>大致操作步骤如下：</font></strong></p><ul><li>主库查询误更新数据表对应的表空间和无需恢复的表空间。</li><li>新主机安装Oracle 11.2.0.1数据库软件，无需建库，目录结构最好保持一致。</li><li>主库拷贝参数文件，密码文件至新主机，根据新主机修改参数文件和创建新实例所需目录。</li><li>新主机使用修改后的参数文件打开数据库实例到nomount状态。</li><li>主库拷贝备份的控制文件至新主机，新主机使用RMAN恢复控制文件，并且MOUNT新实例。</li><li>新主机RESTORE TABLESPACE恢复至时间点  **&lt;2021&#x2F;06&#x2F;08 16:00:00&gt;**。</li><li>新主机RECOVER DATABASE SKIP TABLESPACE恢复至时间点  **&lt;2021&#x2F;06&#x2F;08 16:00:00&gt;**。</li><li>新主机实例开启到只读模式。</li><li>确认新主机实例的表数据是否正确，若不正确则重复 <strong>第7步</strong> 调整时间点慢慢往 <strong>&lt;2021&#x2F;06&#x2F;08  17:00:00&gt;</strong> 推进恢复。</li><li>主库创建连通新主机实例的DBLINK，通过DBLINK从新主机实例捞取表数据。</li></ul><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>选择表空间恢复是因为主库数据量比较大，如果全库恢复需要大量时间。</p></div><h1 id="测试环境模拟"><a href="#测试环境模拟" class="headerlink" title="测试环境模拟"></a>测试环境模拟</h1><p>为了数据脱敏，因此以测试环境模拟场景进行演示！</p><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>测试环境信息如下：</p><table><thead><tr><th>节点</th><th>主机版本</th><th>主机名</th><th>实例名</th><th>Oracle版本</th><th>IP地址</th></tr></thead><tbody><tr><td>主库</td><td>rhel6.9</td><td>orcl</td><td>orcl</td><td>11.2.0.1</td><td>10.211.55.111</td></tr><tr><td>新主机</td><td>rhel6.9</td><td>orcl</td><td>不创建实例</td><td>11.2.0.1</td><td>10.211.55.112</td></tr></tbody></table><h2 id="模拟测试场景"><a href="#模拟测试场景" class="headerlink" title="模拟测试场景"></a>模拟测试场景</h2><p>主库开启归档模式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 设置归档路径</span></span><br><span class="line">alter system <span class="built_in">set</span> log_archive_dest_1=<span class="string">&#x27;LOCATION=/archivelog&#x27;</span>;</span><br><span class="line"><span class="comment">## 重启开启归档模式</span></span><br><span class="line">shutdown immediate</span><br><span class="line">startup mount</span><br><span class="line">alter database archivelog；</span><br><span class="line"><span class="comment">## 打开数据库</span></span><br><span class="line">alter database open;</span><br></pre></td></tr></table></figure><p>创建测试数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 创建表空间</span></span><br><span class="line">create tablespace lucifer datafile <span class="string">&#x27;/oradata/orcl/lucifer01.dbf&#x27;</span> size 10M autoextend off;</span><br><span class="line">create tablespace ltest datafile <span class="string">&#x27;/oradata/orcl/ltest01.dbf&#x27;</span> size 10M autoextend off;</span><br><span class="line"><span class="comment">## 创建用户</span></span><br><span class="line">create user lucifer identified by lucifer;</span><br><span class="line">grant dba to lucifer;</span><br><span class="line"><span class="comment">## 创建表</span></span><br><span class="line">conn lucifer/lucifer</span><br><span class="line">create table lucifer(<span class="built_in">id</span> number not null,name varchar2(20)) tablespace lucifer;</span><br><span class="line"><span class="comment">## 插入数据</span></span><br><span class="line">insert into lucifer values(1,<span class="string">&#x27;lucifer&#x27;</span>);</span><br><span class="line">insert into lucifer values(2,<span class="string">&#x27;test1&#x27;</span>);</span><br><span class="line">insert into lucifer values(3,<span class="string">&#x27;test2&#x27;</span>);</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210617180444975.png"></p><p>进行数据库全备：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rman target /</span><br><span class="line"><span class="comment">## 进入 rman 后执行以下命令</span></span><br><span class="line">run &#123;</span><br><span class="line">allocate channel c1 device <span class="built_in">type</span> disk;</span><br><span class="line">allocate channel c2 device <span class="built_in">type</span> disk;</span><br><span class="line">crosscheck backup;</span><br><span class="line">crosscheck archivelog all;</span><br><span class="line">sql<span class="string">&quot;alter system switch logfile&quot;</span>;</span><br><span class="line">delete noprompt expired backup;</span><br><span class="line">delete noprompt obsolete device <span class="built_in">type</span> disk;</span><br><span class="line">backup database include current controlfile format <span class="string">&#x27;/backup/backlv0_%d_%T_%t_%s_%p&#x27;</span>;</span><br><span class="line">backup archivelog all DELETE INPUT;</span><br><span class="line">release channel c1;</span><br><span class="line">release channel c2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210617180630264.png"></p><p>模拟数据修改：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">conn lucifer/lucifer</span><br><span class="line">delete from lucifer <span class="built_in">where</span> <span class="built_in">id</span>=1;</span><br><span class="line">update lucifer <span class="built_in">set</span> name=<span class="string">&#x27;lucifer&#x27;</span> <span class="built_in">where</span> <span class="built_in">id</span>=2;</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210617180723979.png"></p><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>为了模拟客户环境，假设无法通过UNDO快照找回，当前删除时间点为：&lt;2021&#x2F;06&#x2F;17 18:10:00&gt;。</p></div><p><strong><font color='orage'>如果使用UNDO快照，比较方便：</font></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 查找UNDO快照数据是否正确</span></span><br><span class="line">select * from lucifer.lucifer as of timestamp to_timestamp(<span class="string">&#x27;2021-06-17 18:05:00&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br><span class="line"><span class="comment">## 将UNDO快照数据捞至新建表中</span></span><br><span class="line">create table lucifer.lucifer_0617 as select * from lucifer.lucifer as of timestamp to_timestamp(<span class="string">&#x27;2021-06-17 18:05:00&#x27;</span>,<span class="string">&#x27;YYYY-MM-DD HH24:MI:SS&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618171123507.png"></p><h1 id="RMAN完整恢复过程"><a href="#RMAN完整恢复过程" class="headerlink" title="RMAN完整恢复过程"></a>RMAN完整恢复过程</h1><p>主库查询误更新数据表对应的表空间和无需恢复的表空间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 查询误更新数据表对应表空间</span></span><br><span class="line">select owner,tablespace_name from dba_segments <span class="built_in">where</span> segment_name=<span class="string">&#x27;LUCIFER&#x27;</span>;</span><br><span class="line"><span class="comment">## 查询所有表空间</span></span><br><span class="line">select tablespace_name from dba_tablespaces;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618141648327.png"></p><p><img src="https://img-blog.csdnimg.cn/2021061814464188.png"></p><p>主库拷贝参数文件，密码文件至新主机，根据新主机修改参数文件和创建新实例所需目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 生成pfile参数文件</span></span><br><span class="line">sqlplus / as sysdba</span><br><span class="line">create pfile=<span class="string">&#x27;/home/oracle/pfile.ora&#x27;</span> from spfile;</span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"><span class="comment">## 拷贝至新主机</span></span><br><span class="line">su - oracle</span><br><span class="line">scp /home/oracle/pfile.ora 10.211.55.112:/tmp</span><br><span class="line">scp <span class="variable">$ORACLE_HOME</span>/dbs/orapworcl 10.211.55.112:<span class="variable">$ORACLE_HOME</span>/dbs</span><br><span class="line"><span class="comment">## 新主机根据实际情况修改参数文件并且创建目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/admin/orcl/adump</span><br><span class="line"><span class="built_in">mkdir</span> -p /oradata/orcl/</span><br><span class="line"><span class="built_in">mkdir</span> -p /archivelog</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /archivelog</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /oradata</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210617163128493.png"></p><p>新主机使用修改后的参数文件打开数据库实例到nomount状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">startup nomount pfile=<span class="string">&#x27;/tmp/pfile.ora&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210617165844780.png"></p><p>主库拷贝备份的控制文件至新主机，新主机使用RMAN恢复控制文件，并且MOUNT新实例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rman target /</span><br><span class="line">list backup of controlfile;</span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"><span class="comment">## 拷贝备份文件至新主机</span></span><br><span class="line">scp /backup/backlv0_ORCL_20210617_107548592* 10.211.55.112:/tmp</span><br><span class="line">scp /u01/app/oracle/product/11.2.0/db/dbs/0c01l775_1_1 10.211.55.112:/tmp</span><br><span class="line"><span class="comment">## 新主机恢复控制文件并开启到mount状态</span></span><br><span class="line">rman target /</span><br><span class="line">restore controlfile from <span class="string">&#x27;/tmp/backlv0_ORCL_20210617_1075485924_9_1&#x27;</span>;</span><br><span class="line">alter database mount;</span><br></pre></td></tr></table></figure><p>通过 <code>list backup of controlfile;</code> 可以看到控制文件位置：</p><p><img src="https://img-blog.csdnimg.cn/20210618135728685.png"></p><p><img src="https://img-blog.csdnimg.cn/20210618143700747.png"></p><p><img src="https://img-blog.csdnimg.cn/20210618141406283.png"></p><p>新主机RESTORE TABLESPACE恢复至时间点 <strong>&lt;2021&#x2F;06&#x2F;17 18:06:00&gt;</strong> ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 新主机注册备份集</span></span><br><span class="line">rman target /</span><br><span class="line">catalog start with <span class="string">&#x27;/tmp/backlv0_ORCL_20210617_107548592&#x27;</span>;</span><br><span class="line">crosscheck backup;</span><br><span class="line">delete noprompt expired backup;</span><br><span class="line">delete noprompt obsolete device <span class="built_in">type</span> disk;</span><br><span class="line"><span class="comment">## 恢复表空间LUCIFER和系统表空间，指定时间点 `2021/06/17 18:06:00`</span></span><br><span class="line">run &#123;</span><br><span class="line">sql <span class="string">&#x27;alter session set nls_date_format=&quot;yyyy-mm-dd hh24:mi:ss&quot;&#x27;</span>;</span><br><span class="line"><span class="built_in">set</span> until time <span class="string">&#x27;2021-06-17 18:06:00&#x27;</span>;</span><br><span class="line">allocate channel ch01 device <span class="built_in">type</span> disk;</span><br><span class="line">allocate channel ch02 device <span class="built_in">type</span> disk;</span><br><span class="line">restore tablespace SYSTEM,SYSAUX,UNDOTBS1,USERS,LUCIFER;</span><br><span class="line">release channel ch01;</span><br><span class="line">release channel ch02;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618160220424.png"></p><p>新主机RECOVER DATABASE SKIP TABLESPACE恢复至时间点 <strong>&lt;2021&#x2F;06&#x2F;17 18:06:00&gt;</strong> ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rman target /</span><br><span class="line">run &#123;</span><br><span class="line">sql <span class="string">&#x27;alter session set nls_date_format=&quot;yyyy-mm-dd hh24:mi:ss&quot;&#x27;</span>;</span><br><span class="line"><span class="built_in">set</span> until time <span class="string">&#x27;2021-06-17 18:06:00&#x27;</span>;</span><br><span class="line">allocate channel ch01 device <span class="built_in">type</span> disk;</span><br><span class="line">recover database skip tablespace LTEST,EXAMPLE;</span><br><span class="line">release channel ch01;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618160604159.png"></p><div class="note warning simple"><p><strong><font color='orage'>这里有一个小BUG：</font></strong> 客户环境是Windows，执行这一步最后报错，手动offline数据文件依然无法开启数据库。</p></div><p><img src="https://img-blog.csdnimg.cn/20210618175704500.png" alt="windows恢复报错"></p><p><strong>解决方案：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 将恢复跳过的表空间都offline drop掉，执行以下查询结果</span></span><br><span class="line">select <span class="string">&#x27;alter database datafile &#x27;</span>|| file_id ||<span class="string">&#x27; offline drop;&#x27;</span> from dba_data_files <span class="built_in">where</span> tablespace_name <span class="keyword">in</span> (<span class="string">&#x27;LTEST&#x27;</span>,<span class="string">&#x27;EXAMPLE&#x27;</span>);</span><br><span class="line"><span class="comment">## 再次开启数据库</span></span><br><span class="line">alter database open <span class="built_in">read</span> only;</span><br></pre></td></tr></table></figure><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>如果显示缺归档日志，可以参考如下步骤：</p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 查询恢复需要的归档日志号时间</span></span><br><span class="line">alter session <span class="built_in">set</span> nls_date_format=<span class="string">&quot;yyyy-mm-dd hh24:mi:ss&quot;</span>;</span><br><span class="line">select first_time,sequence<span class="comment"># from v$archived_log where sequence#=&#x27;7&#x27;;</span></span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"><span class="comment">## 通过备份RESTORE吐出所需的归档日志</span></span><br><span class="line">rman target /</span><br><span class="line">catalog start with <span class="string">&#x27;/tmp/0c01l775_1_1&#x27;</span>;</span><br><span class="line">crosscheck archivelog all;</span><br><span class="line">run &#123;</span><br><span class="line">allocate channel ch01 device <span class="built_in">type</span> disk;</span><br><span class="line">SET ARCHIVELOG DESTINATION TO <span class="string">&#x27;/archivelog&#x27;</span>;</span><br><span class="line">restore ARCHIVELOG SEQUENCE 7;</span><br><span class="line">release channel ch01;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">## 再次recover进行恢复至指定时间点 2021-06-17 18:06:00</span></span><br><span class="line">run &#123;</span><br><span class="line">sql <span class="string">&#x27;alter session set nls_date_format=&quot;yyyy-mm-dd hh24:mi:ss&quot;&#x27;</span>;</span><br><span class="line"><span class="built_in">set</span> until time <span class="string">&#x27;2021-06-17 18:06:00&#x27;</span>;</span><br><span class="line">allocate channel ch01 device <span class="built_in">type</span> disk;</span><br><span class="line">recover database skip tablespace LTEST,EXAMPLE;</span><br><span class="line">release channel ch01;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>新主机实例开启到只读模式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">alter database open <span class="built_in">read</span> only;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618153752398.png"><br>确认新主机实例的表数据是否正确：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">select * from lucifer.lucifer;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618173156452.png"></p><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>若不正确则重复 第7步 调整时间点慢慢往 2021&#x2F;06&#x2F;17 18:10:00 推进恢复：</p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 关闭数据库</span></span><br><span class="line">sqlplus / as sysdba</span><br><span class="line">shutdown immediate;</span><br><span class="line"><span class="comment">## 开启数据库到mount状态</span></span><br><span class="line">startup mount pfile=<span class="string">&#x27;/tmp/pfile.ora&#x27;</span>;</span><br><span class="line"><span class="comment">## 重复 第7步，往前推进1分钟，调整时间点为 `2021/06/08 18:07:00`</span></span><br><span class="line">rman target /</span><br><span class="line">run &#123;</span><br><span class="line">sql <span class="string">&#x27;alter session set nls_date_format=&quot;yyyy-mm-dd hh24:mi:ss&quot;&#x27;</span>;</span><br><span class="line"><span class="built_in">set</span> until time <span class="string">&#x27;2021-06-17 18:07:00&#x27;</span>;</span><br><span class="line">allocate channel ch01 device <span class="built_in">type</span> disk;</span><br><span class="line">recover database skip tablespace LTEST,EXAMPLE;</span><br><span class="line">release channel ch01;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主库创建连通新主机实例的DBLINK，通过DBLINK从新主机实例捞取表数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"><span class="comment">## 创建dblinnk</span></span><br><span class="line">CREATE PUBLIC DATABASE LINK ORCL112</span><br><span class="line">CONNECT TO lucifer</span><br><span class="line">IDENTIFIED BY lucifer</span><br><span class="line">USING <span class="string">&#x27;(DESCRIPTION_LIST=</span></span><br><span class="line"><span class="string">(DESCRIPTION=</span></span><br><span class="line"><span class="string">(ADDRESS=(PROTOCOL=tcp)(HOST=10.211.55.112)(PORT=1521))</span></span><br><span class="line"><span class="string">(CONNECT_DATA=</span></span><br><span class="line"><span class="string">(SERVICE_NAME=orcl)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)&#x27;</span>;</span><br><span class="line"><span class="comment">## 通过dblink捞取数据</span></span><br><span class="line">create table lucifer.lucifer_0618 as select /*+full(lucifer)*/ * from lucifer.lucifer@ORCL112;</span><br><span class="line">select * from lucifer.lucifer_0618;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210618154621621.png"><br><img src="https://img-blog.csdnimg.cn/20210618161111259.png"></p><p><strong><font color='orage'>至此，整个RMAN恢复过程就结束了！</font></strong></p><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>备份永远是最后一道防线，所以备份一定要做好！！！</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> RMAN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> RMAN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle 数据库一键安装，从未如此简单</title>
      <link href="/post/54c2aceb.html"/>
      <url>/post/54c2aceb.html</url>
      
        <content type="html"><![CDATA[<h1 id="Shell-InstallOracle"><a href="#Shell-InstallOracle" class="headerlink" title="Shell-InstallOracle"></a>Shell-InstallOracle</h1><p><strong>为什么要写这个脚本呢？</strong></p><ul><li>首先，安装 Oracle 数据库是一件极为复杂且枯燥的任务；</li><li>常规的操作方式往往是基于文档，博客，视频等教程方式，按部就班的执行安装步骤，耗时费力，且极为容易因为粗心导致各种各样的问题产生；</li><li>于是，我想到可以编写一个基于标准流程的 <code>Shell</code> 脚本来进行安装，因为只要代码没有错误，机器执行是不会出错的；</li><li>经过大量时间的代码编写和运行测试，目前已可以用于生产环境安装部署。</li></ul><p><strong>项目支持哪些平台安装？</strong></p><ul><li>本项目仅支持 「 Linux64-6&#x2F;7&#x2F;8  」 平台：<strong>Centos、Redhat、OracleLinux</strong>。</li><li>支持大部分主流 「 ORACLE 」 版本： <strong>11GR2、12CR2、18C、19C、21C</strong>。</li><li>支持数据库安装模式：单机、单机 ASM、<code>RAC</code> 集群。</li></ul><div class="hide-block"><button type="button" class="hide-button" style="">点我购买脚本    </button><div class="hide-content"><div class="note blue icon modern"><i class="note-icon fas fa-bullhorn"></i><p><a href="https://www.modb.pro/course/148">点我订阅</a>，订阅后添加微信：<code>Lucifer-4622</code>，备注：购买Oracle安装脚本！</p></div></div></div><h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><p>本脚本使用方式分为 <code>新手纯享版本</code> 和 <code>高手进阶版本</code> ，平时学习测试建议使用新手纯享版本即可！</p><div class="tabs" id="oracle一键安装"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#oracle一键安装-1">① 新手纯享版本</button></li><li class="tab"><button type="button" data-href="#oracle一键安装-2">② 高手进阶版本</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="oracle一键安装-1"><p>新手纯享版本基本不需要基础，免安装操作系统，一键拥有 Oracle 数据库！但是必须使用 <code>[vagrant]</code> 和 <code>[virtualbox]</code>，请确保你本地已经安装。</p><ul><li><strong>第一步，上传 Oracle 安装包：</strong></li></ul><p>进入项目目录 <code>InstallOracleshell/single_db/software</code> 下，可以看到有不同 Oracle 版本目录，其中有一个 <code>software.txt</code> 文件，内容为你需要上传的 Oracle 安装包。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">├── 11204</span><br><span class="line">│   ├── p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">│   └── p13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line">├── 12201</span><br><span class="line">│   └── LINUX.X64_122010_db_home.zip</span><br><span class="line">├── 18000</span><br><span class="line">│   └── LINUX.X64_180000_db_home.zip</span><br><span class="line">├── 19300</span><br><span class="line">│   └── LINUX.X64_193000_db_home.zip</span><br><span class="line">├── 21300</span><br><span class="line">│   └── LINUX.X64_213000_db_home.zip</span><br></pre></td></tr></table></figure><p>确认你需要安装的 Oracle 版本，拷贝 Oracle 安装包到对应目录下，<strong>确保安装包名称与以下名称相同，否则安装<font color='red'>失败</font>！</strong></p><ul><li><strong>第二步，编辑 vagrant.yml 配置文件：</strong></li></ul><p>进入项目目录 <code>InstallOracleshell/single_db/config</code> 下，打开 <code>vagrant.yml</code> 文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">box: luciferliu/centos7.9</span><br><span class="line">vm_name: orcl</span><br><span class="line">hostname: orcl</span><br><span class="line">mem_size: 2048</span><br><span class="line">cpus: 2</span><br><span class="line">public_ip: 192.168.56.100</span><br><span class="line">non_rotational: &#x27;on&#x27;</span><br><span class="line">db_version: 11</span><br><span class="line">db_patch:</span><br><span class="line">oracle_password: oracle</span><br><span class="line">oracle_sid: orcl</span><br><span class="line">install_base: /u01/app</span><br><span class="line">characterset: AL32UTF8</span><br><span class="line">cdb: true</span><br><span class="line">pdb: pdb01</span><br></pre></td></tr></table></figure><p><strong>参数介绍：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">box             : Linux 主机版本，19c 和 21c 版本不支持 linux 6 版本！</span><br><span class="line"></span><br><span class="line">可选值：</span><br><span class="line">- luciferliu/centos6.10</span><br><span class="line">- luciferliu/centos7.9</span><br><span class="line">- luciferliu/centos8.3</span><br><span class="line">- luciferliu/oraclelinux6.10</span><br><span class="line">- luciferliu/oraclelinux7.9</span><br><span class="line">- luciferliu/oraclelinux8.3</span><br><span class="line"></span><br><span class="line">vm_name         : 虚拟机名称，随意修改，默认即可。</span><br><span class="line">hostname        : 主机名称，随意修改，默认即可。</span><br><span class="line">mem_size        : 内存大小，单位是 `MiB`，根据需要修改，正常默认即可。</span><br><span class="line">cpus            : cpu 个数，根据需要修改，正常默认即可。</span><br><span class="line">public_ip       : IP 地址，根据网卡定义修改，正常默认即可。</span><br><span class="line">non_rotational    : 不用修改值，默认即可。</span><br><span class="line">db_version      : oracle 数据库版本，根据实际情况填写！</span><br><span class="line">db_patch        : PSU/RU 补丁号，根据需要填写，不打补丁可以不填。</span><br><span class="line">oracle_password   : oracle 用户密码，默认即可。</span><br><span class="line">oracle_sid      : oracle 数据库实例名，默认即可。</span><br><span class="line">install_base      : oracle 安装根目录，默认即可。</span><br><span class="line">characterset      : 数据库字符集，根据实际需要填写，正常默认即可。</span><br><span class="line">cdb             : CDB 模式需要填写 true。</span><br><span class="line">pdb             : PDB 名称，开启 CDB 模式后才可生效。</span><br></pre></td></tr></table></figure><p>根据实际情况修改脚本，默认不修改将安装 <strong>Oracle 11GR2</strong> 数据库。</p><ul><li><strong>第三步，执行 <code>vagrant up</code> 安装：</strong></li></ul><p>回到 <code>InstallOracleshell/single_db</code> 目录下，执行 <code>vagrant up</code> 开始安装。</p><p><strong>📢 注意：</strong> InstallOracleshell&#x2F;single_db&#x2F;software  目录中的 OracleShellInstall.sh 脚本需要保持最新，最新版本脚本在上层目录 InstallOracleshell 下。</p><ul><li><strong>第四步，等待自动安装成功后，连接主机：</strong></li></ul><p>这里有三种方式来连接主机：</p><p>1、使用 <code>ssh root@192.168.56.100</code> 来连接，root 用户密码是 oracle ，使用 Xshell 等连接工具也可连接；</p><p>2、使用 <code>vagrant ssh</code> 来连接，注意要在 <code>InstallOracleshell/single_db</code> 目录下执行，连接进去是 vagrant 用户，使用 <code>su - oracle</code> 来切换即可。</p><p>3、使用 Virtualbox 虚拟机直接打开访问。</p><ul><li><strong>第五步，关闭主机：</strong></li></ul><p>1、在主机中，执行 <code>init 0</code> 等关机命令关闭主机。</p><p>2、使用 Virtualbox 虚拟机右键关闭。</p><p>3、进入  <code>InstallOracleshell/single_db</code> 目录下执行 <code>vagrant halt</code> 关闭。</p><ul><li><strong>最后</strong></li></ul><p>用完了，不需要使用了怎么办？</p><p>1、直接打开 Virtualbox 虚拟机，右键删除。</p><p>2、进入  <code>InstallOracleshell/single_db</code> 目录下执行 <code>vagrant destory</code> 销毁它。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="oracle一键安装-2"><p>正常来说，平时学习测试使用 <code>新手纯享版本</code> 完全够了，但是如果你想使用在 <code>生产环境</code> ，那你必须得学会 <code>高手进阶版本</code> ！真正提高生产力~</p><p>既然看到这的说明都是高手，那就长话短说，进阶版本只需要这一个脚本 <code>OracleShellInstall.sh</code> 就够了！</p><p>脚本有了，具体如何使用？</p><img src="https://img-blog.csdnimg.cn/20210603100942949.png" style="float:left" /><p><strong>📢 前提：</strong> 提前安装 Linux 系统，上传安装介质，挂载 ISO 镜像。</p><h2 id="单机"><a href="#单机" class="headerlink" title="单机"></a>单机</h2><ul><li><p><strong>第一步，</strong> 手动安装 Linux 系统，配置网络，挂载 ISO 镜像；</p></li><li><p><strong>第二步，</strong> 创建 &#x2F;soft 目录，上传安装介质；</p></li><li><p><strong>第三步，</strong> 编辑脚本安装命令，填写关键信息：</p></li></ul><p><code>最简安装</code> 脚本示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 192.168.56.155</span><br></pre></td></tr></table></figure><p><code>单机自定义</code> 脚本命令示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 192.168.56.155 `#Public ip`\</span><br><span class="line">-n topdbdev `# hostname`\</span><br><span class="line">-o topstd `# oraclesid`\</span><br><span class="line">-c TRUE `# ISCDB`\</span><br><span class="line">-pb pdb01 `# PDBNAME`\</span><br><span class="line">-rs oracle `# root password`\</span><br><span class="line">-op oracle `# oracle password`\</span><br><span class="line">-gp oracle `# grid password`\</span><br><span class="line">-b /u01/app `# install basedir`\</span><br><span class="line">-s AL32UTF8 `# characterset`\</span><br><span class="line">-ns UTF8 `# national characterset`</span><br></pre></td></tr></table></figure><ul><li><p><strong>第四步，</strong> <code>root</code> 用户下进入 <code>/soft</code> 目录下执行脚本安装命令；</p></li><li><p><strong>第五步，</strong> 等待安装过程中，可以进入 <code>/soft</code> 目录中查看安装部署日志，安装结束后重启主机；</p></li><li><p><strong>第六步，</strong> 检查数据库运行情况。</p></li></ul><p>脚本中所有操作均为静默连续执行，敲下命令之后无需任何操作，等待安装成功即可。</p><h2 id="单机ASM"><a href="#单机ASM" class="headerlink" title="单机ASM"></a>单机ASM</h2><p><code>单机ASM</code> 脚本命令示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 192.168.56.155 `#Public ip`\</span><br><span class="line">-n topdbdev `# hostname`\</span><br><span class="line">-o topstd `# oraclesid`\</span><br><span class="line">-rs oracle `# root password`\</span><br><span class="line">-op oracle `# oracle password`\</span><br><span class="line">-gp oracle `# grid password`\</span><br><span class="line">-b /u01/app `# install basedir`\</span><br><span class="line">-s AL32UTF8 `# characterset`\</span><br><span class="line">-ns UTF8 `# national characterset`\</span><br><span class="line">-dd /dev/sde `# asm data disk`\</span><br><span class="line">-dn DATA `# asm data diskgroupname`\</span><br><span class="line">-dr EXTERNAL `# asm data redundancy`\</span><br><span class="line">-gpa 31718723 `# Grid PSU NUMBER`</span><br></pre></td></tr></table></figure><h2 id="RAC"><a href="#RAC" class="headerlink" title="RAC"></a>RAC</h2><p>这里我简单说下在生产环境使用脚本部署 <code>    RAC</code> 的大概步骤：</p><ul><li><p><strong>第一步，</strong> 手动安装两台 Linux 主机；</p></li><li><p><strong>第二步，</strong> 分别配置网络，挂载 iso 镜像源，挂载共享存储；</p></li><li><p><strong>第三步，</strong> 节点一创建 &#x2F;soft 目录并上传安装介质；</p></li><li><p><strong>第四步，</strong> 编辑脚本安装命令，填写两台主机的关键信息；</p></li></ul><p><code>RAC</code> 脚本命令示例：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 192.168.56.151 `# node1 Public ip`\</span><br><span class="line">-n topdb `# rac hostname`\</span><br><span class="line">-o TOPDB `# oraclesid`\</span><br><span class="line">-rs oracle `# root password`\</span><br><span class="line">-op oracle `# oracle password`\</span><br><span class="line">-gp oracle `# grid password`\</span><br><span class="line">-b /u01/app `# install basedir`\</span><br><span class="line">-s AL32UTF8 `# characterset`\</span><br><span class="line">-ns UTF8 `# national characterset`\</span><br><span class="line">-pb1 192.168.56.151 -pb2 192.168.56.153 `# node public ip`\</span><br><span class="line">-vi1 192.168.56.152 -vi2 192.168.56.154 `# node virtual ip`\</span><br><span class="line">-pi1 10.10.10.11 -pi2 10.10.10.12 `# node private ip`\</span><br><span class="line">-pi3 10.10.11.11 -pi4 10.10.11.12 `# node private1 ip`\</span><br><span class="line">-si 192.168.56.150 `# scan ip`\</span><br><span class="line">-od /dev/sdb,/dev/sdc,/dev/sdd `# asm ocr disk`\</span><br><span class="line">-dd /dev/sde `# asm data disk`\</span><br><span class="line">-on OCR `# asm ocr diskgroupname`\</span><br><span class="line">-dn DATA `# asm data diskgroupname`\</span><br><span class="line">-or NORMAL `# asm ocr redundancy`\</span><br><span class="line">-dr EXTERNAL `# asm data redundancy`\</span><br><span class="line">-puf team0 -prf em3 -prf1 em4 `# network fcname`\</span><br><span class="line">-tsi 192.168.56.252 `# timeserver`\</span><br><span class="line">-gpa 31718723 `# Grid PSU NUMBER`</span><br></pre></td></tr></table></figure><ul><li><p><strong>第五步，</strong> 节点一 <code>root</code> 用户下进入 <code>/soft</code> 目录下执行脚本安装命令；</p></li><li><p><strong>第六步，</strong> 等待安装过程中，可以进入 <code>/soft</code> 目录中查看安装部署日志，安装结束后重启两台主机；</p></li><li><p><strong>第七步，</strong> 检查两台主机数据库运行情况。</p></li></ul><p>脚本中所有操作均为静默连续执行，敲下命令之后无需任何操作，等待安装成功即可！</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p><strong>整个项目的完整目录：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">├── Documents</span><br><span class="line">│   ├── packer box</span><br><span class="line">│   │   ├── Vagrant Box 镜像准备：Packer 打包 Oracle Linux 6.10 系统.md</span><br><span class="line">│   │   ├── Vagrant Box 镜像准备：Packer 打包 Oracle Linux 8.3 系统.md</span><br><span class="line">│   │   ├── Vagrant Box 镜像准备：Packer 打包 Centos 6.10 系统.md</span><br><span class="line">│   │   ├── Vagrant Box 镜像准备：Packer 打包 Centos 7.9 系统.md</span><br><span class="line">│   │   ├── Vagrant Box 镜像准备：Packer 打包 Centos 8.3 系统.md</span><br><span class="line">│   │   └── Vagrant Box 镜像准备：Packer 打包 Oracle Linux 7.9 系统.md</span><br><span class="line">│   ├── rac_db</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》RAC集群系列 ❶ 简单两步快速安装 Oracle 11GR2 RAC 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》RAC集群系列 ❷ 简单两步快速安装 Oracle 12CR2 RAC 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》RAC集群系列 ❸ 简单两步快速安装 Oracle 18C RAC 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》RAC集群系列 ❹ 简单两步快速安装 Oracle 19C RAC 数据库.md</span><br><span class="line">│   │   └── 《零基础安装 Oracle 数据库》RAC集群系列 ❺ 简单两步快速安装 Oracle 21C RAC 数据库.md</span><br><span class="line">│   ├── single_db</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》单机系列 ① 一键快速安装 Oracle 11GR2 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》单机系列 ② 一键快速安装 Oracle 12CR2 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》单机系列 ③ 一键快速安装 Oracle 18C 数据库.md</span><br><span class="line">│   │   ├── 《零基础安装 Oracle 数据库》单机系列 ④ 一键快速安装 Oracle 19C 数据库.md</span><br><span class="line">│   │   └── 《零基础安装 Oracle 数据库》单机系列 ⑤ 一键快速安装 Oracle 21C 数据库.md</span><br><span class="line">│   └── singleasm_db</span><br><span class="line">│       ├── 《零基础安装 Oracle 数据库》单机ASM系列 1️⃣ 一键快速安装 Oracle 11GR2 数据库.md</span><br><span class="line">│       ├── 《零基础安装 Oracle 数据库》单机ASM系列 2️⃣ 一键快速安装 Oracle 12CR2 数据库.md</span><br><span class="line">│       ├── 《零基础安装 Oracle 数据库》单机ASM系列 3️⃣ 一键快速安装 Oracle 18C 数据库.md</span><br><span class="line">│       ├── 《零基础安装 Oracle 数据库》单机ASM系列 4️⃣ 一键快速安装 Oracle 19C 数据库.md</span><br><span class="line">│       └── 《零基础安装 Oracle 数据库》单机ASM系列 5️⃣ 一键快速安装 Oracle 21C 数据库.md</span><br><span class="line">├── LICENSE</span><br><span class="line">├── OracleShellInstall.sh</span><br><span class="line">├── ParameterREADME.md</span><br><span class="line">├── README.md</span><br><span class="line">├── rac_db</span><br><span class="line">│   ├── README.md</span><br><span class="line">│   ├── Vagrantfile</span><br><span class="line">│   ├── config</span><br><span class="line">│   │   └── vagrant.yml</span><br><span class="line">│   ├── scripts</span><br><span class="line">│   │   └── setup.sh</span><br><span class="line">│   └── software</span><br><span class="line">│       ├── 11204</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 12201</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 18000</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 19300</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 21300</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── OracleShellInstall.sh</span><br><span class="line">│       ├── compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class="line">│       └── rlwrap-0.42.tar.gz</span><br><span class="line">├── single_db</span><br><span class="line">│   ├── README.md</span><br><span class="line">│   ├── Vagrantfile</span><br><span class="line">│   ├── config</span><br><span class="line">│   │   └── vagrant.yml</span><br><span class="line">│   ├── scripts</span><br><span class="line">│   │   └── setup.sh</span><br><span class="line">│   └── software</span><br><span class="line">│       ├── 11204</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 12201</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 18000</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 19300</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── 21300</span><br><span class="line">│       │   └── software.txt</span><br><span class="line">│       ├── OracleShellInstall.sh</span><br><span class="line">│       ├── compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class="line">│       └── rlwrap-0.42.tar.gz</span><br><span class="line">└── singleasm_db</span><br><span class="line">    ├── README.md</span><br><span class="line">    ├── Vagrantfile</span><br><span class="line">    ├── config</span><br><span class="line">    │   └── vagrant.yml</span><br><span class="line">    ├── scripts</span><br><span class="line">    │   └── setup.sh</span><br><span class="line">    └── software</span><br><span class="line">        ├── 11204</span><br><span class="line">        │   └── software.txt</span><br><span class="line">        ├── 12201</span><br><span class="line">        │   └── software.txt</span><br><span class="line">        ├── 18000</span><br><span class="line">        │   └── software.txt</span><br><span class="line">        ├── 19300</span><br><span class="line">        │   └── software.txt</span><br><span class="line">        ├── 21300</span><br><span class="line">        │   └── software.txt</span><br><span class="line">        ├── OracleShellInstall.sh</span><br><span class="line">        ├── compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class="line">        └── rlwrap-0.42.tar.gz</span><br><span class="line"></span><br><span class="line">32 directories, 61 files</span><br></pre></td></tr></table></figure><h2 id="使用许可"><a href="#使用许可" class="headerlink" title="使用许可"></a>使用许可</h2><p><a href="">MIT</a> © Lucifer三思而后行</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> RAC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> RAC </tag>
            
            <tag> Vagrant </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle 配置透明网关访问 MySQL 详细教程</title>
      <link href="/post/8fba6cb0.html"/>
      <url>/post/8fba6cb0.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>从 Oracle 无法直接访问 Mysql 数据库，需要配置透明网关后通过 DBLink 实现访问。</p><p>今天搞了一下午透明网关配置，流程比较复杂，并且有一些坑，这不立刻来给大家排排坑，说不定以后就用的着呢！</p><p>废话不多说，直接实战走起~</p><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>本次环境准备了 3 台主机，分别用来安装 Oracle 数据库，MySQL 数据库，透明网关。</p><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><p>环境信息：</p><table><thead><tr><th>用途</th><th>主机名</th><th>IP地址</th><th>主机版本</th><th>数据库版本</th><th>DB名称</th><th>端口号</th></tr></thead><tbody><tr><td>Oracle 数据库</td><td>orcl</td><td>10.211.55.100</td><td>RHEL7.6</td><td>11GR2</td><td>orcl</td><td>1521</td></tr><tr><td>MySQL 数据库</td><td>mysql</td><td>10.211.55.101</td><td>RHEL7.6</td><td>8.0.26</td><td>lucifer</td><td>3306</td></tr><tr><td>透明网关主机</td><td>gateway</td><td>10.211.55.102</td><td>RHEL7.6</td><td>11GR2</td><td>无</td><td>1521</td></tr></tbody></table><p><strong>为什么透明网关需要单独配置一台主机？</strong></p><ul><li>不影响数据库主机的正常运行</li><li>便于安装配置以及管理</li><li>数据库迁移时不需要重新配置透明网关</li><li>RAC 环境下，无需重复安装配置多个节点</li></ul><p><strong>📢 注意：</strong> 透明网关主机的配置不需要很高，无需安装 Oracle 数据库，仅安装透明网关即可！</p><h1 id="实战演示"><a href="#实战演示" class="headerlink" title="实战演示"></a>实战演示</h1><h2 id="介质装备"><a href="#介质装备" class="headerlink" title="介质装备"></a>介质装备</h2><p>首先，需要下载 GateWay 和 MySQL ODBC安装包：</p><ul><li>mysql-connector-odbc-8.0.27-1.el7.x86_64.rpm</li><li>p13390677_112040_Linux-x86-64_5of7.zip</li></ul><p><img src="https://img-blog.csdnimg.cn/971bb57ab6d2402cb7b3fc0922c4190b.png"></p><p>方便大家学习，我直接上传到百度网盘供大家下载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">链接: https://pan.baidu.com/s/1ybJGu1JCbOgRbjCTqtl9TA</span><br><span class="line">提取码: l062</span><br></pre></td></tr></table></figure><h2 id="安装透明网关"><a href="#安装透明网关" class="headerlink" title="安装透明网关"></a>安装透明网关</h2><h3 id="主机环境配置"><a href="#主机环境配置" class="headerlink" title="主机环境配置"></a>主机环境配置</h3><p>下载上述安装介质并上传透明网关主机：</p><p><img src="https://img-blog.csdnimg.cn/b397a9e4b49f4aaaaf46bf5c0905b045.png"></p><p><strong>📢 注意：</strong> 安装透明网关之前需要配置环境和创建用户等等，可以参照 Linux 安装单机 Oracle 的环境配置步骤，这里就不再详述了！</p><p>使用 Oracle 一键安装脚本配置即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">./OracleShellInstall.sh -i 10.211.55.102 -txh Y</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/88f55ac71cc444c8ac39e915035e3415.png"></p><p><strong>📢 注意：</strong> 由于主机安装时选择了最小化安装，并且安装透明网关需要图形化，因此加上 <code>-txh Y</code> 安装图形化界面！</p><p><img src="https://img-blog.csdnimg.cn/33bd73489686491fb095b1cb04934077.png"></p><p><font color='orage'><strong>稍许等待几分钟之后，即可配置完成，由于没有上传 DB 安装包，这个报错是正常！</strong></font></p><h3 id="正式安装"><a href="#正式安装" class="headerlink" title="正式安装"></a>正式安装</h3><p>主机配置完成后，开始安装透明网关：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 首先 root 用户下，授权 oracle 访问 /soft 目录</span></span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft</span><br><span class="line"><span class="comment">## 切换到 oracle 用户下</span></span><br><span class="line">su - oracle</span><br><span class="line"><span class="comment">## 解压透明网关安装包</span></span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_5of7.zip</span><br><span class="line"><span class="comment">## 配置 vnc 访问图形化界面</span></span><br><span class="line">vncserver</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/16c0acf8fb274719bd347beaade5d13b.png"></p><p>使用 VNC 客户端连接：</p><p><img src="https://img-blog.csdnimg.cn/2231374cfe0c4f6e9f53d6cf65e17523.png"></p><p>开始安装：</p><p><img src="https://img-blog.csdnimg.cn/241a7782522144cdbde865f660914da0.png"></p><p><img src="https://img-blog.csdnimg.cn/6af4662c19204f57ab1125dcbf9a3bc5.png"></p><p><img src="https://img-blog.csdnimg.cn/b2a33dd4e6cc45ddafb2ebc99fa0cdaf.png"></p><p>确认安装位置：</p><p><img src="https://img-blog.csdnimg.cn/54dd4c505eb14edfaf24af4e6a65e3e8.png"></p><p><img src="https://img-blog.csdnimg.cn/23895854861f43dcb77e4c13fb561d94.png"></p><p>这里选择 <code>for ODBC</code> 即可：</p><p><img src="https://img-blog.csdnimg.cn/5709f2e6acc54de48caf123f6019c452.png"></p><p><img src="https://img-blog.csdnimg.cn/92d4b98f0d274ed19e984cee6f671629.png"></p><p>开始安装，静待结束：</p><p><img src="https://img-blog.csdnimg.cn/00ebbc9af596475ca533d6b7ed670ab8.png"></p><p><code>root</code> 用户下执行 <code>root.sh</code> 脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/u01/app/oraInventory/orainstRoot.sh</span><br><span class="line">/u01/app/oracle/product/11.2.0/db/root.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c7a4771943d34af89027a29055db3ab7.png"></p><p>配置监听：</p><p><img src="https://img-blog.csdnimg.cn/59fc6d84d1494762b1c6dfd2cc11585f.png"></p><p><img src="https://img-blog.csdnimg.cn/a41542ad6d0e4511b470e1202ad624eb.png"></p><p><font color='orage'><strong>至此，透明网关安装结束！</strong></font></p><h3 id="安装-mysql-connector"><a href="#安装-mysql-connector" class="headerlink" title="安装 mysql-connector"></a>安装 mysql-connector</h3><p>首先需要安装 <code>unixODBC</code> 依赖，否则报错：</p><p><img src="https://img-blog.csdnimg.cn/b1669a3b7fd14f0abe2692842ef1a207.png"></p><p>安装 <code>unixODBC</code> 依赖后安装 <code>mysql-connector</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y unixODBC*</span><br><span class="line">rpm -ivh mysql-connector-odbc-8.0.27-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/cdf1c66a5f6a41aebced83f4722f3ae8.png"></p><p><strong>📢 注意：</strong> 透明网关的安装到这里就全都结束了，接下来就是配置部分了。</p><h2 id="透明网关配置"><a href="#透明网关配置" class="headerlink" title="透明网关配置"></a>透明网关配置</h2><p>透明网关安装好之后，自然是需要配置才能使用的。</p><h3 id="配置-odbc-ini"><a href="#配置-odbc-ini" class="headerlink" title="配置 odbc.ini"></a>配置 odbc.ini</h3><p><code>odbc.ini</code> 文件用来存放 MySQL 数据库相关信息，默认不存在，<code>root</code> 用户下手动创建即可：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;/etc/odbc.ini</span></span><br><span class="line"><span class="string">[lucifer]</span></span><br><span class="line"><span class="string">Description     = ODBC for MySQL</span></span><br><span class="line"><span class="string">Driver          = /usr/lib64/libmyodbc8w.so</span></span><br><span class="line"><span class="string">Server          = 10.211.55.101</span></span><br><span class="line"><span class="string">Port            = 3306</span></span><br><span class="line"><span class="string">User            = lucifer</span></span><br><span class="line"><span class="string">Password        = lucifer</span></span><br><span class="line"><span class="string">Database        = lucifer</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d77b64f4281a4a1a95ead436f91b2ef2.png"></p><p>配置文件中的配置信息如下：</p><ul><li><strong>[lucifer]</strong> 可以理解为是一个 SID 名称，可以自定义，后面配置需要用到；</li><li><strong>Server</strong> 是指 MySQL 数据库主机的 IP 地址；</li><li><strong>Port</strong> 是指 MySQL 数据库的端口；</li><li><strong>User</strong> 是指 Oracle 需要访问的用户名；</li><li><strong>Password</strong> 是指被访问用户的登录密码；</li><li><strong>Database</strong> 是指需要 MySQL 数据库需要被访问的 DB 名称；</li></ul><p><strong>📢 注意：</strong> 如果有多个 MySQL 数据库需要配置，则填写多个即可！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[lucifer]</span><br><span class="line">Description     = ODBC <span class="keyword">for</span> MySQL</span><br><span class="line">Driver          = /usr/lib64/libmyodbc8w.so</span><br><span class="line">Server          = 10.211.55.101</span><br><span class="line">Port            = 3306</span><br><span class="line">User            = lucifer</span><br><span class="line">Password        = lucifer</span><br><span class="line">Database        = lucifer</span><br><span class="line"></span><br><span class="line">[lucifer1]</span><br><span class="line">Description     = ODBC <span class="keyword">for</span> MySQL</span><br><span class="line">Driver          = /usr/lib64/libmyodbc8w.so</span><br><span class="line">Server          = 10.211.55.105</span><br><span class="line">Port            = 3306</span><br><span class="line">User            = lucifer1</span><br><span class="line">Password        = lucifer1</span><br><span class="line">Database        = lucifer1</span><br></pre></td></tr></table></figure><h3 id="配置-init-SID-ora"><a href="#配置-init-SID-ora" class="headerlink" title="配置 init[SID].ora"></a>配置 init[SID].ora</h3><p>切换至 <code>oracle</code> 用户，进入 <code>$ORACLE_HOME/hs/admin</code>  目录下，新建一个 <strong>init[SID].ora</strong> 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;$ORACLE_HOME/hs/admin/initlucifer.ora</span></span><br><span class="line"><span class="string">##HS Configuration</span></span><br><span class="line"><span class="string">HS_FDS_CONNECT_INFO = lucifer</span></span><br><span class="line"><span class="string">HS_FDS_TRACE_LEVEL = debug</span></span><br><span class="line"><span class="string">HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so</span></span><br><span class="line"><span class="string">HS_FDS_SUPPORT_STATISTICS=FALSE</span></span><br><span class="line"><span class="string">HS_LANGUAGE=AMERICAN_AMERICA.UTF8</span></span><br><span class="line"><span class="string">HS_NLS_NCHAR = UCS2</span></span><br><span class="line"><span class="string">##ODBC Configuration</span></span><br><span class="line"><span class="string">set ODBCINI=/etc/odbc.ini</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2626716681cd43918dca7712a94b9f43.png"></p><p>这里 initSID.ora 中的 <strong>SID</strong> 名称和文件中 <strong>HS_FDS_CONNECT_INFO</strong> 参数值，就是上一步中我们配置 <strong>odbc.ini</strong> 文件中的 <code>[lucifer]</code> 名称。</p><p><strong>📢 注意：</strong> 如果有多个 MySQL 数据库需要配置，则创建多个 <strong>init[SID].ora 文件</strong> 即可！</p><h3 id="配置监听"><a href="#配置监听" class="headerlink" title="配置监听"></a>配置监听</h3><p>oracle 用户下，进入 <code>$TNS_ADMIN</code> 配置 listener.ora 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;$TNS_ADMIN/listener.ora</span></span><br><span class="line"><span class="string">SID_LIST_LISTENER =</span></span><br><span class="line"><span class="string">(SID_LIST =</span></span><br><span class="line"><span class="string">  (SID_DESC=</span></span><br><span class="line"><span class="string">  (SID_NAME=lucifer)</span></span><br><span class="line"><span class="string">  (ORACLE_HOME=/u01/app/oracle/product/11.2.0/db)</span></span><br><span class="line"><span class="string">  (PROGRAM=dg4odbc)</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/677fecfd6b824d7eaeade7b1b55aeadd.png"></p><p><strong>📢 注意：</strong> 如果有多个 MySQL 数据库需要配置，则写成如下格式！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;$TNS_ADMIN/listener.ora</span></span><br><span class="line"><span class="string">SID_LIST_LISTENER =</span></span><br><span class="line"><span class="string">(SID_LIST =</span></span><br><span class="line"><span class="string">  (SID_DESC =</span></span><br><span class="line"><span class="string">  (SID_NAME = lucifer)</span></span><br><span class="line"><span class="string">  (ORACLE_HOME=/u01/app/oracle/product/11.2.0/db)</span></span><br><span class="line"><span class="string">  (PROGRAM=dg4odbc)</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">  (SID_DESC =</span></span><br><span class="line"><span class="string">  (SID_NAME = lucifer1)</span></span><br><span class="line"><span class="string">  (ORACLE_HOME=/u01/app/oracle/product/11.2.0/db)</span></span><br><span class="line"><span class="string">  (PROGRAM=dg4odbc)</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>重启监听：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lsnrctl stop</span><br><span class="line">lsnrctl start</span><br><span class="line">lsnrctl status</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9ca329c894c84038bd61449700a80e5e.png"></p><p><strong>配置完成之后，测试是否可以连接 MySQL 数据库：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">isql lucifer</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d7cd9a2cea3548bc8b0a2a0ae90b2d97.png"></p><p><strong><font color='orage'>成功连接 MySQL 数据库，至此透明网关配置完成！</font></strong></p><h2 id="Oracle-数据库配置"><a href="#Oracle-数据库配置" class="headerlink" title="Oracle 数据库配置"></a>Oracle 数据库配置</h2><p>透明网关配置完成后，就只需要配置 Oracle 数据库来连接透明网关。</p><h3 id="配置-TNS"><a href="#配置-TNS" class="headerlink" title="配置 TNS"></a>配置 TNS</h3><p>通过配置 TNS 来连接透明网关，进入 TNS 配置文件目录 <code>$TNS_ADMIN</code> 配置 TNS：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;$TNS_ADMIN/tnsnames.ora</span></span><br><span class="line"><span class="string">lucifer =</span></span><br><span class="line"><span class="string">  (DESCRIPTION =</span></span><br><span class="line"><span class="string">    (ADDRESS_LIST =</span></span><br><span class="line"><span class="string">      (ADDRESS = (PROTOCOL = TCP)(HOST = 10.211.55.102)(PORT = 1521))</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    (CONNECT_DATA =</span></span><br><span class="line"><span class="string">      (SID = lucifer)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">   (HS = OK)</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2de3e1b78f9e417296b57f6235eb21bf.png"></p><p>通过 <code>tnsping</code> 测试后，发现访问没有问题！</p><h3 id="配置-DBLink-连接-MySQL-数据库"><a href="#配置-DBLink-连接-MySQL-数据库" class="headerlink" title="配置 DBLink 连接 MySQL 数据库"></a>配置 DBLink 连接 MySQL 数据库</h3><p>接下来只需要创建你 DBLink 即可连接 MySQL 数据库：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> public database link lucifer <span class="keyword">connect</span> <span class="keyword">to</span> &quot;lucifer&quot; identified <span class="keyword">by</span> &quot;lucifer&quot; <span class="keyword">using</span> <span class="string">&#x27;lucifer&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/fb14f8e7031c47888cc6f9f53e8a6a94.png"></p><p>测试连接操作 MySQL 数据库：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> &quot;lucifer&quot;<span class="variable">@lucifer</span> <span class="keyword">order</span> <span class="keyword">by</span> &quot;id&quot;;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> &quot;lucifer&quot;<span class="variable">@lucifer</span> <span class="keyword">where</span> &quot;id&quot;<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/5d5bf4635acf4e89a730f518d94e73ce.png"></p><p><font color='orage'><strong>至此，整个 Oracle 配置透明网关访问 MySQL 就完成了！</strong></font></p><h1 id="最后总结"><a href="#最后总结" class="headerlink" title="最后总结"></a>最后总结</h1><p>如果按照我的步骤来操作，整个流程走下来应该会比较顺畅，下面罗列一下我操作过程中遇到的一些报错：</p><p>1、<strong>init[sid].ora</strong> 配置文件的 <code>HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so</code> 不正确，应该是 ODBC 的 Lib包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR at line 1:</span><br><span class="line">ORA-28500: connection from ORACLE to a non-Oracle system returned this message:</span><br><span class="line">ORA-02063: preceding line from DLK</span><br></pre></td></tr></table></figure><p>2、<strong>init[sid].ora</strong> 里配置的 <code>HS_LANGUAGE=AMERICAN_AMERICA.zhs16gbk</code> 字符集不正确或者没有配置，应该是 <code>Oracle</code> 数据库字符集：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR at line 1:</span><br><span class="line">ORA-28500: connection from ORACLE to a non-Oracle system returned this message:</span><br><span class="line">[</span><br></pre></td></tr></table></figure><p>3、执行查询操作时，表名需要带双引号，因为 MySQL 默认表名是区分大小写，而 Oracle 是不区分大小写的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ERROR at line 1:</span><br><span class="line">ORA-00942: table or view does not exist</span><br><span class="line">[MySQL][ODBC 8.0(w) Driver][mysqld-5.7.18-log]Table <span class="string">&#x27;test.T1&#x27;</span> doesn<span class="string">&#x27;t exist</span></span><br><span class="line"><span class="string">&#123;42S02,NativeErr = 1146&#125;</span></span><br><span class="line"><span class="string">ORA-02063: preceding 2 lines from DLK</span></span><br></pre></td></tr></table></figure><p>4、Oracle 数据库配置 TNS 时，没有加 <code>(HS = OK)</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ERROR at line 1:</span><br><span class="line">ORA-28546: connection initialization failed, probable Net8 admin error</span><br><span class="line">ORA-02063: preceding line from LUCIFER</span><br></pre></td></tr></table></figure><blockquote><p>本文部分内容参考文档：<a href="https://www.cnblogs.com/rangle/p/8967643.html">Oracle透明网关访问MySQL数据库</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> 11GR2 </category>
          
          <category> Gateway </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> MySQL </tag>
            
            <tag> GateWay </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手把手教你 DBCA 搭建 Oracle ADG</title>
      <link href="/post/c6b3f75d.html"/>
      <url>/post/c6b3f75d.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Oracle Data Guard 简称 DG，是 Oracle MAA（Maximum Availability Architecture）中的成员之一。</p><ul><li>从 <code>Oracle 7i</code> 版本开始推出 STANDBY DATABASE 的概念，慢慢受到大家的欢迎。</li><li>随着 Oracle 数据库版本的更迭，搭建备库的方式多种多样。</li></ul><p>本文介绍一种创建物理备库的新方式，从 <code>12C</code> 版本开始推出：使用 <font color='orage'><strong>DBCA</strong></font> 命令行创建 DG 备库。</p><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>最简单的搭建命令参数如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca -createDuplicateDB -createAsStandby -dbUniqueName</span><br></pre></td></tr></table></figure><ul><li>优点：方便快捷，搭建速度较快。</li><li>缺点：影响主库的性能，执行过程报错不方便排查。</li></ul><p><strong>具体命令可参考：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dbca -silent -createDuplicateDB</span><br><span class="line">-gdbName global_database_name</span><br><span class="line">-primaryDBConnectionString easy_connect_string_to_primary</span><br><span class="line">-sid database_system_identifier</span><br><span class="line">[-createAsStandby</span><br><span class="line">[-dbUniqueName db_unique_name_for_standby]]</span><br><span class="line">[-customScripts scripts_list]</span><br></pre></td></tr></table></figure><p><strong>更多详细参数可参考官方文档</strong>：<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/admin/creating-and-configuring-an-oracle-database.html#GUID-7F4B1A64-5B08-425A-A62E-854542B3FD4E">The createDuplicateDB command creates a duplicate of an Oracle database.</a></p><p><img src="https://img-blog.csdnimg.cn/2021060517420066.png"></p><p><strong><font color='orage'>12.2.0.1 开始支持 DBCA 创建物理备库，但是限制较多：</font></strong></p><ul><li>主库必须是单机环境，非 RAC 数据库;</li><li>主库必须是非 CDB 环境;</li></ul><p><strong><font color='orage'>18c 之后，以上限制已经取消，支持主库是 CDB 和 RAC 环境。</font></strong></p><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>本次测试尽量按照生产环境升级进行模拟：</p><table><thead><tr><th>节点</th><th>主机版本</th><th>主机名</th><th>实例名</th><th>Oracle版本</th><th>IP地址</th></tr></thead><tbody><tr><td>rac01</td><td>rhel7.9</td><td>rac01</td><td>cdb19c</td><td>19.3.0（补丁 29585399）</td><td>10.211.55.100</td></tr><tr><td>rac02</td><td>rhel7.9</td><td>rac02</td><td>orcl+cdb19c</td><td>19.3.0（补丁 29585399）</td><td>10.211.55.101</td></tr><tr><td>备库</td><td>rhel7.9</td><td>dbca_stby</td><td>不创建实例</td><td>19.3.0（补丁 29585399）</td><td>10.211.55.110</td></tr></tbody></table><p><strong>📢 注意：</strong></p><ul><li>db_unique_name主备库不能相同;</li><li>db_name主备库需保持一致;</li><li>主备库DB版本需保持一致;</li></ul><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h1 id="ADG搭建准备"><a href="#ADG搭建准备" class="headerlink" title="ADG搭建准备"></a>ADG搭建准备</h1><h2 id="配置hosts文件"><a href="#配置hosts文件" class="headerlink" title="配置hosts文件"></a>配置hosts文件</h2><p><strong>主库：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt; /etc/hosts</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">10.211.55.110 dbca_stby</span></span><br><span class="line"><span class="string">## FOR DG END</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605220228109.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605220401252.png"></p><p><strong>备库：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt; /etc/hosts</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">10.211.55.100 rac01</span></span><br><span class="line"><span class="string">10.211.55.101 rac02</span></span><br><span class="line"><span class="string">10.211.55.105 rac-scan</span></span><br><span class="line"><span class="string">## FOR DG END</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605215047313.png"></p><h2 id="配置静态监听和TNS"><a href="#配置静态监听和TNS" class="headerlink" title="配置静态监听和TNS"></a>配置静态监听和TNS</h2><p>建议 listener.ora 增加静态监听：</p><p><strong>rac01：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt; $TNS_ADMIN/listener.ora</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">SID_LIST_LISTENER =</span></span><br><span class="line"><span class="string">(SID_LIST =</span></span><br><span class="line"><span class="string">(SID_DESC =</span></span><br><span class="line"><span class="string">(GLOBAL_DBNAME = cdb19c)</span></span><br><span class="line"><span class="string">(ORACLE_HOME = /u01/app/oracle/product/19.3.0/db)</span></span><br><span class="line"><span class="string">(SID_NAME = cdb19c1)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">## FOR DG END</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605192435726.png"></p><p><strong>rac02：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt; $TNS_ADMIN/listener.ora</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">SID_LIST_LISTENER =</span></span><br><span class="line"><span class="string">(SID_LIST =</span></span><br><span class="line"><span class="string">(SID_DESC =</span></span><br><span class="line"><span class="string">(GLOBAL_DBNAME = cdb19c)</span></span><br><span class="line"><span class="string">(ORACLE_HOME = /u01/app/oracle/product/19.3.0/db)</span></span><br><span class="line"><span class="string">(SID_NAME = cdb19c2)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">## FOR DG END</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605192555806.png"></p><p><strong>备库：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt;$TNS_ADMIN/listener.ora</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">SID_LIST_LISTENER =</span></span><br><span class="line"><span class="string">(SID_LIST =</span></span><br><span class="line"><span class="string">(SID_DESC =</span></span><br><span class="line"><span class="string">(GLOBAL_DBNAME = cdb19c_stby)</span></span><br><span class="line"><span class="string">(ORACLE_HOME = /u01/app/oracle/product/19.3.0/db)</span></span><br><span class="line"><span class="string">(SID_NAME = cdb19c_stby)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">## FOR DG END</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605194216412.png"></p><p><strong>重启监听：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#主库RAC重启监听</span></span><br><span class="line">srvctl stop listener</span><br><span class="line">srvctl start listener</span><br><span class="line"></span><br><span class="line"><span class="comment">##备库重启监听</span></span><br><span class="line">lsnrctl start</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605193630649.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605193735686.png"></p><p><img src="https://img-blog.csdnimg.cn/2021060519390969.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605214433370.png"></p><h2 id="tnsnames-ora-增加-TNS"><a href="#tnsnames-ora-增加-TNS" class="headerlink" title="tnsnames.ora 增加 TNS"></a>tnsnames.ora 增加 TNS</h2><p><strong>oracle用户执行：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF &gt;&gt; $TNS_ADMIN/tnsnames.ora</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">CDB19C =</span></span><br><span class="line"><span class="string">(DESCRIPTION =</span></span><br><span class="line"><span class="string">(ADDRESS_LIST =</span></span><br><span class="line"><span class="string">(ADDRESS = (PROTOCOL = TCP)(HOST = rac-scan)(PORT = 1521))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">(CONNECT_DATA =</span></span><br><span class="line"><span class="string">(SERVICE_NAME = cdb19c)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">CDB19C1 =</span></span><br><span class="line"><span class="string">(DESCRIPTION =</span></span><br><span class="line"><span class="string">(ADDRESS_LIST =</span></span><br><span class="line"><span class="string">(ADDRESS = (PROTOCOL = TCP)(HOST = rac01)(PORT = 1521))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">(CONNECT_DATA =</span></span><br><span class="line"><span class="string">(SERVICE_NAME = cdb19c)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">CDB19C2 =</span></span><br><span class="line"><span class="string">(DESCRIPTION =</span></span><br><span class="line"><span class="string">(ADDRESS_LIST =</span></span><br><span class="line"><span class="string">(ADDRESS = (PROTOCOL = TCP)(HOST = rac02)(PORT = 1521))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">(CONNECT_DATA =</span></span><br><span class="line"><span class="string">(SERVICE_NAME = cdb19c)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">CDB19C_STBY =</span></span><br><span class="line"><span class="string">(DESCRIPTION =</span></span><br><span class="line"><span class="string">(ADDRESS_LIST =</span></span><br><span class="line"><span class="string">(ADDRESS = (PROTOCOL = TCP)(HOST = dbca_stby)(PORT = 1521))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">(CONNECT_DATA =</span></span><br><span class="line"><span class="string">(SERVICE_NAME = cdb19c_stby)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">## FOR DG BEGIN</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>tnsping 测试连通性：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tnsping cdb19c</span><br><span class="line">tnsping cdb19c1</span><br><span class="line">tnsping cdb19c2</span><br><span class="line">tnsping cdb19c_stby</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605215512300.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605215538701.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605215613108.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605215433806.png"></p><h2 id="主库配置参数"><a href="#主库配置参数" class="headerlink" title="主库配置参数"></a>主库配置参数</h2><p><strong>查看是否开启强制日志：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> force_logging,log_mode,cdb <span class="keyword">from</span> gv$database;</span><br><span class="line"></span><br><span class="line">FORCE_LOGGINGLOG_MODE     CDB</span><br><span class="line"><span class="comment">---------------------------------------</span></span><br><span class="line">YESARCHIVELOG   YES</span><br></pre></td></tr></table></figure><p><strong>如果没有开启强制日志：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> database force logging;</span><br></pre></td></tr></table></figure><p><strong>如果没有开启归档日志：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">shutdown immediate</span><br><span class="line">startup mount</span><br><span class="line"><span class="keyword">alter</span> database archivelog;</span><br><span class="line"><span class="keyword">alter</span> database <span class="keyword">open</span>;</span><br><span class="line"><span class="keyword">alter</span> pluggable database <span class="keyword">all</span> <span class="keyword">open</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605220911471.png"></p><h2 id="主库添加stanby-log文件"><a href="#主库添加stanby-log文件" class="headerlink" title="主库添加stanby log文件"></a>主库添加stanby log文件</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> line222</span><br><span class="line">col <span class="keyword">member</span> <span class="keyword">for</span> a60</span><br><span class="line"><span class="keyword">select</span> t2.thread#,t1.group#,t1.member,t2.bytes<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">from</span> v$logfile t1,v$log t2 <span class="keyword">where</span> t1.group#<span class="operator">=</span>t2.group# <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605221437322.png"></p><p><strong>📢 注意：</strong></p><ul><li>stanby log 日志大小至少要和 redo log 日志一样大小，不能小于主库日志大小；</li><li>stanby log 数量： standby logfile&#x3D;(1+logfile组数)&#x3D;(1+2)&#x3D;3 组,每个 thread 需要加 3 组 standby logfile；</li><li>thread 要与 redo log 保持一致，如果是 rac，需要增加多个 thread 对应的 standby log；</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">ADD</span> STANDBY LOGFILE thread <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="number">5</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">6</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">7</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">ADD</span> STANDBY LOGFILE thread <span class="number">2</span></span><br><span class="line"><span class="keyword">group</span> <span class="number">8</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">9</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">10</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605222215369.png"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> t2.thread#,t1.group#,t1.member,t2.bytes<span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span> <span class="keyword">from</span> v$logfile t1,v$standby_log t2 <span class="keyword">where</span> t1.group#<span class="operator">=</span>t2.group# <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>,<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605222902724.png"></p><h1 id="DBCA-创建物理备库"><a href="#DBCA-创建物理备库" class="headerlink" title="DBCA 创建物理备库"></a>DBCA 创建物理备库</h1><p><strong>oracle 用户执行：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dbca -silent -createDuplicateDB \</span><br><span class="line">-gdbName cdb19c \</span><br><span class="line">-sid cdb19c \</span><br><span class="line">-sysPassword oracle \</span><br><span class="line">-primaryDBConnectionString 10.211.55.105:1521/cdb19c \</span><br><span class="line">-nodelist dbca_stby \</span><br><span class="line">-databaseConfigType SINGLE \</span><br><span class="line">-createAsStandby -dbUniqueName cdb19c_stby \</span><br><span class="line">-datafileDestination <span class="string">&#x27;/oradata&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605224346403.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605224824638.png"></p><p><strong><font color='orage'>DBCA 物理 DG 已经创建成功！</font></strong></p><h1 id="配置主库-备库-DG-参数"><a href="#配置主库-备库-DG-参数" class="headerlink" title="配置主库+备库 DG 参数"></a>配置主库+备库 DG 参数</h1><p><strong>主库设置 DG 参数：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_CONFIG<span class="operator">=</span><span class="string">&#x27;DG_CONFIG=(CDB19C,CDB19C_STBY)&#x27;</span> sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_1<span class="operator">=</span><span class="string">&#x27;LOCATION=+DATA VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=CDB19C&#x27;</span> sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_2<span class="operator">=</span><span class="string">&#x27;SERVICE=cdb19c_stby ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=CDB19C_STBY&#x27;</span> sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_STATE_2<span class="operator">=</span>ENABLE sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_MAX_PROCESSES<span class="operator">=</span><span class="number">4</span> sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_SERVER<span class="operator">=</span>CDB19C_STBY sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_CLIENT<span class="operator">=</span>CDB19C sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> DB_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;+DATA&#x27;</span>,<span class="string">&#x27;/oradata/CDB19C_STBY&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;+DATA&#x27;</span>,<span class="string">&#x27;/oradata/CDB19C_STBY&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> STANDBY_FILE_MANAGEMENT<span class="operator">=</span>AUTO sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> RAC 修改参数需要加上 <code>sid=&#39;*&#39;</code>，修改多个实例。</p><p><strong>备库设置 DG 参数：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_CONFIG<span class="operator">=</span><span class="string">&#x27;DG_CONFIG=(CDB19C_STBY,CDB19C)&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_1<span class="operator">=</span><span class="string">&#x27;LOCATION=/archivelog VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=CDB19C_STBY&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_2<span class="operator">=</span><span class="string">&#x27;SERVICE=CDB19C ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=CDB19C&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_STATE_2<span class="operator">=</span>ENABLE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_MAX_PROCESSES<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_SERVER<span class="operator">=</span>CDB19C;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_CLIENT<span class="operator">=</span>CDB19C_STBY;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> DB_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;/oradata/CDB19C_STBY&#x27;</span>,<span class="string">&#x27;+DATA&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;/oradata/CDB19C_STBY&#x27;</span>,<span class="string">&#x27;+DATA&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> STANDBY_FILE_MANAGEMENT<span class="operator">=</span>AUTO;</span><br></pre></td></tr></table></figure><p><strong>查看 OMF 参数配置：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">parameter</span> db_create_file_dest</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605230405897.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605230332418.png"></p><p><strong>📢 注意：</strong> 如果同时设置 OMF 和 DB_FILE_NAME_CONVERT 参数，则优先 OMF 参数。</p><h1 id="开启日志应用"><a href="#开启日志应用" class="headerlink" title="开启日志应用"></a>开启日志应用</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 备库执行</span></span><br><span class="line"><span class="keyword">alter</span> database recover managed standby database <span class="keyword">using</span> <span class="keyword">current</span> logfile <span class="keyword">disconnect</span> <span class="keyword">from</span> session;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 主库执行</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> log_archive_dest_state_2<span class="operator">=</span>enable sid<span class="operator">=</span><span class="string">&#x27;*&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210605231146809.png"></p><p><img src="https://img-blog.csdnimg.cn/20210605232211617.png"></p><h1 id="测试同步"><a href="#测试同步" class="headerlink" title="测试同步"></a>测试同步</h1><p><strong>主库创建测试数据：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> session <span class="keyword">set</span> container<span class="operator">=</span>orcl;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604000102800.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlplus lucifer/lucifer@orcl</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210604000353642.png"></p><p><strong>备库查看是否同步：</strong></p><p><img src="https://img-blog.csdnimg.cn/20210604000554940.png"><br><strong><font color='orage'>至此，ADG 已搭建完毕！</font></strong></p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> DataGuard </category>
          
          <category> 19C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> 19C </tag>
            
            <tag> DataGuard </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly 主题标签外挂语法</title>
      <link href="/post/e8284a63.html"/>
      <url>/post/e8284a63.html</url>
      
        <content type="html"><![CDATA[<h2 id="Note-引用"><a href="#Note-引用" class="headerlink" title="Note(引用)"></a>Note(引用)</h2><div class="tabs" id="语法"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#语法-1">通用设置</button></li><li class="tab"><button type="button" data-href="#语法-2">用法1</button></li><li class="tab"><button type="button" data-href="#语法-3">用法2（自定义 icon）</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="语法-1"><p>移植于next主题，并进行修改。</p><p>配置 主题配置文件：<mark class="hl-label orange">_config.butterfly.yml</mark> ：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">note:</span></span><br><span class="line">  <span class="comment"># Note tag style values:</span></span><br><span class="line">  <span class="comment">#  - simple    bs-callout old alert style. Default.</span></span><br><span class="line">  <span class="comment">#  - modern    bs-callout new (v2-v3) alert style.</span></span><br><span class="line">  <span class="comment">#  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span></span><br><span class="line">  <span class="comment">#  - disabled  disable all CSS styles import of note tag.</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">flat</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">border_radius:</span> <span class="number">3</span></span><br><span class="line">  <span class="comment"># Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line">  <span class="comment"># Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line">  <span class="attr">light_bg_offset:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p><code>icons</code> 和 <code>light_bg_offset</code> 只对方法一生效。</p><p>Note 标签外挂有两种用法。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="语法-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>用法</th></tr></thead><tbody><tr><td>class</td><td>【可选】标识，不同的标识有不同的配色 </br>（ default &#x2F; primary &#x2F; success &#x2F; info &#x2F; warning &#x2F; danger ）</td></tr><tr><td>no-icon</td><td>【可选】不显示 icon</td></tr><tr><td>style</td><td>【可选】可以覆盖配置中的 style </br>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><blockquote><p>simple</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div><blockquote><p>modern</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><blockquote><p>flat</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><blockquote><p>disabled</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><blockquote><p>no-icon</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">默认 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;</span><br><span class="line">default 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;</span><br><span class="line">primary 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;</span><br><span class="line">success 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;</span><br><span class="line">info 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;</span><br><span class="line">warning 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;</span><br><span class="line">danger 提示块标签</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note no-icon simple"><p>默认 提示块标签</p></div><div class="note default no-icon simple"><p>default 提示块标签</p></div><div class="note primary no-icon simple"><p>primary 提示块标签</p></div><div class="note success no-icon simple"><p>success 提示块标签</p></div><div class="note info no-icon simple"><p>info 提示块标签</p></div><div class="note warning no-icon simple"><p>warning 提示块标签</p></div><div class="note danger no-icon simple"><p>danger 提示块标签</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="语法-3"><blockquote><p>3.2.0 以上版本支持</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>名称</th><th>用法</th></tr></thead><tbody><tr><td>color</td><td>【可选】顔色 </br>（ default &#x2F; blue &#x2F; pink &#x2F; red &#x2F; purple &#x2F; orange &#x2F; green ）</td></tr><tr><td>icon</td><td>【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td>style</td><td>【可选】可以覆盖配置中的 style </br>（simple&#x2F;modern&#x2F;flat&#x2F;disabled）</td></tr></tbody></table><blockquote><p>simple</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><blockquote><p>modern</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><blockquote><p>flat</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><blockquote><p>disabled</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note icon disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了….</p></div><div class="note pink icon disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><blockquote><p>no-icon</p></blockquote><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;</span><br><span class="line">2021年快到了....</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;</span><br><span class="line">小心开车 安全至上</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon%&#125;</span><br><span class="line">这是三片呢？还是四片？</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;</span><br><span class="line">你是刷 Visa 还是 UnionPay</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;</span><br><span class="line">剪刀石头布</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;</span><br><span class="line">前端最讨厌的浏览器</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><div class="note no-icon simple"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon simple"><p>2021年快到了….</p></div><div class="note pink no-icon simple"><p>小心开车 安全至上</p></div><div class="note red no-icon simple"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon simple"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon simple"><p>剪刀石头布</p></div><div class="note green no-icon simple"><p>前端最讨厌的浏览器</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle 11G ADG 搭建 RAC to Single 详细教程（RMAN DUPLICATE）</title>
      <link href="/post/926ce90.html"/>
      <url>/post/926ce90.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>经过交流群中朋友的多次要求，这次给大家分享一下 RAC to Single 的 ADG 搭建教程！</p><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><p>老规矩，测试环境实战演示：</p><table><thead><tr><th>主机名</th><th>ip</th><th>DB Version</th><th>db_name</th><th>db_unique_name</th></tr></thead><tbody><tr><td>lucifer01</td><td>10.211.55.100</td><td>11.2.0.4</td><td>orcl</td><td>orcl</td></tr><tr><td>lucifer02</td><td>10.211.55.101</td><td>11.2.0.4</td><td>orcl</td><td>orcl</td></tr><tr><td>luciferdg</td><td>10.211.55.110</td><td>11.2.0.4</td><td>orcl</td><td>orcldg</td></tr></tbody></table><p><strong>📢 <font color='orage'>以下几点需要注意：</font></strong></p><ul><li>db_unique_name 主备库不能相同</li><li>db_name主备库需保持一致</li><li>主备库DB版本需保持一致</li></ul><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h1 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h1><h2 id="Oracle软件安装"><a href="#Oracle软件安装" class="headerlink" title="Oracle软件安装"></a>Oracle软件安装</h2><p>使用我写的 Oracle 一键安装脚本，快速安装主库 RAC 和备库单机。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ../racdb</span><br><span class="line">vagrant up</span><br><span class="line">vagrant ssh node1</span><br><span class="line">su - root</span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">sh rac_install.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/img_convert/885cf7bb8931f8a7b33a36cc05258a7f.png"></p><p>简单等待一段时间，Oracle RAC 就安装成功了！</p><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>搭建 ADG 之前，需要先配置一下环境信息，包括主机名解析以及 TNS。</p><p><strong>1、配置 <code>hosts</code> 文件</strong></p><p>主库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##节点一</span></span><br><span class="line"><span class="comment">#dg</span></span><br><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">10.211.55.110 luciferdg</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##节点二</span></span><br><span class="line"><span class="comment">#dg</span></span><br><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">10.211.55.110 luciferdg</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>备库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##dg</span></span><br><span class="line"><span class="built_in">cat</span>&lt;&lt;<span class="string">EOF&gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">10.211.55.100 lucifer01</span></span><br><span class="line"><span class="string">10.211.55.101 lucifer02</span></span><br><span class="line"><span class="string">10.211.55.105 lucifer-scan</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>2、配置 <code>TNS</code></strong></p><p>主库+备库，在 <code>root</code> 用户下执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##tnsnames.ora</span></span><br><span class="line">su - oracle -c <span class="string">&quot;cat &lt;&lt;EOF &gt;&gt; /u01/app/oracle/product/11.2.0/db/network/admin/tnsnames.ora</span></span><br><span class="line"><span class="string">##FOR DG BEGIN</span></span><br><span class="line"><span class="string">ORCL =</span></span><br><span class="line"><span class="string">  (DESCRIPTION =</span></span><br><span class="line"><span class="string">    (ADDRESS_LIST =</span></span><br><span class="line"><span class="string">      (ADDRESS = (PROTOCOL = TCP)(HOST = lucifer-scan)(PORT = 1521))</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    (CONNECT_DATA =</span></span><br><span class="line"><span class="string">      (SERVICE_NAME = orcl)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ORCL1 =</span></span><br><span class="line"><span class="string">  (DESCRIPTION =</span></span><br><span class="line"><span class="string">    (ADDRESS_LIST =</span></span><br><span class="line"><span class="string">      (ADDRESS = (PROTOCOL = TCP)(HOST = lucifer01)(PORT = 1521))</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    (CONNECT_DATA =</span></span><br><span class="line"><span class="string">      (SERVICE_NAME = orcl)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ORCL2 =</span></span><br><span class="line"><span class="string">  (DESCRIPTION =</span></span><br><span class="line"><span class="string">    (ADDRESS_LIST =</span></span><br><span class="line"><span class="string">      (ADDRESS = (PROTOCOL = TCP)(HOST = lucifer02)(PORT = 1521))</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    (CONNECT_DATA =</span></span><br><span class="line"><span class="string">      (SERVICE_NAME = orcl)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">ORCLDG =</span></span><br><span class="line"><span class="string">  (DESCRIPTION =</span></span><br><span class="line"><span class="string">    (ADDRESS_LIST =</span></span><br><span class="line"><span class="string">      (ADDRESS = (PROTOCOL = TCP)(HOST = luciferdg)(PORT = 1521))</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    (CONNECT_DATA =</span></span><br><span class="line"><span class="string">      (SERVICE_NAME = orcl)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">  )</span></span><br><span class="line"><span class="string">##FOR DG BEGIN</span></span><br><span class="line"><span class="string">EOF&quot;</span></span><br></pre></td></tr></table></figure><p><strong>3、主库开启归档和强制日志</strong></p><p>开启归档模式（<strong>需要停机</strong>）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">srvctl stop database -d orcl -o immediate</span><br><span class="line">srvctl start instance -d orcl -i orcl1 -o mount</span><br><span class="line">alter database archivelog;</span><br><span class="line">alter database open;</span><br><span class="line">srvctl start instance -d orcl -i orcl2</span><br></pre></td></tr></table></figure><p>开启强制日志模式（<strong>可在线开启</strong>）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> database force logging;</span><br></pre></td></tr></table></figure><p>主库设置 ADG 参数：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_CONFIG<span class="operator">=</span><span class="string">&#x27;DG_CONFIG=(ORCL,ORCLDG)&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_1<span class="operator">=</span><span class="string">&#x27;LOCATION=+DATA VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ORCL&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_2<span class="operator">=</span><span class="string">&#x27;SERVICE=orcldg LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLDG&#x27;</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_STATE_2<span class="operator">=</span>ENABLE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_FORMAT<span class="operator">=</span><span class="string">&#x27;%t_%s_%r.arc&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_MAX_PROCESSES<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> REMOTE_LOGIN_PASSWORDFILE<span class="operator">=</span>EXCLUSIVE <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_SERVER<span class="operator">=</span>ORCLDG;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> FAL_CLIENT<span class="operator">=</span>ORCL;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> DB_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;/oradata&#x27;</span>,<span class="string">&#x27;+DATA&#x27;</span> <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_FILE_NAME_CONVERT<span class="operator">=</span><span class="string">&#x27;/oradata&#x27;</span>,<span class="string">&#x27;+DATA&#x27;</span>  <span class="keyword">SCOPE</span><span class="operator">=</span>SPFILE;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> STANDBY_FILE_MANAGEMENT<span class="operator">=</span>AUTO;</span><br></pre></td></tr></table></figure><p>📢 注意：由于主备数据文件路径不一致，所以需要提前配置 DB_FILE_NAME_CONVERT 参数，该参数需要重启生效。</p><p><strong>4、复制参数文件和密码文件至备库</strong></p><p>复制参数文件至备库（备库执行），要在 <code>oracle</code> 用户下复制：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">scp oracle@lucifer01:/tmp/initorcldg.ora /tmp</span><br></pre></td></tr></table></figure><p>备库创建目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/admin/orcl/adump</span><br><span class="line">su - oracle -c <span class="string">&quot;mkdir -p /oradata/orcl/datafile&quot;</span></span><br><span class="line">su - oracle -c <span class="string">&quot;mkdir -p /oradata/orcl/onlinelog&quot;</span></span><br><span class="line">su - oracle -c <span class="string">&quot;mkdir -p /oradata/orcl/tempfile&quot;</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/fast_recovery_area/orcl</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /u01/app/oracle/admin/orcl/adump</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /u01/app/oracle/fast_recovery_area</span><br></pre></td></tr></table></figure><p>备库修改参数文件，添加 ADG 配置参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">*._optimizer_cartesian_enabled=FALSE</span><br><span class="line">*.audit_file_dest=<span class="string">&#x27;/u01/app/oracle/admin/orcl/adump&#x27;</span></span><br><span class="line">*.audit_trail=<span class="string">&#x27;NONE&#x27;</span></span><br><span class="line">*.compatible=<span class="string">&#x27;11.2.0.4.0&#x27;</span></span><br><span class="line">*.db_block_size=8192</span><br><span class="line">*.control_files=<span class="string">&#x27;/oradata/orcl/control01.ctl&#x27;</span>,<span class="string">&#x27;/u01/app/oracle/fast_recovery_area/orcl/control02.ctl&#x27;</span></span><br><span class="line">*.db_create_file_dest=<span class="string">&#x27;/oradata/orcl&#x27;</span></span><br><span class="line">*.db_domain=<span class="string">&#x27;&#x27;</span></span><br><span class="line">*.db_name=<span class="string">&#x27;orcl&#x27;</span></span><br><span class="line">*.db_recovery_file_dest=<span class="string">&#x27;/u01/app/oracle/fast_recovery_area&#x27;</span></span><br><span class="line">*.db_recovery_file_dest_size=5501878272</span><br><span class="line">*.deferred_segment_creation=FALSE</span><br><span class="line">*.diagnostic_dest=<span class="string">&#x27;/u01/app/oracle&#x27;</span></span><br><span class="line">*.dispatchers=<span class="string">&#x27;(PROTOCOL=TCP) (SERVICE=orclXDB)&#x27;</span></span><br><span class="line">*.event=<span class="string">&#x27;10949 trace name context forever:28401 trace name context forever,level 1:10849 trace name context forever, level 1:19823 trace name context forever, level 90&#x27;</span></span><br><span class="line">*.open_cursors=300</span><br><span class="line">*.pga_aggregate_target=196083712</span><br><span class="line">*.processes=150</span><br><span class="line">*.result_cache_max_size=0</span><br><span class="line">*.sga_target=784334848</span><br><span class="line">*.db_unique_name=<span class="string">&#x27;orcldg&#x27;</span></span><br><span class="line">*.log_archive_config=<span class="string">&#x27;dg_config=(ORCLDG,ORCL)&#x27;</span></span><br><span class="line">*.log_archive_dest_1=<span class="string">&#x27;location=/archivelog valid_for=(all_logfiles,all_roles) db_unique_name=ORCLDG&#x27;</span></span><br><span class="line">*.log_archive_dest_2=<span class="string">&#x27;service=orcl async valid_for=(online_logfiles,primary_role) db_unique_name=ORCL&#x27;</span></span><br><span class="line">*.log_archive_dest_state_2=<span class="string">&#x27;ENABLE&#x27;</span></span><br><span class="line">*.log_archive_format=<span class="string">&#x27;%t_%s_%r.arc&#x27;</span></span><br><span class="line">*.log_archive_max_processes=4</span><br><span class="line">*.remote_login_passwordfile=<span class="string">&#x27;exclusive&#x27;</span></span><br><span class="line">*.fal_server=<span class="string">&#x27;ORCL&#x27;</span></span><br><span class="line">*.fal_client=<span class="string">&#x27;ORCLDG&#x27;</span></span><br><span class="line">*.db_file_name_convert=<span class="string">&#x27;+DATA&#x27;</span>,<span class="string">&#x27;/oradata&#x27;</span></span><br><span class="line">*.log_file_name_convert=<span class="string">&#x27;+DATA&#x27;</span>,<span class="string">&#x27;/oradata&#x27;</span></span><br><span class="line">*.standby_file_management=<span class="string">&#x27;AUTO&#x27;</span></span><br><span class="line">*.undo_tablespace=<span class="string">&#x27;UNDOTBS1&#x27;</span></span><br></pre></td></tr></table></figure><p>复制密码文件至备库（备库执行），要在 oracle 用户下复制：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">scp oracle@lucifer01:/u01/app/oracle/product/11.2.0/db/dbs/orapworcl1 /u01/app/oracle/product/11.2.0/db/dbs/orapworcl</span><br></pre></td></tr></table></figure><p><strong>5、主库添加 stanby log 文件</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> pagesize100</span><br><span class="line"><span class="keyword">set</span> line222</span><br><span class="line">col <span class="keyword">member</span> <span class="keyword">for</span> a60</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$logfile;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$log;</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong></p><ul><li>stanby log 日志大小与 redo log 日志保持一致</li><li>stanby log 数量： <code>standby logfile=(1+logfile组数)*thread=(1+3)*1=4</code> 组,需要加 4 组 standby logfile</li><li>thread 要与 redo log 保持一致，如果是 rac，需要增加多个 thread 对应的 standby log<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">ADD</span> STANDBY LOGFILE thread <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="number">5</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">6</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">7</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">8</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE <span class="keyword">ADD</span> STANDBY LOGFILE thread <span class="number">2</span></span><br><span class="line"><span class="keyword">group</span> <span class="number">9</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">10</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">11</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M,</span><br><span class="line"><span class="keyword">group</span> <span class="number">12</span> (<span class="string">&#x27;+DATA&#x27;</span>) SIZE <span class="number">120</span>M;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> v$standby_log;</span><br></pre></td></tr></table></figure></li></ul><p><strong>6、备库开启到 nomount 状态</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startup nomount pfile<span class="operator">=</span><span class="string">&#x27;/tmp/initorcldg.ora&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="RMAN-DUPLICATE"><a href="#RMAN-DUPLICATE" class="headerlink" title="RMAN DUPLICATE"></a>RMAN DUPLICATE</h2><p>rman  恢复备库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rman target sys/oracle@orcl1 AUXILIARY sys/oracle@orcldg</span><br><span class="line"></span><br><span class="line">run &#123;</span><br><span class="line">allocate channel prmy1 <span class="built_in">type</span> disk;</span><br><span class="line">allocate channel prmy2 <span class="built_in">type</span> disk;</span><br><span class="line">allocate auxiliary channel aux1 <span class="built_in">type</span> disk;</span><br><span class="line">allocate auxiliary channel aux2 <span class="built_in">type</span> disk;</span><br><span class="line">DUPLICATE TARGET DATABASE FOR STANDBY FROM ACTIVE DATABASE DORECOVER NOFILENAMECHECK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="备库开启日志应用"><a href="#备库开启日志应用" class="headerlink" title="备库开启日志应用"></a>备库开启日志应用</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 首先开启备库至只读状态</span></span><br><span class="line"><span class="keyword">alter</span> database <span class="keyword">open</span> read <span class="keyword">only</span>;</span><br><span class="line"><span class="comment">-- 开启主备同步进程</span></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE RECOVER MANAGED STANDBY DATABASE <span class="keyword">USING</span> <span class="keyword">CURRENT</span> LOGFILE <span class="keyword">DISCONNECT</span> <span class="keyword">FROM</span> SESSION;</span><br><span class="line"><span class="comment">-- 检查备库角色</span></span><br><span class="line"><span class="keyword">select</span> database_role,open_mode <span class="keyword">from</span> v$database;</span><br><span class="line"></span><br><span class="line">DATABASE_ROLE    OPEN_MODE</span><br><span class="line"><span class="comment">---------------- --------------------</span></span><br><span class="line">PHYSICAL STANDBY READ <span class="keyword">ONLY</span> <span class="keyword">WITH</span> APPLY</span><br><span class="line"><span class="comment">-- 检查保护模式，最大性能</span></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span> <span class="keyword">SELECT</span> protection_mode <span class="keyword">FROM</span> v$database;</span><br><span class="line"></span><br><span class="line">PROTECTION_MODE</span><br><span class="line"><span class="comment">--------------------</span></span><br><span class="line">MAXIMUM PERFORMANCE</span><br></pre></td></tr></table></figure><h2 id="主库开启-LOG-ARCHIVE-DEST-STATE-2"><a href="#主库开启-LOG-ARCHIVE-DEST-STATE-2" class="headerlink" title="主库开启 LOG_ARCHIVE_DEST_STATE_2"></a>主库开启 LOG_ARCHIVE_DEST_STATE_2</h2><p>确认主备之前没有问题，主库开启同步：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SYSTEM</span> <span class="keyword">SET</span> LOG_ARCHIVE_DEST_STATE_2<span class="operator">=</span>ENABLE;</span><br></pre></td></tr></table></figure><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>ADG 的搭建过程比较简单，有很多朋友经常问，单机到单机，RAC 到单机，RAC到RAC的教程。其实，这几种搭建方式差别不大，只需要修改一些参数即可！</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> DataGuard </category>
          
          <category> RMAN </category>
          
          <category> RAC </category>
          
          <category> 11GR2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Oracle </tag>
            
            <tag> RAC </tag>
            
            <tag> DataGuard </tag>
            
            <tag> RMAN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux7 安装 Oracle 19C RAC 详细图文教程</title>
      <link href="/post/468da7e1.html"/>
      <url>/post/468da7e1.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前发过一篇Oracle 11G RAC手把手教程，有朋友留言评论：<strong>19C都出了，为什么还在教11G？</strong></p><blockquote><p><strong><a href="http://luciferlpc.top/post/1ae1443c.html">一步步教你Linux7安装Oracle RAC（11GR2版本）</a></strong></p></blockquote><p><strong><font color='orage'>既然如此，那就趁着周末边做边写，来一篇 19C RAC 手把手教程！</font></strong></p><p><strong>📢 注意：</strong> 关于 Oracle RAC 在上一篇中已经讲的很清楚了，不了解的朋友可以点链接🔗看一下再继续读下去。</p><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h1 id="安装前规划"><a href="#安装前规划" class="headerlink" title="安装前规划"></a>安装前规划</h1><p>安装RAC前，当然要先做好规划。具体包含以下几方面：</p><table><thead><tr><th>节点</th><th>主机版本</th><th>主机名</th><th>实例名</th><th>Grid&#x2F;Oracle版本</th><th>Public IP</th><th>Private IP</th><th>Virtual IP</th><th>Scan IP</th></tr></thead><tbody><tr><td>1</td><td>rhel7.9</td><td>p19c01</td><td>p19c01</td><td>19.11.0.0</td><td>10.211.55.100</td><td>1.1.1.1</td><td>10.211.55.102</td><td>10.211.55.105</td></tr><tr><td>2</td><td>rhel7.9</td><td>p19c02</td><td>p19c02</td><td>19.11.0.0</td><td>10.211.55.101</td><td>1.1.1.2</td><td>10.211.55.103</td><td>10.211.55.105</td></tr></tbody></table><h2 id="系统规划"><a href="#系统规划" class="headerlink" title="系统规划"></a>系统规划</h2><ul><li><strong>主机名：</strong> 需要英文字母开头，建议小写，p19c01&#x2F;p19c02  </li><li><strong>集群名称：</strong> 长度不超过15位，p19c-cluster</li><li><strong>Linux系统版本：</strong> RedHat 7.9</li><li><strong>磁盘：</strong> 本地磁盘 100G，用于安装 OS，存放 grid 和 oracle 安装软件，用于 oracle 和 grid 安装目录  </li><li><strong>ASM共享盘：</strong><br>裁决盘OCR：OCR+VOTING&#x3D;10G、冗余模式：EXTERNAL<br>数据盘DATA：DATA&#x3D;20G、冗余模式：EXTERNAL（数据文件，归档日志文件，spfile 文件等）</li><li><strong>RU升级路径：</strong> 19C 的补丁已经不叫PSU，改为 RU</li></ul><p><img src="https://img-blog.csdnimg.cn/20201110104858982.jpg"></p><p>升级需满足条件：</p><ul><li>c&gt;&#x3D;a</li><li>c+d&gt;&#x3D;a+b</li></ul><p>例如：</p><ul><li>19.5.2–&gt;19.8.0（5是a,2是b,8是c,0是d），满足升级需求；</li><li>19.6.2–&gt;19.7.0（虽然7&gt;6，但是7+0&lt;6+2，所以不满足，如果是19.7.1，即可满足）</li></ul><p><strong><font color='orage'>本次是从 19.3.0 升级到 19.11.0，Oracle 官网下载的基础版是 19.3.0！</font></strong></p><h2 id="网络规划"><a href="#网络规划" class="headerlink" title="网络规划"></a>网络规划</h2><p>Public IP（公司内部访问，非外网）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.211.55.100   p19c01  </span><br><span class="line">10.211.55.101   p19c02</span><br></pre></td></tr></table></figure><p>Private IP（用于节点间心跳网络）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.1.1.1   p19c01-priv  </span><br><span class="line">1.1.1.2   p19c02-priv</span><br></pre></td></tr></table></figure><p>Virtual IP（提供客户端访问，漂移）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.211.55.102   p19c01-vip  </span><br><span class="line">10.211.55.103   p19c02-vip</span><br></pre></td></tr></table></figure><p>SCAN IP（提供客户端访问，均衡）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.211.55.105   p19c-scan</span><br></pre></td></tr></table></figure><h2 id="3、存储规划"><a href="#3、存储规划" class="headerlink" title="3、存储规划"></a>3、存储规划</h2><p>Oracle RAC 使用 ASM 存储来存放数据，通常使用 OCR 和 DATA 两个磁盘组！</p><table><thead><tr><th>磁盘名称</th><th>磁盘用途</th><th>磁盘大小</th></tr></thead><tbody><tr><td>asm-ocr</td><td>OCR&#x2F;Voting File</td><td>10G</td></tr><tr><td>asm-data</td><td>Data Files</td><td>20G</td></tr></tbody></table><h1 id="主机配置"><a href="#主机配置" class="headerlink" title="主机配置"></a>主机配置</h1><p><strong><font color='orage'>📢 注意：</font></strong> 以下标题中（**<font color='red'>rac01&amp;rac02</font><strong>）代表节点一和节点二都需要执行，（</strong><font color='red'>rac01</font>**）代表只需要节点一执行。</p><h2 id="Linux主机安装（rac01-amp-rac02）"><a href="#Linux主机安装（rac01-amp-rac02）" class="headerlink" title="Linux主机安装（rac01&amp;rac02）"></a>Linux主机安装（rac01&amp;rac02）</h2><p>安装 Linux 服务器可选择：Centos，Redhat，Oracle Linux。</p><ul><li>RedHat下载：<a href="https://developers.redhat.com/products/rhel/download">https://developers.redhat.com/products/rhel/download</a></li><li>OracleLinux下载：<a href="https://yum.oracle.com/oracle-linux-isos.html">https://yum.oracle.com/oracle-linux-isos.html</a></li><li>Centos下载：<a href="https://vault.centos.org/">https://vault.centos.org/</a></li></ul><p><strong>📢 注意：</strong> 上述 <strong>Linux 安装包</strong> 和 <strong>Oracle 安装包</strong> 可点击链接跳转获取：</p><p><strong>Linux 安装包</strong>： <a href="https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA">https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA</a></p><p><strong>Oracle 安装包</strong>： <a href="https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw">https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw</a></p><p><img src="https://img-blog.csdnimg.cn/20210717224232344.png"></p><p><strong>📢 注意：</strong> Linux 系统的安装本文不做详细演示！</p><h2 id="配置yum源并安装依赖包（rac01-amp-rac02）"><a href="#配置yum源并安装依赖包（rac01-amp-rac02）" class="headerlink" title="配置yum源并安装依赖包（rac01&amp;rac02）"></a>配置yum源并安装依赖包（rac01&amp;rac02）</h2><p>Linux远程连接工具：</p><ul><li>本文将使用XShell和Xftp工具，安装包可以在官网下载，也可私信博主获取。</li><li>其他工具也可以，比如：putty，SecureCRT 等等工具。</li></ul><p>Parallels Desktop挂载Linux主机镜像：</p><p><img src="https://img-blog.csdnimg.cn/20210613010127147.png"></p><p>VMware Workstation挂载Linux镜像：</p><p><img src="https://img-blog.csdnimg.cn/20210613010232723.png"></p><p><strong>📢 注意：</strong> 需要提前挂载系统镜像。</p><p>手动挂载镜像源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt</span><br><span class="line"><span class="built_in">df</span> -Th</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717225145962.png"></p><p>配置yum源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/yum.repos.d/local.repo</span></span><br><span class="line"><span class="string">[local]</span></span><br><span class="line"><span class="string">name=local</span></span><br><span class="line"><span class="string">baseurl=file:///mnt</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">yum repolist all</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717225254161.png"></p><p>安装依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall -y <span class="string">&quot;Server with GUI&quot;</span></span><br><span class="line">yum install -y bc \</span><br><span class="line">binutils \</span><br><span class="line">compat-libcap1 \</span><br><span class="line">compat-libstdc++-33 \</span><br><span class="line">gcc \</span><br><span class="line">gcc-c++ \</span><br><span class="line">elfutils-libelf \</span><br><span class="line">elfutils-libelf-devel \</span><br><span class="line">glibc \</span><br><span class="line">glibc-devel \</span><br><span class="line">ksh \</span><br><span class="line">libaio \</span><br><span class="line">libaio-devel \</span><br><span class="line">libgcc \</span><br><span class="line">libstdc++ \</span><br><span class="line">libstdc++-devel \</span><br><span class="line">libxcb \</span><br><span class="line">libX11 \</span><br><span class="line">libXau \</span><br><span class="line">libXi \</span><br><span class="line">libXtst \</span><br><span class="line">libXrender \</span><br><span class="line">libXrender-devel \</span><br><span class="line">make \</span><br><span class="line">net-tools \</span><br><span class="line">nfs-utils \</span><br><span class="line">smartmontools \</span><br><span class="line">sysstat \</span><br><span class="line">e2fsprogs \</span><br><span class="line">e2fsprogs-libs \</span><br><span class="line">fontconfig-devel \</span><br><span class="line">expect \</span><br><span class="line">unzip \</span><br><span class="line">openssh-clients \</span><br><span class="line">readline* \</span><br><span class="line">tigervnc* \</span><br><span class="line">psmisc --skip-broken</span><br></pre></td></tr></table></figure><p>手动上传并安装依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">rpm -ivh compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021071723053493.png"></p><p>检查依赖包安装情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q bc binutils compat-libcap1 compat-libstdc++-33 gcc gcc-c++ elfutils-libelf elfutils-libelf-devel glibc glibc-devel ksh libaio libaio-devel libgcc libstdc++ libstdc++-devel libxcb libX11 libXau libXi libXtst libXrender libXrender-devel make net-tools nfs-utils smartmontools sysstat e2fsprogs e2fsprogs-libs fontconfig-devel expect unzip openssh-clients readline | grep <span class="string">&quot;not installed&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717231110377.png"></p><p><strong><font color='orage'>📢 注意：</font></strong> 依赖一定要安装成功，否则可能导致安装失败！</p><h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><p>Linux 7 版本可以使用 <code>nmcli</code> 命令来配置网络，以下命令中的 <strong>IP地址、子网掩码、网关</strong> 和 <strong>网卡名称</strong> 请根据实际情况进行修改！</p><p><strong>rac01：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置Public IP</span></span><br><span class="line">nmcli connection modify eth0 ipv4.addresses 10.211.55.100/24 ipv4.gateway 10.211.55.1 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##配置Private IP</span></span><br><span class="line">nmcli connection modify eth1 ipv4.addresses 1.1.1.1/24 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##生效</span></span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli connection up eth1</span><br><span class="line">nmcli connection show</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717231557464.png"><br><strong>rac02：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置Public IP</span></span><br><span class="line">nmcli connection modify eth0 ipv4.addresses 10.211.55.101/24 ipv4.gateway 10.211.55.1 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##配置Private IP</span></span><br><span class="line">nmcli connection modify eth1 ipv4.addresses 1.1.1.2/24 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##生效</span></span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli connection up eth1</span><br><span class="line">nmcli connection show</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717231727745.png"></p><p>最后，配置好网络后，输入命令 <code>ip a</code> 查看网络是否配置成功，尝试 <code>ping</code> 测试网络。</p><h2 id="存储配置（rac01-amp-rac02）"><a href="#存储配置（rac01-amp-rac02）" class="headerlink" title="存储配置（rac01&amp;rac02）"></a>存储配置（rac01&amp;rac02）</h2><p><strong><font color='orage'>Windows 下配置 ISCSI 共享存储可参考：</font></strong></p><blockquote><p><strong><a href="http://luciferlpc.top/post/b153d9c4.html">一步步教你Windows配置ISCSI共享存储</a></strong></p></blockquote><p>配置好共享存储后，在 Linux 主机连接共享存储：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##iscsi识别共享存储</span></span><br><span class="line">yum install -y iscsi-initiator-utils*</span><br><span class="line"><span class="comment">##输出targetname，10.211.55.22为iscsi共享存储设备IP地址</span></span><br><span class="line">iscsiadm -m discovery -t st -p 10.211.55.22</span><br><span class="line"><span class="comment">##连接共享存储</span></span><br><span class="line">iscsiadm -m node -T iqn.2008-08.com.starwindsoftware:10.211.55.22-lucifer -p 10.211.55.22 -l</span><br><span class="line">lsblk</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717233212173.png"></p><p>安装 <code>multipath</code> 绑定多路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##安装multipath</span></span><br><span class="line">yum install -y device-mapper*</span><br><span class="line">mpathconf --<span class="built_in">enable</span> --with_multipathd y</span><br><span class="line"><span class="comment">##查看共享盘的scsi_id</span></span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdb</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdc</span><br></pre></td></tr></table></figure><p>配置 multipath 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;/etc/multipath.conf</span></span><br><span class="line"><span class="string">defaults &#123;</span></span><br><span class="line"><span class="string">    user_friendly_names yes</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">blacklist &#123;</span></span><br><span class="line"><span class="string">  devnode &quot;^sda&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">multipaths &#123;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;27e2b3ddbb7fbeb41&quot;</span></span><br><span class="line"><span class="string">  alias asm_ocr</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;2852b96c12f460ade&quot;</span></span><br><span class="line"><span class="string">  alias asm_data</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> wwid的值为上面获取的scsi_id，alias可自定义，这里配置1块OCR盘，1块DATA盘！</p><p><img src="https://img-blog.csdnimg.cn/20210717233536124.png"></p><p>激活multipath多路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">multipath -F</span><br><span class="line">multipath -v2</span><br><span class="line">multipath -ll</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717233628633.png"></p><p>配置UDEV绑盘：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /dev/mapper/udev_info</span><br><span class="line"><span class="built_in">rm</span> -rf /etc/udev/rules.d/99-oracle-asmdevices.rules</span><br><span class="line"><span class="built_in">cd</span> /dev/mapper</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> asm_*; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%s %s\n&quot;</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span> <span class="string">&quot;<span class="subst">$(udevadm info --query=all --name=/dev/mapper/<span class="string">&quot;<span class="variable">$i</span>&quot;</span> | grep -i dm_uuid)</span>&quot;</span> &gt;&gt;/dev/mapper/udev_info</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> -r line; <span class="keyword">do</span></span><br><span class="line">    dm_uuid=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span> | awk -F<span class="string">&#x27;=&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">    disk_name=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;KERNEL==\&quot;dm-*\&quot;,ENV&#123;DM_UUID&#125;==\&quot;<span class="variable">$&#123;dm_uuid&#125;</span>\&quot;,SYMLINK+=\&quot;<span class="variable">$&#123;disk_name&#125;</span>\&quot;,OWNER=\&quot;grid\&quot;,GROUP=\&quot;asmadmin\&quot;,MODE=\&quot;0660\&quot;&quot;</span> &gt;&gt;/etc/udev/rules.d/99-oracle-asmdevices.rules</span><br><span class="line"><span class="keyword">done</span> &lt;/dev/mapper/udev_info</span><br><span class="line"><span class="comment">##重载udev</span></span><br><span class="line">udevadm control --reload-rules</span><br><span class="line">udevadm trigger --<span class="built_in">type</span>=devices</span><br><span class="line">ll /dev/asm*</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717233945399.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718000522168.png"></p><p><strong><font color='orage'>📢 注意：</font></strong> 这里由于没有创建 grid 用户，因此权限和组是 root，等创建 grid 用户后，再次重载 udev 即可！</p><p>确认配置完成后，分别在两个节点输入命令 <code>ls /dev/asm*</code> 查看是否已经成功绑定！</p><h2 id="hosts文件配置（rac01-amp-rac02）"><a href="#hosts文件配置（rac01-amp-rac02）" class="headerlink" title="hosts文件配置（rac01&amp;rac02）"></a>hosts文件配置（rac01&amp;rac02）</h2><p>配置hostname：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname p19c01</span><br><span class="line">hostnamectl set-hostname p19c02</span><br></pre></td></tr></table></figure><p>配置hosts文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">#Public IP</span></span><br><span class="line"><span class="string">10.211.55.100   p19c01</span></span><br><span class="line"><span class="string">10.211.55.101   p19c02</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Private IP</span></span><br><span class="line"><span class="string">1.1.1.1 p19c01-priv</span></span><br><span class="line"><span class="string">1.1.1.2 p19c02-priv</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Vip IP</span></span><br><span class="line"><span class="string">10.211.55.102 p19c01-vip</span></span><br><span class="line"><span class="string">10.211.55.103 p19c02-vip</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Scan IP</span></span><br><span class="line"><span class="string">10.211.55.105 p19c-scan</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717234357986.png"></p><h2 id="防火墙配置（rac01-amp-rac02）"><a href="#防火墙配置（rac01-amp-rac02）" class="headerlink" title="防火墙配置（rac01&amp;rac02）"></a>防火墙配置（rac01&amp;rac02）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line">systemctl status firewalld.service</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717234613985.png"></p><h2 id="selinux-配置（rac01-amp-rac02）"><a href="#selinux-配置（rac01-amp-rac02）" class="headerlink" title="selinux 配置（rac01&amp;rac02）"></a>selinux 配置（rac01&amp;rac02）</h2><p>配置 selinux 临时生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27;</span> /etc/selinux/config</span><br><span class="line">setenforce 0</span><br><span class="line">getenforce</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021071723492973.png"></p><p><strong>📢 注意：</strong> selinux 配置需要重启生效！</p><h2 id="时间同步配置（rac01-amp-rac02）"><a href="#时间同步配置（rac01-amp-rac02）" class="headerlink" title="时间同步配置（rac01&amp;rac02）"></a>时间同步配置（rac01&amp;rac02）</h2><p>禁用chronyd：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y chrony</span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br><span class="line">systemctl stop chronyd.service</span><br><span class="line">systemctl <span class="built_in">disable</span> chronyd.service</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717235037420.png"></p><p>配置ntpdate时间同步计划任务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install -y ntpdate</span><br><span class="line"><span class="comment">##10.211.55.200为时间服务器IP，每天12点同步系统时间</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/var/spool/cron/root</span></span><br><span class="line"><span class="string">00 12 * * * /usr/sbin/ntpdate -u 10.211.55.200 &amp;&amp; /usr/sbin/hwclock -w</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##查看计划任务</span></span><br><span class="line">crontab -l</span><br><span class="line"><span class="comment">##手动执行</span></span><br><span class="line">/usr/sbin/ntpdate -u 10.211.55.200 &amp;&amp; /usr/sbin/hwclock -w</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717235139259.png"></p><h2 id="关闭透明大页和NUMA（rac01-amp-rac02）"><a href="#关闭透明大页和NUMA（rac01-amp-rac02）" class="headerlink" title="关闭透明大页和NUMA（rac01&amp;rac02）"></a>关闭透明大页和NUMA（rac01&amp;rac02）</h2><p>Linux 7 配置内核文件，关闭透明大页和numa：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/quiet/quiet transparent_hugepage=never numa=off/&#x27;</span> /etc/default/grub</span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br></pre></td></tr></table></figure><p>重启后检查是否生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="built_in">cat</span> /proc/cmdline</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021071723543695.png"></p><p><strong>📢 注意：</strong> 关闭 <code>透明大页</code> 和 <code>numa</code> 的配置，需要重启主机生效！</p><h2 id="avahi-daemon-配置（rac01-amp-rac02）"><a href="#avahi-daemon-配置（rac01-amp-rac02）" class="headerlink" title="avahi-daemon 配置（rac01&amp;rac02）"></a>avahi-daemon 配置（rac01&amp;rac02）</h2><p>有些主机安装选择最小化安装，没有安装 avahi-daemon 功能，建议安装之后禁用，防止以后误操作导致出问题：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum install -y avahi*</span><br><span class="line">systemctl stop avahi-daemon.socket</span><br><span class="line">systemctl stop avahi-daemon.service</span><br><span class="line">pgrep -f avahi-daemon | awk <span class="string">&#x27;&#123;print &quot;kill -9 &quot;$2&#125;&#x27;</span></span><br><span class="line">systemctl <span class="built_in">disable</span> avahi-daemon.socket</span><br><span class="line">systemctl <span class="built_in">disable</span> avahi-daemon.service</span><br></pre></td></tr></table></figure><p>配置 NOZEROCONF：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/sysconfig/network</span></span><br><span class="line"><span class="string">NOZEROCONF=yes</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717235645511.png"></p><h2 id="系统参数配置（rac01-amp-rac02）"><a href="#系统参数配置（rac01-amp-rac02）" class="headerlink" title="系统参数配置（rac01&amp;rac02）"></a>系统参数配置（rac01&amp;rac02）</h2><p>安装 Oracle 数据库需要配置系统参数，以下使用脚本命令一键式配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">memTotal=$(grep MemTotal /proc/meminfo | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">totalMemory=$((memTotal / <span class="number">2048</span>))</span><br><span class="line">shmall=$((memTotal / <span class="number">4</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$shmall</span> -lt 2097152 ]; <span class="keyword">then</span></span><br><span class="line">    shmall=2097152</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">shmmax=$((memTotal * <span class="number">1024</span> - <span class="number">1</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$shmmax</span>&quot;</span> -lt 4294967295 ]; <span class="keyword">then</span></span><br><span class="line">    shmmax=4294967295</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/sysctl.conf</span></span><br><span class="line"><span class="string">fs.aio-max-nr = 1048576</span></span><br><span class="line"><span class="string">fs.file-max = 6815744</span></span><br><span class="line"><span class="string">kernel.shmall = $shmall</span></span><br><span class="line"><span class="string">kernel.shmmax = $shmmax</span></span><br><span class="line"><span class="string">kernel.shmmni = 4096</span></span><br><span class="line"><span class="string">kernel.sem = 250 32000 100 128</span></span><br><span class="line"><span class="string">net.ipv4.ip_local_port_range = 9000 65500</span></span><br><span class="line"><span class="string">net.core.rmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.rmem_max = 4194304</span></span><br><span class="line"><span class="string">net.core.wmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.wmem_max = 1048576</span></span><br><span class="line"><span class="string">net.ipv4.conf.eth0.rp_filter = 1</span></span><br><span class="line"><span class="string">net.ipv4.conf.eth1.rp_filter = 2</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>生效系统参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717235756394.png"></p><h2 id="系统资源限制配置（rac01-amp-rac02）"><a href="#系统资源限制配置（rac01-amp-rac02）" class="headerlink" title="系统资源限制配置（rac01&amp;rac02）"></a>系统资源限制配置（rac01&amp;rac02）</h2><p>配置limits.conf：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/security/limits.conf</span></span><br><span class="line"><span class="string">oracle soft nofile 1024</span></span><br><span class="line"><span class="string">oracle hard nofile 65536</span></span><br><span class="line"><span class="string">oracle soft stack 10240</span></span><br><span class="line"><span class="string">oracle hard stack 32768</span></span><br><span class="line"><span class="string">oracle soft nproc 2047</span></span><br><span class="line"><span class="string">oracle hard nproc 16384</span></span><br><span class="line"><span class="string">oracle hard memlock 134217728</span></span><br><span class="line"><span class="string">oracle soft memlock 134217728</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">grid soft nofile 1024</span></span><br><span class="line"><span class="string">grid hard nofile 65536</span></span><br><span class="line"><span class="string">grid soft stack 10240</span></span><br><span class="line"><span class="string">grid hard stack 32768</span></span><br><span class="line"><span class="string">grid soft nproc 2047</span></span><br><span class="line"><span class="string">grid hard nproc 16384</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>配置pam.d&#x2F;login：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/pam.d/login</span></span><br><span class="line"><span class="string">session required pam_limits.so</span></span><br><span class="line"><span class="string">session required /lib64/security/pam_limits.so</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210717235936620.png"></p><h2 id="用户及组、目录创建（rac01-amp-rac02）"><a href="#用户及组、目录创建（rac01-amp-rac02）" class="headerlink" title="用户及组、目录创建（rac01&amp;rac02）"></a>用户及组、目录创建（rac01&amp;rac02）</h2><p>创建安装 Oracle 数据库所需的用户、组以及安装目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/groupadd -g 54321 oinstall</span><br><span class="line">/usr/sbin/groupadd -g 54322 dba</span><br><span class="line">/usr/sbin/groupadd -g 54323 oper</span><br><span class="line">/usr/sbin/groupadd -g 54324 backupdba</span><br><span class="line">/usr/sbin/groupadd -g 54325 dgdba</span><br><span class="line">/usr/sbin/groupadd -g 54326 kmdba</span><br><span class="line">/usr/sbin/groupadd -g 54327 asmdba</span><br><span class="line">/usr/sbin/groupadd -g 54328 asmoper</span><br><span class="line">/usr/sbin/groupadd -g 54329 asmadmin</span><br><span class="line">/usr/sbin/groupadd -g 54330 racdba</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718000034181.png"><br>grid&#x2F;oracle 用户创建：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/useradd -u 11012 -g oinstall -G asmadmin,asmdba,asmoper,dba,racdba,oper grid</span><br><span class="line">/usr/sbin/useradd -u 54321 -g oinstall -G asmdba,dba,backupdba,dgdba,kmdba,racdba,oper oracle</span><br><span class="line"><span class="comment">##修改用户密码为oracle</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;oracle&quot;</span> |passwd oracle --stdin</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;oracle&quot;</span> |passwd grid --stdin</span><br><span class="line"><span class="comment">##查看用户组</span></span><br><span class="line"><span class="built_in">id</span> grid</span><br><span class="line"><span class="built_in">id</span> oracle</span><br><span class="line"><span class="comment">##重载udev</span></span><br><span class="line">udevadm control --reload-rules</span><br><span class="line">udevadm trigger --type-devices</span><br><span class="line">ll /dev/asm*</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718000351614.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718000557782.png"></p><p><strong><font color='orage'>📢 注意：</font></strong> 这里udev重载之后，绑盘权限已经变成 grid 了！</p><p>创建软件目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /u01/app/19.3.0/grid</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/grid</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/product/19.3.0/db</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oraInventory</span><br><span class="line"><span class="built_in">mkdir</span> -p /backup</span><br><span class="line"><span class="built_in">mkdir</span> -p /home/oracle/scripts</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /backup</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /home/oracle/scripts</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/grid</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/19.3.0/grid</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/oraInventory</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /u01/app/oracle</span><br><span class="line"><span class="built_in">chmod</span> -R 775 /u01</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021071800081497.png"></p><h2 id="环境变量配置（rac01-amp-rac02）"><a href="#环境变量配置（rac01-amp-rac02）" class="headerlink" title="环境变量配置（rac01&amp;rac02）"></a>环境变量配置（rac01&amp;rac02）</h2><p>grid用户环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/home/grid/.bash_profile</span></span><br><span class="line"><span class="string">################OracleBegin#########################</span></span><br><span class="line"><span class="string">umask 022</span></span><br><span class="line"><span class="string">export TMP=/tmp</span></span><br><span class="line"><span class="string">export TMPDIR=\$TMP</span></span><br><span class="line"><span class="string">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span></span><br><span class="line"><span class="string">export ORACLE_BASE=/u01/app/grid</span></span><br><span class="line"><span class="string">export ORACLE_HOME=/u01/app/19.3.0/grid</span></span><br><span class="line"><span class="string">export ORACLE_TERM=xterm</span></span><br><span class="line"><span class="string">export TNS_ADMIN=\$ORACLE_HOME/network/admin</span></span><br><span class="line"><span class="string">export LD_LIBRARY_PATH=\$ORACLE_HOME/lib:/lib:/usr/lib</span></span><br><span class="line"><span class="string">export ORACLE_SID=+ASM1</span></span><br><span class="line"><span class="string">export PATH=/usr/sbin:\$PATH</span></span><br><span class="line"><span class="string">export PATH=\$ORACLE_HOME/bin:\$ORACLE_HOME/OPatch:\$PATH</span></span><br><span class="line"><span class="string">alias sas=&#x27;sqlplus / as sysasm&#x27;</span></span><br><span class="line"><span class="string">export PS1=&quot;[\`whoami\`@\`hostname\`:&quot;&#x27;\$PWD]\$ &#x27;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718001131571.png"></p><p><strong>📢 注意：</strong> 每个节点的 ORACLE_SID 不一样（+ASM1&#x2F;+ASM2），需要自行修改！</p><p>oracle用户环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/home/oracle/.bash_profile</span></span><br><span class="line"><span class="string">################OracleBegin#########################</span></span><br><span class="line"><span class="string">umask 022</span></span><br><span class="line"><span class="string">export TMP=/tmp</span></span><br><span class="line"><span class="string">export TMPDIR=\$TMP</span></span><br><span class="line"><span class="string">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span></span><br><span class="line"><span class="string">export ORACLE_BASE=/u01/app/oracle</span></span><br><span class="line"><span class="string">export ORACLE_HOME=\$ORACLE_BASE/product/19.3.0/db</span></span><br><span class="line"><span class="string">export ORACLE_HOSTNAME=p19c01</span></span><br><span class="line"><span class="string">export ORACLE_TERM=xterm</span></span><br><span class="line"><span class="string">export TNS_ADMIN=\$ORACLE_HOME/network/admin</span></span><br><span class="line"><span class="string">export LD_LIBRARY_PATH=\$ORACLE_HOME/lib:/lib:/usr/lib</span></span><br><span class="line"><span class="string">export ORACLE_SID=p19c01</span></span><br><span class="line"><span class="string">export PATH=/usr/sbin:\$PATH</span></span><br><span class="line"><span class="string">export PATH=\$ORACLE_HOME/bin:\$ORACLE_HOME/OPatch:\$PATH</span></span><br><span class="line"><span class="string">alias sas=&#x27;sqlplus / as sysdba&#x27;</span></span><br><span class="line"><span class="string">export PS1=&quot;[\`whoami\`@\`hostname\`:&quot;&#x27;\$PWD]\$ &#x27;</span></span><br><span class="line"><span class="string">################OracleEnd#########################</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718001041760.png"></p><p><strong>📢 注意：</strong> 每个节点的 ORACLE_HOSTNAME（p19c01&#x2F;p19c02）和 ORACLE_SID（p19c01&#x2F;p19c02）不一样，需要自行修改！</p><h2 id="安装介质上传解压（rac01）"><a href="#安装介质上传解压（rac01）" class="headerlink" title="安装介质上传解压（rac01）"></a>安装介质上传解压（rac01）</h2><p>安装包使用   XFTP 工具进行上传，只需要上传至一节点 &#x2F;soft 目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##创建安装介质存放目录</span></span><br><span class="line"><span class="built_in">mkdir</span> /soft</span><br><span class="line"><span class="comment">##上传安装介质到/soft目录</span></span><br><span class="line">LINUX.X64_193000_db_home.zip</span><br><span class="line">LINUX.X64_193000_grid_home.zip</span><br><span class="line">p32545008_190000_Linux-x86-64.zip</span><br><span class="line">p6880880_190000_Linux-x86-64.zip</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 19C 的安装包需要解压到对应的 ORACLE_HOME 目录下！</p><p>静默解压grid安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft</span><br><span class="line">su - grid -c <span class="string">&quot;unzip -q /soft/LINUX.X64_193000_grid_home.zip -d /u01/app/19.3.0/grid/&quot;</span></span><br></pre></td></tr></table></figure><p>静默解压oracle安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft</span><br><span class="line">su - oracle -c <span class="string">&quot;unzip -q /soft/LINUX.X64_193000_db_home.zip -d /u01/app/oracle/product/19.3.0/db/&quot;</span></span><br></pre></td></tr></table></figure><p>静默解压补丁安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line"><span class="comment">##解压RU补丁包</span></span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft</span><br><span class="line">su - grid -c <span class="string">&quot;unzip -q -o /soft/p6880880_190000_Linux-x86-64.zip -d /u01/app/19.3.0/grid&quot;</span></span><br><span class="line"><span class="comment">##解压OPatch补丁包</span></span><br><span class="line">su - grid -c <span class="string">&quot;unzip -q /soft/p32545008_190000_Linux-x86-64.zip -d /soft&quot;</span></span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft</span><br><span class="line">su - oracle -c <span class="string">&quot;unzip -q -o /soft/p6880880_190000_Linux-x86-64.zip -d /u01/app/oracle/product/19.3.0/db&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718005024263.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718005357594.png"></p><p><strong>📢 注意：</strong> 由于19C支持安装grid软件前打RU补丁，因此提前解压OPatch和RU补丁，为安装做准备！</p><p>root用户下，cvuqdisk安装（rac01&amp;rac02）：</p><p><img src="https://img-blog.csdnimg.cn/20210718002848479.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh /u01/app/19.3.0/grid/cv/rpm/cvuqdisk-1.0.10-1.rpm</span><br><span class="line"><span class="comment">##传输到节点二安装</span></span><br><span class="line">scp cvuqdisk-1.0.10-1.rpm p19c02:/soft</span><br><span class="line">rpm -ivh /soft/cvuqdisk-1.0.10-1.rpm</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718003017897.png"></p><p><strong>📢 注意：</strong> 19C 版本的 cvu 包换位置了，目录为：<code>$ORACLE_HOME/cv/rpm/</code>，以上所有软件只需要在节点一上传解压即可。</p><p><strong><font color='orage'>至此，准备工作已经完成，安装前重启主机！</font></strong></p><p>重启后，检查 selinux、numa 和透明大页：</p><p><img src="https://img-blog.csdnimg.cn/20210718003356383.png"></p><h1 id="安装Grid软件（rac01）"><a href="#安装Grid软件（rac01）" class="headerlink" title="安装Grid软件（rac01）"></a>安装Grid软件（rac01）</h1><p>关于 <code>VNC</code> 配置具体可参考文章：</p><blockquote><p><strong><a href="https://luciferliu.blog.csdn.net/article/details/120210818">Linux 配置 VNC 远程桌面</a></strong></p></blockquote><p>配置 grid 用户 vnc 图形界面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##root用户下切换到grid用户</span></span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft</span><br><span class="line">su - grid</span><br><span class="line"><span class="comment">##执行vncserver，按提示输入密码即可</span></span><br><span class="line">vncserver</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718003617471.png"></p><p>在 vnc 客户端界面输入 10.211.55.100:1，输入刚才输入的密码即可连接：</p><p><img src="https://img-blog.csdnimg.cn/20210718003654329.png"><br><img src="https://img-blog.csdnimg.cn/2021061302342734.png"></p><p>打开终端命令行：</p><p><img src="https://img-blog.csdnimg.cn/20210718004438394.png"></p><p>开始安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##应用环境变量</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="comment">##进入安装目录</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$ORACLE_HOME</span></span><br><span class="line"><span class="comment">##执行安装程序开始安装，通过-applyRU参数指向补丁解压位置，提前安装grid补丁</span></span><br><span class="line">./gridSetup.sh -applyRU /soft/32545008</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718005605126.png"></p><p><strong>注意：</strong> 可以看到，已经开始对ORACLE_HOME进行补丁安装。</p><p>补丁打完，进入安装界面，选择集群安装：</p><p><img src="https://img-blog.csdnimg.cn/20210718011308119.png"></p><p>选择 standlone 模式：</p><p><img src="https://img-blog.csdnimg.cn/20210718011413978.png"></p><p>修改 scan 名称，与 hosts 文件配置 scan 名称保持一致：</p><p><img src="https://img-blog.csdnimg.cn/20210718011546319.png"></p><p><img src="https://img-blog.csdnimg.cn/2021071801151819.png"></p><p>添加节点二信息，进行互信：</p><p><img src="https://img-blog.csdnimg.cn/20210718011702611.png"></p><p>输入 grid 用户密码，创建用户时两节点必须保持一致。先执行 setup，再执行 test，开始互信：</p><p><img src="https://img-blog.csdnimg.cn/20210718011814744.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718011930357.png"></p><p>确保对应网卡和IP网段对应即可，19C 心跳网段需要选 ASM &amp; Private，用于 ASM 实例的托管：</p><p><img src="https://img-blog.csdnimg.cn/2021071801205657.png"></p><p>选择存储类型，19C 只有两个选项，ASM 只能选 Flex：</p><p><img src="https://img-blog.csdnimg.cn/20210718012309166.png"></p><p>GIMR，这里不选择安装：</p><p><img src="https://img-blog.csdnimg.cn/20210718012402856.png"></p><p>安装时填创建 OCR 盘，一块盘冗余 External，目录选择udev绑的路径：</p><p><img src="https://img-blog.csdnimg.cn/20210718012535756.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718012741909.png"></p><p>填写 sys&#x2F;system 密码，需要记住自己设置的密码：</p><p><img src="https://img-blog.csdnimg.cn/20210718012827727.png"></p><p>默认即可：</p><p><img src="https://img-blog.csdnimg.cn/20210718012917476.png"></p><p>EM 选择不开，比较占资源，后面安装好后可以配置：</p><p><img src="https://img-blog.csdnimg.cn/2021071801294732.png"></p><p>默认即可：</p><p><img src="https://img-blog.csdnimg.cn/20210718013012695.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718013101531.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718013124574.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718013141485.png"></p><p>安装预检查，由于我们只配了一个SCAN，所以关于 DNS 相关的都无视，继续：</p><p><img src="https://img-blog.csdnimg.cn/20210718013451151.png"></p><p>开始安装 grid：</p><p><img src="https://img-blog.csdnimg.cn/20210718013601114.png"></p><p>两节点顺序执行 root.sh，先节点一执行完，再节点二执行：</p><p><img src="https://img-blog.csdnimg.cn/20210718014246725.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718015347760.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718015407616.png"></p><p>两个节点的 root.sh 都执行完之后，继续安装：</p><p><img src="https://img-blog.csdnimg.cn/20210718020111559.png"></p><p>这个错误查过 MOS 可以忽略：</p><p><img src="https://img-blog.csdnimg.cn/20210718020432177.png"></p><p>安装完成：</p><p><img src="https://img-blog.csdnimg.cn/20210718020501570.png"></p><p>检查集群状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su - grid</span><br><span class="line">crsctl <span class="built_in">stat</span> res -t</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718020948950.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718021008505.png"></p><p>检查 grid 补丁：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - grid</span><br><span class="line">opatch lspatches</span><br><span class="line">sqlplus -version</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718021356939.png"></p><h1 id="创建-ASM-数据盘-DATA"><a href="#创建-ASM-数据盘-DATA" class="headerlink" title="创建 ASM 数据盘 DATA"></a>创建 ASM 数据盘 DATA</h1><p>这里创建的 DATA 磁盘组主要用于存放数据文件、日志文件等数据库文件！</p><p>使用图形化方式添加 ASM DATA 数据盘：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asmca</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718021645115.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718021725566.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718021756137.png"></p><p>检查 asm 磁盘：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asmcmd lsdg</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718021911789.png"><br><strong><font color='orage'>建议重启两台主机，检查重启后 Grid 集群是否正常运行！</font></strong></p><h1 id="安装Oracle软件"><a href="#安装Oracle软件" class="headerlink" title="安装Oracle软件"></a>安装Oracle软件</h1><p>配置 oracle 用户 vnc 图形界面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft</span><br><span class="line"><span class="comment">##root用户下切换到grid用户</span></span><br><span class="line">su - oracle</span><br><span class="line"><span class="comment">##执行vncserver，按提示输入密码即可</span></span><br><span class="line">vncserver</span><br><span class="line"><span class="comment">##在vnc客户端界面输入10.211.55.100:1，输入刚才输入的密码即可连接。</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718093255230.png"></p><p>在 vnc 客户端界面输入 10.211.55.100:1，输入刚才输入的密码即可连接：</p><p><img src="https://img-blog.csdnimg.cn/20210718003654329.png"></p><p><img src="https://img-blog.csdnimg.cn/2021061302342734.png"></p><p>右键打开终端：</p><p><img src="https://img-blog.csdnimg.cn/20210718093354501.png"></p><p>开始安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##应用环境变量</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="comment">##进入ORACLE_HOME目录</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$ORACLE_HOME</span></span><br><span class="line"><span class="comment">##执行安装程序开始安装，加上jar包防止弹窗不显示问题</span></span><br><span class="line">./runInstaller -applyRU /soft/32545008/</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718093720977.png"></p><p><strong>📢 注意：</strong> 可以看到，已经开始对 ORACLE_HOME 进行补丁安装！</p><p>补丁打完，进入安装界面，选择仅安装 Oracle 软件：</p><p><img src="https://img-blog.csdnimg.cn/20210718095127864.png"></p><p>选择集群模式：</p><p><img src="https://img-blog.csdnimg.cn/20210718095159680.png"></p><p>输入 oracle 用户密码，先执行 setup，再执行 test，开始互信：</p><p><img src="https://img-blog.csdnimg.cn/20210718095312649.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718095857287.png"></p><p>选择企业版：</p><p><img src="https://img-blog.csdnimg.cn/20210718095924981.png"></p><p>默认即可：</p><p><img src="https://img-blog.csdnimg.cn/2021071809594866.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718100009917.png"></p><p><img src="https://img-blog.csdnimg.cn/2021071810002896.png"></p><p>安装预检查，由于我们只配了一个 SCAN，所以关于 DNS 相关的都无视，继续：</p><p><img src="https://img-blog.csdnimg.cn/20210718100151168.png"></p><p>开始安装：</p><p><img src="https://img-blog.csdnimg.cn/20210718100219637.png"></p><p>root 用户下，两个节点顺序执行 root.sh：</p><p><img src="https://img-blog.csdnimg.cn/20210718101112209.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718101155411.png"></p><p>安装完成：</p><p><img src="https://img-blog.csdnimg.cn/20210718101236249.png"></p><p>检查补丁版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - oracle</span><br><span class="line">opatch lspatches</span><br><span class="line">sqlplus -version</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718101408589.png"><strong><font color='orage'>至此，Oracle 软件已成功安装！</font></strong></p><h1 id="创建数据库实例"><a href="#创建数据库实例" class="headerlink" title="创建数据库实例"></a>创建数据库实例</h1><p>这里建库还是在第四步安装 Oracle 软件的 vnc 界面中继续：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718102036139.png"></p><p>选择创建数据库实例：</p><p><img src="https://img-blog.csdnimg.cn/20210718102017983.png"></p><p>选择自定义模式：</p><p><img src="https://img-blog.csdnimg.cn/20210718102212839.png"></p><p>选择基础安装即可：</p><p><img src="https://img-blog.csdnimg.cn/2021071810225150.png"></p><p>选择节点：</p><p><img src="https://img-blog.csdnimg.cn/20210718102319376.png"></p><p>填写实例名 p19c0，由于默认添加为1，2，实例名规划为 p19c01&#x2F;02，所以需要加个0；选择安装 CDB 模式，不创建PDB：</p><p><img src="https://img-blog.csdnimg.cn/20210718102530884.png"></p><p>默认即可，使用 OMF 模式：</p><p><img src="https://img-blog.csdnimg.cn/20210718102642232.png"></p><p>不开闪回，不开归档，可以建完实例后再配置：</p><p><img src="https://img-blog.csdnimg.cn/20210718102744199.png"></p><p>配置内存，使用 ASMM 模式，数据库总内存占用物理内存 70%-90% 之间：</p><p><img src="https://img-blog.csdnimg.cn/20210718102922617.png"></p><p>使用基础模式安装，block_size 是无法修改的，process 进程数修改为1500，根据实际情况修改：</p><p><img src="https://img-blog.csdnimg.cn/20210718103028764.png"></p><p>配置数据库字符集，默认 AL32UTF8，国家字符集，默认 AL16UTF16；根据实际情况修改：</p><p><img src="https://img-blog.csdnimg.cn/20210718103114170.png"></p><p>建议全关掉，有可能导致 bug：</p><p><img src="https://img-blog.csdnimg.cn/20210718103245681.png"></p><p>填写sys&#x2F;system密码：</p><p><img src="https://img-blog.csdnimg.cn/20210718103342490.png"></p><p>默认即可：</p><p><img src="https://img-blog.csdnimg.cn/20210718103411480.png"></p><p>安装预检查，DNS 相关忽略：</p><p><img src="https://img-blog.csdnimg.cn/20210718103526498.png"></p><p>开始安装：</p><p><img src="https://img-blog.csdnimg.cn/20210718103644509.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718112853829.png"></p><p>经过漫长的等待，数据库建完了：</p><p><img src="https://img-blog.csdnimg.cn/20210718112954703.png"></p><p><img src="https://img-blog.csdnimg.cn/20210718113038120.png"></p><p><strong><font color='orage'>至此，数据库实例创建完成！</font></strong></p><h1 id="数据库优化配置（rac01）"><a href="#数据库优化配置（rac01）" class="headerlink" title="数据库优化配置（rac01）"></a>数据库优化配置（rac01）</h1><h2 id="开启数据库归档模式"><a href="#开启数据库归档模式" class="headerlink" title="开启数据库归档模式"></a>开启数据库归档模式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##关闭数据库实例</span></span><br><span class="line">srvctl stop database -d p19c0</span><br><span class="line"><span class="comment">##开启单个节点到mount模式</span></span><br><span class="line">srvctl start instance -d p19c0 -i p19c01 -o mount</span><br><span class="line"><span class="comment">##开启归档</span></span><br><span class="line">sqlplus / as sysdba</span><br><span class="line">alter database archivelog;</span><br><span class="line"><span class="comment">##设置归档路径</span></span><br><span class="line">ALTER SYSTEM SET LOG_ARCHIVE_DEST_1=<span class="string">&#x27;LOCATION=+DATA&#x27;</span>;</span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"><span class="comment">##重启数据库实例</span></span><br><span class="line">srvctl stop instance -d p19c0 -i p19c01</span><br><span class="line">srvctl start database -d p19c0</span><br><span class="line"><span class="comment">##检查归档</span></span><br><span class="line">sqlplus / as sysdba</span><br><span class="line">archive <span class="built_in">log</span> list</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021071811373943.png"></p><h2 id="配置定期删除归档计划任务"><a href="#配置定期删除归档计划任务" class="headerlink" title="配置定期删除归档计划任务"></a>配置定期删除归档计划任务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##进入oracle用户</span></span><br><span class="line">su - oracle</span><br><span class="line"><span class="built_in">mkdir</span> -p /home/oracle/scripts/</span><br><span class="line"><span class="comment">##写入脚本</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;source ~/.bash_profile&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;deltime=`date +&quot;20%y%m%d%H%M%S&quot;`&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;rman target / nocatalog msglog /home/oracle/scripts/del_arch_\$&#123;deltime&#125;.log&lt;&lt;EOF&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;crosscheck archivelog all;&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;delete noprompt archivelog until time &#x27;sysdate-7&#x27;;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;delete noprompt force archivelog until time &#x27;SYSDATE-10&#x27;;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#125; &gt;&gt;/home/oracle/scripts/del_arch.sh</span><br><span class="line"><span class="built_in">chmod</span> +x /home/oracle/scripts/del_arch.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718113908434.png"></p><p>切换到 oracle 用户写入计划任务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/var/spool/cron/oracle</span></span><br><span class="line"><span class="string">12 00 * * * /home/oracle/scripts/del_arch.sh</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##手动执行测试</span></span><br><span class="line">su - oracle</span><br><span class="line">/home/oracle/scripts/del_arch.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210718114037609.png"></p><h2 id="配置数据库开机自启"><a href="#配置数据库开机自启" class="headerlink" title="配置数据库开机自启"></a>配置数据库开机自启</h2><p>配置数据库实例随集群服务自启动：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##root用户下执行</span></span><br><span class="line">/u01/app/19.3.0/grid/bin/crsctl modify resource <span class="string">&quot;ora.p19c0.db&quot;</span> -attr <span class="string">&quot;AUTO_START=always&quot;</span> -unsupported</span><br></pre></td></tr></table></figure><p><strong>注意：</strong> <code>ora.p19c0.db</code>中的 p19c0 是指 db 名称；需要在 root 用户下执行！</p><p><strong><font color='orage'>所有都配置完成之后，关闭数据库，重启主机！</font></strong></p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> Linux </category>
          
          <category> redhat7 </category>
          
          <category> RAC </category>
          
          <category> 19C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Oracle </tag>
            
            <tag> 19C </tag>
            
            <tag> RAC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux 常用命令总结</title>
      <link href="/post/5bf4aca3.html"/>
      <url>/post/5bf4aca3.html</url>
      
        <content type="html"><![CDATA[<h1 id="🌲-前言"><a href="#🌲-前言" class="headerlink" title="🌲 前言"></a>🌲 前言</h1><p><strong>为什么要学习 Linux 命令？</strong></p><p>目前企业有超过 80% 甚至更多的系统都是 Linux 操作系统，所以不管是做开发还是运维，不会点 Linux 知识肯定是无法进入到企业里工作。而且，很多企业的岗位职责里写要需要精通 Linux 。</p><p><img src="https://img-blog.csdnimg.cn/570025d72fca4f628c788f2d13ad5340.png"></p><p>Linux 的从业方向也比较广，主要分为 <code>运维</code> 和 <code>开发</code> ，细分下来就数不胜数了，基本都会涉及，因此学好 Linux 刻不容缓。</p><p><img src="https://img-blog.csdnimg.cn/e887e6b1e1d74a6485dc582a7fa29578.png"></p><p><font color='oragen'><b>本文将列出我工作多年所学的 Linux 常用命令的汇总！超全面！超详细！包学包会！</b></font></p><h1 id="🏆-命令汇总"><a href="#🏆-命令汇总" class="headerlink" title="🏆 命令汇总"></a>🏆 命令汇总</h1><h2 id="🍇-文件管理"><a href="#🍇-文件管理" class="headerlink" title="🍇 文件管理"></a>🍇 文件管理</h2><h3 id="1️⃣-ls-命令-–-显示指定工作目录下的内容及属性信息"><a href="#1️⃣-ls-命令-–-显示指定工作目录下的内容及属性信息" class="headerlink" title="1️⃣ ls 命令 – 显示指定工作目录下的内容及属性信息"></a>1️⃣ ls 命令 – 显示指定工作目录下的内容及属性信息</h3><p>ls命令为英文单词 list 的缩写，正如英文单词 list 的意思，其功能是列出指定目录下的内容及其相关属性信息。</p><p>默认状态下，ls命令会列出当前目录的内容。而带上参数后，我们可以用ls做更多的事情。作为最基础同时又是使用频率很高的命令，我们很有必要搞清楚ls命令的用法，那么接下来一起看看吧！</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式: ls [选项] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示所有文件及目录 (包括以“.”开头的隐藏文件)</td></tr><tr><td>-l</td><td>使用长格式列出文件及目录信息</td></tr><tr><td>-r</td><td>将文件以相反次序显示(默认依英文字母次序)</td></tr><tr><td>-t</td><td>根据最后的修改时间排序</td></tr><tr><td>-A</td><td>同 -a ，但不列出 “.” (当前目录) 及 “..” (父目录)</td></tr><tr><td>-S</td><td>根据文件大小排序</td></tr><tr><td>-R</td><td>递归列出所有子目录</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>列出所有文件(包括隐藏文件)：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -a</span><br></pre></td></tr></table></figure><p>列出文件的详细信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -l</span><br></pre></td></tr></table></figure><p>列出根目录(&#x2F;)下的所有目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> /</span><br></pre></td></tr></table></figure><p>列出当前工作目录下所有名称是 “s” 开头的文件（不包含文件夹哦~） :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -ltr s*</span><br></pre></td></tr></table></figure><p>列出 &#x2F;root 目录下的所有目录及文件的详细信息 :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -lR /root</span><br></pre></td></tr></table></figure><p>列出当前工作目录下所有文件及目录并以文件的大小进行排序 :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -AS</span><br></pre></td></tr></table></figure><h3 id="2️⃣-cp-命令-–-复制文件或目录"><a href="#2️⃣-cp-命令-–-复制文件或目录" class="headerlink" title="2️⃣ cp 命令 – 复制文件或目录"></a>2️⃣ cp 命令 – 复制文件或目录</h3><p>cp命令可以理解为英文单词copy的缩写，其功能为复制文件或目录。</p><p>cp命令可以将多个文件复制到一个具体的文件名或一个已经存在的目录下，也可以同时复制多个文件到一个指定的目录中。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：cp [参数] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-f</td><td>若目标文件已存在，则会直接覆盖原文件</td></tr><tr><td>-i</td><td>若目标文件已存在，则会询问是否覆盖</td></tr><tr><td>-p</td><td>保留源文件或目录的所有属性</td></tr><tr><td>-r</td><td>递归复制文件和目录</td></tr><tr><td>-d</td><td>当复制符号连接时，把目标文件或目录也建立为符号连接，并指向与源文件或目录连接的原始文件或目录</td></tr><tr><td>-l</td><td>对源文件建立硬连接，而非复制文件</td></tr><tr><td>-s</td><td>对源文件建立符号连接，而非复制文件</td></tr><tr><td>-b</td><td>覆盖已存在的文件目标前将目标文件备份</td></tr><tr><td>-v</td><td>详细显示cp命令执行的操作过程</td></tr><tr><td>-a</td><td>等价于“dpr”选项</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>复制目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -R dir1 dir2/</span><br></pre></td></tr></table></figure><p>将文件test1改名为test2：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -f test1 test2</span><br></pre></td></tr></table></figure><p>复制多个文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r file1 file2 file3 <span class="built_in">dir</span></span><br></pre></td></tr></table></figure><p>交互式地将目录 &#x2F;home&#x2F;lucifer 中的所有.c文件复制到目录 dir 中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> -r /home/lucifer/*.c <span class="built_in">dir</span></span><br></pre></td></tr></table></figure><h3 id="3️⃣-mkdir-命令-–-创建目录"><a href="#3️⃣-mkdir-命令-–-创建目录" class="headerlink" title="3️⃣ mkdir 命令 – 创建目录"></a>3️⃣ mkdir 命令 – 创建目录</h3><p>mkdir命令是“make directories”的缩写，用来创建目录。</p><p><strong>📢 注意：</strong> 默认状态下，如果要创建的目录已经存在，则提示已存在，而不会继续创建目录。 所以在创建目录时，应保证新建的目录与它所在目录下的文件没有重名。 mkdir命令还可以同时创建多个目录，是不是很强大呢？</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式 : mkdir [参数] [目录]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-p</td><td>递归创建多级目录</td></tr><tr><td>-m</td><td>建立目录的同时设置目录的权限</td></tr><tr><td>-z</td><td>设置安全上下文</td></tr><tr><td>-v</td><td>显示目录的创建过程</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>在工作目录下，建立一个名为 dir 的子目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> <span class="built_in">dir</span></span><br></pre></td></tr></table></figure><p>在目录&#x2F;home&#x2F;lucifer下建立子目录dir，并且设置文件属主有读、写和执行权限，其他人无权访问：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -m 700 /home/lucifer/dir</span><br></pre></td></tr></table></figure><p>同时创建子目录dir1，dir2，dir3：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> dir1 dir2 dir3</span><br></pre></td></tr></table></figure><p>递归创建目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p lucifer/dir</span><br></pre></td></tr></table></figure><h3 id="4️⃣-mv-命令-–-移动或改名文件"><a href="#4️⃣-mv-命令-–-移动或改名文件" class="headerlink" title="4️⃣ mv 命令 – 移动或改名文件"></a>4️⃣ mv 命令 – 移动或改名文件</h3><p>mv命令是“move”单词的缩写，其功能大致和英文含义一样，可以移动文件或对其改名。</p><p>这是一个使用频率超高的文件管理命令，我们需要特别留意它与复制的区别：mv与cp的结果不同。mv命令好像文件“搬家”，文件名称发生改变，但个数并未增加。而cp命令是对文件进行复制操作，文件个数是有增加的。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：mv [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-i</td><td>若存在同名文件，则向用户询问是否覆盖</td></tr><tr><td>-f</td><td>覆盖已有文件时，不进行任何提示</td></tr><tr><td>-b</td><td>当文件存在时，覆盖前为其创建一个备份</td></tr><tr><td>-u</td><td>当源文件比目标文件新，或者目标文件不存在时，才执行移动此操作</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>将文件file_1重命名为file_2：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> file_1 file_2</span><br></pre></td></tr></table></figure><p>将文件file移动到目录dir中 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> file /dir</span><br></pre></td></tr></table></figure><p>将目录dir1移动目录dir2中（前提是目录dir2已存在，若不存在则改名)：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /dir1 /dir2</span><br></pre></td></tr></table></figure><p>将目录dir1下的文件移动到当前目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /dir1/* .</span><br></pre></td></tr></table></figure><h3 id="5️⃣-pwd-命令-–-显示当前路径"><a href="#5️⃣-pwd-命令-–-显示当前路径" class="headerlink" title="5️⃣ pwd 命令 – 显示当前路径"></a>5️⃣ pwd 命令 – 显示当前路径</h3><p>pwd命令是“print working directory”中每个单词的首字母缩写，其功能正如所示单词一样，为打印工作目录，即显示当前工作目录的绝对路径。</p><p>在实际工作中，我们经常会在不同目录之间进行切换，为了防止“迷路”，我们可以使用pwd命令快速查看当前我们所在的目录路径。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式: pwd [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-L</td><td>显示逻辑路径</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>查看当前工作目录路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><h2 id="🍉-文档编辑"><a href="#🍉-文档编辑" class="headerlink" title="🍉 文档编辑"></a>🍉 文档编辑</h2><h3 id="1️⃣-cat-命令-–-在终端设备上显示文件内容"><a href="#1️⃣-cat-命令-–-在终端设备上显示文件内容" class="headerlink" title="1️⃣ cat 命令 – 在终端设备上显示文件内容"></a>1️⃣ cat 命令 – 在终端设备上显示文件内容</h3><p>cat这个命令也很好记，因为cat在英语中是“猫”的意思，小猫咪是不是给您一种娇小、可爱的感觉呢？</p><p><strong>📢 注意：</strong> 当文件内容较大时，文本内容会在屏幕上快速闪动（滚屏），用户往往看不清所显示的具体内容。</p><p><strong>因此对于较长文件内容可以：</strong></p><ul><li>按Ctrl+S键，停止滚屏；</li><li>按Ctrl+Q键可以恢复滚屏；</li><li>按Ctrl+C（中断）键则可以终止该命令的执行。</li></ul><p>或者对于大文件，干脆用 more 命令吧！</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：cat [参数] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-n</td><td>显示行数（空行也编号）</td></tr><tr><td>-s</td><td>显示行数（多个空行算一个编号）</td></tr><tr><td>-b</td><td>显示行数（空行不编号）</td></tr><tr><td>-E</td><td>每行结束处显示$符号</td></tr><tr><td>-T</td><td>将TAB字符显示为 ^I符号</td></tr><tr><td>-v</td><td>使用 ^ 和 M- 引用，除了 LFD 和 TAB 之外</td></tr><tr><td>-e</td><td>等价于”-vE”组合</td></tr><tr><td>-t</td><td>等价于”-vT”组合</td></tr><tr><td>-A</td><td>等价于 -vET组合</td></tr><tr><td>–help</td><td>显示帮助信息</td></tr><tr><td>–version</td><td>显示版本信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>查看文件的内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> lucifer.log</span><br></pre></td></tr></table></figure><p>查看文件的内容，并显示行数编号：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> -n lucifer.log</span><br></pre></td></tr></table></figure><p>查看文件的内容，并添加行数编号后输出到另外一个文件中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> -n lucifer.log &gt; lucifer.txt</span><br></pre></td></tr></table></figure><p>清空文件的内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /dev/null &gt; /root/lucifer.txt</span><br></pre></td></tr></table></figure><p>持续写入文件内容，碰到EOF符后结束并保存：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; lucifer.txt &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">Hello, World </span></span><br><span class="line"><span class="string">Linux!</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>将软盘设备制作成镜像文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /dev/fb0 &gt; fdisk.iso</span><br></pre></td></tr></table></figure><h3 id="2️⃣-echo-命令-–-输出字符串或提取Shell变量的值"><a href="#2️⃣-echo-命令-–-输出字符串或提取Shell变量的值" class="headerlink" title="2️⃣ echo 命令 – 输出字符串或提取Shell变量的值"></a>2️⃣ echo 命令 – 输出字符串或提取Shell变量的值</h3><p>echo命令用于在终端设备上输出字符串或变量提取后的值，这是在Linux系统中最常用的几个命令之一，但操作却非常简单。</p><p>人们一般使用在变量前加上$符号的方式提取出变量的值，例如：$PATH，然后再用echo命令予以输出。或者直接使用echo命令输出一段字符串到屏幕上，起到给用户提示的作用。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：echo [参数] [字符串]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-n</td><td>不输出结尾的换行符</td></tr><tr><td>-e “\a”</td><td>发出警告音</td></tr><tr><td>-e “\b”</td><td>删除前面的一个字符</td></tr><tr><td>-e “\c”</td><td>结尾不加换行符</td></tr><tr><td>-e “\f”</td><td>换行，光标扔停留在原来的坐标位置</td></tr><tr><td>-e “\n”</td><td>换行，光标移至行首</td></tr><tr><td>-e “\r”</td><td>光标移至行首，但不换行</td></tr><tr><td>-E</td><td>禁止反斜杠转移，与-e参数功能相反</td></tr><tr><td>—version</td><td>查看版本信息</td></tr><tr><td>–help</td><td>查看帮助信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>输出一段字符串：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello Lucifer&quot;</span></span><br></pre></td></tr></table></figure><p>输出变量提取后的值：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>对内容进行转义，不让$符号的提取变量值功能生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> \<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>结合输出重定向符，将字符串信息导入文件中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span> &gt; lucifer</span><br></pre></td></tr></table></figure><p>使用反引号符执行命令，并输出其结果到终端：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">date</span>`</span><br></pre></td></tr></table></figure><p>输出带有换行符的内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;a\nb\nc&quot;</span></span><br></pre></td></tr></table></figure><p>输出信息中删除某个字符，注意看数字3消失了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;123\b456&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3️⃣-rm-命令-–-移除文件或目录"><a href="#3️⃣-rm-命令-–-移除文件或目录" class="headerlink" title="3️⃣ rm 命令 – 移除文件或目录"></a>3️⃣ rm 命令 – 移除文件或目录</h3><p>rm是常用的命令，该命令的功能为删除一个目录中的一个或多个文件或目录，它也可以将某个目录及其下的所有文件及子目录均删除。对于链接文件，只是删除了链接，原有文件均保持不变。 </p><p><strong>📢 <font color='red'>注意：</font></strong> rm也是一个危险的命令，使用的时候要特别当心，尤其对于新手，否则整个系统就会毁在这个命令（比如在&#x2F;（根目录）下执行rm * -rf）。</p><p>所以，我们在执行rm之前最好先确认一下在哪个目录，到底要删除什么东西，操作时保持高度清醒的头脑。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：rm [参数] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-f</td><td>忽略不存在的文件，不会出现警告信息</td></tr><tr><td>-i</td><td>删除前会询问用户是否操作</td></tr><tr><td>-r&#x2F;R</td><td>递归删除</td></tr><tr><td>-v</td><td>显示指令的详细执行过程</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>删除前逐一询问确认：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -i test.txt.bz2</span><br></pre></td></tr></table></figure><p>直接删除，不会有任何提示：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -f test.txt.bz2  </span><br></pre></td></tr></table></figure><p>递归删除目录及目录下所有文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /data/log</span><br><span class="line"><span class="built_in">rm</span> -rf /data/log</span><br></pre></td></tr></table></figure><p>删除当前目录下所有文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf *</span><br></pre></td></tr></table></figure><p>清空系统中所有的文件（谨慎）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /*</span><br></pre></td></tr></table></figure><h3 id="4️⃣-tail-命令-–-查看文件尾部内容"><a href="#4️⃣-tail-命令-–-查看文件尾部内容" class="headerlink" title="4️⃣ tail 命令 – 查看文件尾部内容"></a>4️⃣ tail 命令 – 查看文件尾部内容</h3><p>tail用于显示文件尾部的内容，默认在屏幕上显示指定文件的末尾10行。如果给定的文件不止一个，则在显示的每个文件前面加一个文件名标题。如果没有指定文件或者文件名为“-”，则读取标准输入。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：tail [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>–retry</td><td>即是在tail命令启动时，文件不可访问或者文件稍后变得不可访问，都始终尝试打开文件。使用此选项时需要与选项“——follow&#x3D;name”连用</td></tr><tr><td>-c<N>或—bytes&#x3D;<N></td><td>输出文件尾部的N（N为整数）个字节内容</td></tr><tr><td>-f&lt;name&#x2F;descriptor&gt;</td><td>–follow<nameldescript>：显示文件最新追加的内容</td></tr><tr><td>-F</td><td>与选项“-follow&#x3D;name”和“–retry”连用时功能相同</td></tr><tr><td>-n<N>或—line&#x3D;<N></td><td>输出文件的尾部N（N位数字）行内容</td></tr><tr><td>–pid&#x3D;&lt;进程号&gt;</td><td>与“-f”选项连用，当指定的进程号的进程终止后，自动退出tail命令</td></tr><tr><td>–help</td><td>显示指令的帮助信息</td></tr><tr><td>–version</td><td>显示指令的版本信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示文件file的最后10行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> file</span><br></pre></td></tr></table></figure><p>显示文件file的内容，从第20行至文件末尾：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> +20 file </span><br></pre></td></tr></table></figure><p>显示文件file的最后10个字符：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -c 10 file </span><br></pre></td></tr></table></figure><p>一直变化的文件总是显示后10行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f 10 file</span><br></pre></td></tr></table></figure><p>显示帮助信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">tail</span> --<span class="built_in">help</span></span><br></pre></td></tr></table></figure><h3 id="5️⃣-rmdir-命令-–-删除空目录"><a href="#5️⃣-rmdir-命令-–-删除空目录" class="headerlink" title="5️⃣ rmdir 命令 – 删除空目录"></a>5️⃣ rmdir 命令 – 删除空目录</h3><p>rmdir命令作用是删除空的目录，英文全称：“remove directory”。</p><p>注意：rmdir命令只能删除空目录。当要删除非空目录时，就要使用带有“-R”选项的rm命令。</p><p>rmdir命令的“-p”参数可以递归删除指定的多级目录，但是要求每个目录也必须是空目录。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式 :  rmdir [参数] [目录名称]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-p</td><td>用递归的方式删除指定的目录路径中的所有父级目录，非空则报错</td></tr><tr><td>–ignore-fail-on-non-empty</td><td>忽略由于删除非空目录时导致命令出错而产生的错误信息</td></tr><tr><td>-v</td><td>显示命令的详细执行过程</td></tr><tr><td>–help</td><td>显示命令的帮助信息</td></tr><tr><td>–version</td><td>显示命令的版本信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>删除空目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> <span class="built_in">dir</span></span><br></pre></td></tr></table></figure><p>递归删除指定的目录树：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> -p <span class="built_in">dir</span>/dir_1/dir_2</span><br></pre></td></tr></table></figure><p>显示指令详细执行过程：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> -v <span class="built_in">dir</span></span><br></pre></td></tr></table></figure><p>显示命令的版本信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> --version</span><br></pre></td></tr></table></figure><h2 id="🍋-系统管理"><a href="#🍋-系统管理" class="headerlink" title="🍋 系统管理"></a>🍋 系统管理</h2><h3 id="1️⃣-rpm-命令-–-RPM软件包管理器"><a href="#1️⃣-rpm-命令-–-RPM软件包管理器" class="headerlink" title="1️⃣ rpm 命令 – RPM软件包管理器"></a>1️⃣ rpm 命令 – RPM软件包管理器</h3><p>rpm命令是Red-Hat Package Manager（RPM软件包管理器）的缩写， 该命令用于管理Linux 下软件包的软件。在 Linux 操作系统下，几乎所有的软件均可以通过RPM 进行安装、卸载及管理等操作。</p><p>概括的说，rpm命令包含了五种基本功能：安装、卸载、升级、查询和验证。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：rpm [参数] [软件包]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>查询所有的软件包</td></tr><tr><td>-b或-t</td><td>设置包装套件的完成阶段，并指定套件档的文件名称</td></tr><tr><td>-c</td><td>只列出组态配置文件，本参数需配合”-l”参数使用</td></tr><tr><td>-d</td><td>只列出文本文件，本参数需配合”-l”参数使用</td></tr><tr><td>-e或–erase</td><td>卸载软件包</td></tr><tr><td>-f</td><td>查询文件或命令属于哪个软件包</td></tr><tr><td>-h或–hash</td><td>安装软件包时列出标记</td></tr><tr><td>-i</td><td>显示软件包的相关信息</td></tr><tr><td>–install</td><td>安装软件包</td></tr><tr><td>-l</td><td>显示软件包的文件列表</td></tr><tr><td>-p</td><td>查询指定的rpm软件包</td></tr><tr><td>-q</td><td>查询软件包</td></tr><tr><td>-R</td><td>显示软件包的依赖关系</td></tr><tr><td>-s</td><td>显示文件状态，本参数需配合”-l”参数使用</td></tr><tr><td>-U或–upgrade</td><td>升级软件包</td></tr><tr><td>-v</td><td>显示命令执行过程</td></tr><tr><td>-vv</td><td>详细显示指令执行过程</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>直接安装软件包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh packge.rpm </span><br></pre></td></tr></table></figure><p>忽略报错，强制安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm --force -ivh package.rpm</span><br></pre></td></tr></table></figure><p>列出所有安装过的包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa</span><br></pre></td></tr></table></figure><p>查询rpm包中的文件安装的位置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ql <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p>卸载rpm包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e package.rpm </span><br></pre></td></tr></table></figure><p>升级软件包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -U file.rpm</span><br></pre></td></tr></table></figure><h3 id="2️⃣-find-命令-–-查找和搜索文件"><a href="#2️⃣-find-命令-–-查找和搜索文件" class="headerlink" title="2️⃣ find 命令 – 查找和搜索文件"></a>2️⃣ find 命令 – 查找和搜索文件</h3><p>find命令可以根据给定的路径和表达式查找的文件或目录。find参数选项很多，并且支持正则，功能强大。和管道结合使用可以实现复杂的功能，是系统管理者和普通用户必须掌握的命令。</p><p>find如不加任何参数，表示查找当前路径下的所有文件和目录，如果服务器负载比较高尽量不要在高峰期使用find命令，find命令模糊搜索还是比较消耗系统资源的。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：find [参数] [路径] [查找和搜索范围]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-name</td><td>按名称查找</td></tr><tr><td>-size</td><td>按大小查找</td></tr><tr><td>-user</td><td>按属性查找</td></tr><tr><td>-type</td><td>按类型查找</td></tr><tr><td>-iname</td><td>忽略大小写</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>使用-name参数查看&#x2F;etc目录下面所有的.conf结尾的配置文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /etc -name <span class="string">&quot;*.conf</span></span><br></pre></td></tr></table></figure><p>使用-size参数查看&#x2F;etc目录下面大于1M的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /etc -size +1M</span><br></pre></td></tr></table></figure><p>查找当前用户主目录下的所有文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find <span class="variable">$HOME</span> -<span class="built_in">print</span></span><br></pre></td></tr></table></figure><p>列出当前目录及子目录下所有文件和文件夹：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find .</span><br></pre></td></tr></table></figure><p>在&#x2F;home目录下查找以.txt结尾的文件名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /home -name <span class="string">&quot;*.txt&quot;</span></span><br></pre></td></tr></table></figure><p>在&#x2F;var&#x2F;log目录下忽略大小写查找以.log结尾的文件名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /var/log -iname <span class="string">&quot;*.log&quot;</span></span><br></pre></td></tr></table></figure><p>搜索超过七天内被访问过的所有文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f -atime +7</span><br></pre></td></tr></table></figure><p>搜索访问时间超过10分钟的所有文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f -amin +10</span><br></pre></td></tr></table></figure><p>找出&#x2F;home下不是以.txt结尾的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find /home ! -name <span class="string">&quot;*.txt&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3️⃣-startx-命令-–-初始化X-windows"><a href="#3️⃣-startx-命令-–-初始化X-windows" class="headerlink" title="3️⃣ startx 命令 – 初始化X-windows"></a>3️⃣ startx 命令 – 初始化X-windows</h3><p>startx命令用来启动X-Window，它负责调用X-Window系统的初始化程序xinit。以完成 X-Window运行所必要的初始化工作，并启动X-Window系统。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：startx [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-d</td><td>指定在启动过程中传递给客户机的X服务器的显示名称</td></tr><tr><td>-m</td><td>当未找到启动脚本时，启动窗口管理器</td></tr><tr><td>-r</td><td>当未找到启动脚本时，装入资源文件</td></tr><tr><td>-w</td><td>强制启动</td></tr><tr><td>-x</td><td>使用startup脚本启动X-windows会话</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>已默认方式启动X-windows系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startx</span><br></pre></td></tr></table></figure><p>以16位颜色深度启动X-windows系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startx --depth 16</span><br></pre></td></tr></table></figure><p>强制启动 X-windows系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">startx -w</span><br></pre></td></tr></table></figure><h3 id="4️⃣-uname-命令-–-显示系统信息"><a href="#4️⃣-uname-命令-–-显示系统信息" class="headerlink" title="4️⃣ uname 命令 – 显示系统信息"></a>4️⃣ uname 命令 – 显示系统信息</h3><p>uname命令的英文全称即“Unix name”。</p><p>用于显示系统相关信息，比如主机名、内核版本号、硬件架构等。</p><p>如果未指定任何选项，其效果相当于执行”uname -s”命令，即显示系统内核的名字。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：uname [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示系统所有相关信息</td></tr><tr><td>-m</td><td>显示计算机硬件架构</td></tr><tr><td>-n</td><td>显示主机名称</td></tr><tr><td>-r</td><td>显示内核发行版本号</td></tr><tr><td>-s</td><td>显示内核名称</td></tr><tr><td>-v</td><td>显示内核版本</td></tr><tr><td>-p</td><td>显示主机处理器类型</td></tr><tr><td>-o</td><td>显示操作系统名称</td></tr><tr><td>-i</td><td>显示硬件平台</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示系统主机名、内核版本号、CPU类型等信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -a</span><br></pre></td></tr></table></figure><p>仅显示系统主机名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -n</span><br></pre></td></tr></table></figure><p>显示当前系统的内核版本 :</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -r</span><br></pre></td></tr></table></figure><p>显示当前系统的硬件架构：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">uname</span> -i</span><br></pre></td></tr></table></figure><h3 id="5️⃣-vmstat-命令-–-显示虚拟内存状态"><a href="#5️⃣-vmstat-命令-–-显示虚拟内存状态" class="headerlink" title="5️⃣ vmstat 命令 – 显示虚拟内存状态"></a>5️⃣ vmstat 命令 – 显示虚拟内存状态</h3><p>vmstat命令的含义为显示虚拟内存状态（“Virtual Memory Statistics”），但是它可以报告关于进程、内存、I&#x2F;O等系统整体运行状态。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：vmstat [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示活动内页</td></tr><tr><td>-f</td><td>显示启动后创建的进程总数</td></tr><tr><td>-m</td><td>显示slab信息</td></tr><tr><td>-n</td><td>头信息仅显示一次</td></tr><tr><td>-s</td><td>以表格方式显示事件计数器和内存状态</td></tr><tr><td>-d</td><td>报告磁盘状态</td></tr><tr><td>-p</td><td>显示指定的硬盘分区状态</td></tr><tr><td>-S</td><td>输出信息的单位</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示活动内页：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -a</span><br></pre></td></tr></table></figure><p>显示启动后创建的进程总数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -f</span><br></pre></td></tr></table></figure><p>显示slab信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -m</span><br></pre></td></tr></table></figure><p>头信息仅显示一次：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -n</span><br></pre></td></tr></table></figure><p>以表格方式显示事件计数器和内存状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -s</span><br></pre></td></tr></table></figure><p>显示指定的硬盘分区状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat -p /dev/sda1</span><br></pre></td></tr></table></figure><p>指定状态信息刷新的时间间隔为1秒：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat 1</span><br></pre></td></tr></table></figure><h2 id="🍑-磁盘管理"><a href="#🍑-磁盘管理" class="headerlink" title="🍑 磁盘管理"></a>🍑 磁盘管理</h2><h3 id="1️⃣-df-命令-–-显示磁盘空间使用情况"><a href="#1️⃣-df-命令-–-显示磁盘空间使用情况" class="headerlink" title="1️⃣ df 命令 – 显示磁盘空间使用情况"></a>1️⃣ df 命令 – 显示磁盘空间使用情况</h3><p>df命令的英文全称即“Disk Free”，顾名思义功能是用于显示系统上可使用的磁盘空间。默认显示单位为KB，建议使用“df -h”的参数组合，根据磁盘容量自动变换合适的单位，更利于阅读。</p><p>日常普遍用该命令可以查看磁盘被占用了多少空间、还剩多少空间等信息。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式： df [参数] [指定文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示所有系统文件</td></tr><tr><td>-B</td><td>&lt;块大小&gt; 指定显示时的块大小</td></tr><tr><td>-h</td><td>以容易阅读的方式显示</td></tr><tr><td>-H</td><td>以1000字节为换算单位来显示</td></tr><tr><td>-i</td><td>显示索引字节信息</td></tr><tr><td>-k</td><td>指定块大小为1KB</td></tr><tr><td>-l</td><td>只显示本地文件系统</td></tr><tr><td>-t</td><td>&lt;文件系统类型&gt; 只显示指定类型的文件系统</td></tr><tr><td>-T</td><td>输出时显示文件系统类型</td></tr><tr><td>– -sync</td><td>在取得磁盘使用信息前，先执行sync命令</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示磁盘分区使用情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span></span><br></pre></td></tr></table></figure><p>以容易阅读的方式显示磁盘分区使用情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure><p>显示指定文件所在分区的磁盘使用情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> /etc/dhcp</span><br></pre></td></tr></table></figure><p>显示文件类型为ext4的磁盘使用情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -t ext4</span><br></pre></td></tr></table></figure><h3 id="2️⃣-fdisk-命令-–-磁盘分区"><a href="#2️⃣-fdisk-命令-–-磁盘分区" class="headerlink" title="2️⃣ fdisk 命令 – 磁盘分区"></a>2️⃣ fdisk 命令 – 磁盘分区</h3><p>fdisk命令的英文全称是“Partition table manipulator for Linux”，即作为磁盘的分区工具。进行硬盘分区从实质上说就是对硬盘的一种格式化， 用一个形象的比喻，分区就好比在一张白纸上画一个大方框，而格式化好比在方框里打上格子。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：fdisk [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-b</td><td>指定每个分区的大小</td></tr><tr><td>-l</td><td>列出指定的外围设备的分区表状况</td></tr><tr><td>-s</td><td>将指定的分区大小输出到标准输出上，单位为区块</td></tr><tr><td>-u</td><td>搭配”-l”参数列表，会用分区数目取代柱面数目，来表示每个分区的起始地址</td></tr><tr><td>-v</td><td>显示版本信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>查看所有分区情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure><p>选择分区磁盘：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/sdb</span><br></pre></td></tr></table></figure><p>在当前磁盘上建立扩展分区：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /ext</span><br></pre></td></tr></table></figure><p>不检查磁盘表面加快分区操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /actok</span><br></pre></td></tr></table></figure><p>重建主引导记录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /cmbr</span><br></pre></td></tr></table></figure><h3 id="3️⃣-lsblk命令-–-查看系统的磁盘"><a href="#3️⃣-lsblk命令-–-查看系统的磁盘" class="headerlink" title="3️⃣ lsblk命令 – 查看系统的磁盘"></a>3️⃣ lsblk命令 – 查看系统的磁盘</h3><p>lsblk命令的英文是“list block”，即用于列出所有可用块设备的信息，而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。</p><p>lsblk命令包含在util-linux-ng包中，现在该包改名为util-linux。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：lsblk [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示所有设备</td></tr><tr><td>-b</td><td>以bytes方式显示设备大小</td></tr><tr><td>-d</td><td>不显示 slaves 或 holders</td></tr><tr><td>-D</td><td>print discard capabilities</td></tr><tr><td>-e</td><td>排除设备</td></tr><tr><td>-f</td><td>显示文件系统信息</td></tr><tr><td>-h</td><td>显示帮助信息</td></tr><tr><td>-i</td><td>use ascii characters only</td></tr><tr><td>-m</td><td>显示权限信息</td></tr><tr><td>-l</td><td>使用列表格式显示</td></tr><tr><td>-n</td><td>不显示标题</td></tr><tr><td>-o</td><td>输出列</td></tr><tr><td>-P</td><td>使用key&#x3D;”value”格式显示</td></tr><tr><td>-r</td><td>使用原始格式显示</td></tr><tr><td>-t</td><td>显示拓扑结构信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>lsblk命令默认情况下将以树状列出所有块设备：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure><p>默认选项不会列出所有空设备：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk -a</span><br></pre></td></tr></table></figure><p>也可以用于列出一个特定设备的拥有关系，同时也可以列出组和模式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk -m</span><br></pre></td></tr></table></figure><p>要获取SCSI设备的列表，你只能使用-S选项，该选项是用来以颠倒的顺序打印依赖的：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk -S</span><br></pre></td></tr></table></figure><p>例如，你也许想要以列表格式列出设备，而不是默认的树状格式。可以将两个不同的选项组合，以获得期望的输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk -<span class="built_in">nl</span></span><br></pre></td></tr></table></figure><h3 id="4️⃣-hdparm命令-–-显示与设定硬盘参数"><a href="#4️⃣-hdparm命令-–-显示与设定硬盘参数" class="headerlink" title="4️⃣ hdparm命令 – 显示与设定硬盘参数"></a>4️⃣ hdparm命令 – 显示与设定硬盘参数</h3><p>hdparm命令用于检测，显示与设定IDE或SCSI硬盘的参数。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：hdparm [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>设定读取文件时，预先存入块区的分区数</td></tr><tr><td>-f</td><td>将内存缓冲区的数据写入硬盘，并清空缓冲区</td></tr><tr><td>-g</td><td>显示硬盘的磁轨，磁头，磁区等参数</td></tr><tr><td>-I</td><td>直接读取硬盘所提供的硬件规格信息</td></tr><tr><td>-X</td><td>设定硬盘的传输模式</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示硬盘的相关设置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm /dev/sda</span><br></pre></td></tr></table></figure><p>显示硬盘的柱面、磁头、扇区数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -g /dev/sda</span><br></pre></td></tr></table></figure><p>评估硬盘的读取效率：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -t /dev/sda</span><br></pre></td></tr></table></figure><p>直接读取硬盘所提供的硬件规格信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -X /dev/sda</span><br></pre></td></tr></table></figure><p>使IDE硬盘进入睡眠模式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdparm -Y /dev/sda</span><br></pre></td></tr></table></figure><h3 id="5️⃣-vgextend命令-–-扩展卷组"><a href="#5️⃣-vgextend命令-–-扩展卷组" class="headerlink" title="5️⃣ vgextend命令 – 扩展卷组"></a>5️⃣ vgextend命令 – 扩展卷组</h3><p>vgextend命令用于动态扩展LVM卷组，它通过向卷组中添加物理卷来增加卷组的容量。LVM卷组中的物理卷可以在使用vgcreate命令创建卷组时添加，也可以使用vgextend命令动态的添加。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：vgextend [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-d</td><td>调试模式</td></tr><tr><td>-t</td><td>仅测试</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>将物理卷&#x2F;dev&#x2F;sdb1加入卷组vglinuxprobe:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vgextend vglinuxprobe /dev/sdb1</span><br></pre></td></tr></table></figure><h2 id="🍓-文件传输"><a href="#🍓-文件传输" class="headerlink" title="🍓 文件传输"></a>🍓 文件传输</h2><h3 id="1️⃣-tftp-命令-–-上传及下载文件"><a href="#1️⃣-tftp-命令-–-上传及下载文件" class="headerlink" title="1️⃣ tftp 命令 – 上传及下载文件"></a>1️⃣ tftp 命令 – 上传及下载文件</h3><p>tftp命令用于传输文件。ftp让用户得以下载存放于远端主机的文件，也能将文件上传到远端主机放置。</p><p>tftp是简单的文字模式ftp程序，它所使用的指令和ftp类似。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：tftp [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>connect</td><td>连接到远程tftp服务器</td></tr><tr><td>mode</td><td>文件传输模式</td></tr><tr><td>put</td><td>上传文件</td></tr><tr><td>get</td><td>下载文件</td></tr><tr><td>quit</td><td>退出</td></tr><tr><td>verbose</td><td>显示详细的处理信息</td></tr><tr><td>trace</td><td>显示包路径</td></tr><tr><td>status</td><td>显示当前状态信息</td></tr><tr><td>binary</td><td>二进制传输模式</td></tr><tr><td>ascii ascii</td><td>传送模式</td></tr><tr><td>rexmt</td><td>设置包传输的超时时间</td></tr><tr><td>timeout</td><td>设置重传的超时时间</td></tr><tr><td>help</td><td>帮助信息</td></tr><tr><td>?</td><td>帮助信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>连接远程服务器”10.211.55.100″：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tftp 10.211.55.100</span><br></pre></td></tr></table></figure><p>远程下载file文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tftp&gt; get file</span><br></pre></td></tr></table></figure><p>退出tftp：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tftp&gt; quit </span><br></pre></td></tr></table></figure><h3 id="2️⃣-curl-命令-–-文件传输工具"><a href="#2️⃣-curl-命令-–-文件传输工具" class="headerlink" title="2️⃣ curl 命令 – 文件传输工具"></a>2️⃣ curl 命令 – 文件传输工具</h3><p>curl命令是一个利用URL规则在shell终端命令行下工作的文件传输工具；它支持文件的上传和下载，所以是综合传输工具，但按传统，习惯称curl为下载工具。</p><p>作为一款强力工具，curl支持包括HTTP、HTTPS、ftp等众多协议，还支持POST、cookies、认证、从指定偏移处下载部分文件、用户代理字符串、限速、文件大小、进度条等特征；做网页处理流程和数据检索自动化。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：curl [参数] [网址]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-O</td><td>把输出写到该文件中，保留远程文件的文件名</td></tr><tr><td>-u</td><td>通过服务端配置的用户名和密码授权访问</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>将下载的数据写入到文件，必须使用文件的绝对地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://www.baidu.com /root/lucifer.txt --silent -O</span><br></pre></td></tr></table></figure><p>访问需要授权的页面时，可通过-u选项提供用户名和密码进行授权：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -u root https://www.baidu.com/</span><br></pre></td></tr></table></figure><h3 id="3️⃣-fsck命令-–-检查并修复Linux文件系统"><a href="#3️⃣-fsck命令-–-检查并修复Linux文件系统" class="headerlink" title="3️⃣ fsck命令 – 检查并修复Linux文件系统"></a>3️⃣ fsck命令 – 检查并修复Linux文件系统</h3><p>fsck命令的英文全称是“filesystem check”，即检查文件系统的意思，常用于检查并修复Linux文件系统的一些错误信息，操作文件系统需要先备份重要数据，以防丢失。</p><p>Linux fsck命令用于检查并修复Linux文件系统，可以同时检查一个或多个 Linux 文件系统；若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：fsck [参数] [文件系统]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>自动修复文件系统，不询问任何问题</td></tr><tr><td>-A</td><td>依照&#x2F;etc&#x2F;fstab配置文件的内容，检查文件内所列的全部文件系统</td></tr><tr><td>-N</td><td>不执行指令，仅列出实际执行会进行的动作</td></tr><tr><td>-P</td><td>当搭配”-A”参数使用时，则会同时检查所有的文件系统</td></tr><tr><td>-r</td><td>采用互动模式，在执行修复时询问问题，让用户得以确认并决定处理方式</td></tr><tr><td>-R</td><td>当搭配”-A”参数使用时，则会略过&#x2F;目录的文件系统不予检查</td></tr><tr><td>-t</td><td>指定要检查的文件系统类型</td></tr><tr><td>-T</td><td>执行fsck指令时，不显示标题信息</td></tr><tr><td>-V</td><td>显示指令执行过程</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>修复坏的分区文件系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsck -t ext3 -r /usr/local</span><br></pre></td></tr></table></figure><p>显示fsck系统安装的版本号：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fsck --version</span><br></pre></td></tr></table></figure><h3 id="4️⃣-ftpwho命令-–-显示ftp会话信息"><a href="#4️⃣-ftpwho命令-–-显示ftp会话信息" class="headerlink" title="4️⃣ ftpwho命令 – 显示ftp会话信息"></a>4️⃣ ftpwho命令 – 显示ftp会话信息</h3><p>ftpwho命令用于显示当前所有以FTP登入的用户会话信息。</p><p>执行该命令可得知当前用FTP登入系统的用户有哪些人，以及他们正在进行的操作。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：ftpwho [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-h</td><td>显示帮助信息</td></tr><tr><td>-v</td><td>详细模式，输出更多信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>查询当前正在登录FTP 服务器的用户：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftpwho</span><br></pre></td></tr></table></figure><p>在详细模式下，查询当前正在登录FTP 服务器的用户：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftpwho -v</span><br></pre></td></tr></table></figure><p>显示帮助信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftpwho -h</span><br></pre></td></tr></table></figure><h3 id="5️⃣-lprm命令-–-删除打印队列中的打印任务"><a href="#5️⃣-lprm命令-–-删除打印队列中的打印任务" class="headerlink" title="5️⃣ lprm命令 – 删除打印队列中的打印任务"></a>5️⃣ lprm命令 – 删除打印队列中的打印任务</h3><p>lprm命令的英文全称是“Remove jobs from the print queue”，意为用于删除打印队列中的打印任务。尚未完成的打印机工作会被放在打印机贮列之中，这个命令可用来将未送到打印机的工作取消。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：lprm [参数] [任务编号]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-E</td><td>与打印服务器连接时强制使用加密</td></tr><tr><td>-P</td><td>指定接受打印任务的目标打印机</td></tr><tr><td>-U</td><td>指定可选的用户名</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>将打印机hpprint中的第102号任务移除：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lprm -Phpprint 102</span><br></pre></td></tr></table></figure><p>将第101号任务由预设打印机中移除：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lprm 101</span><br></pre></td></tr></table></figure><h2 id="🌽-网络通讯"><a href="#🌽-网络通讯" class="headerlink" title="🌽 网络通讯"></a>🌽 网络通讯</h2><h3 id="1️⃣-ssh-命令-–-安全连接客户端"><a href="#1️⃣-ssh-命令-–-安全连接客户端" class="headerlink" title="1️⃣ ssh 命令 – 安全连接客户端"></a>1️⃣ ssh 命令 – 安全连接客户端</h3><p>ssh命令是openssh套件中的客户端连接工具，可以给予ssh加密协议实现安全的远程登录服务器，实现对服务器的远程管理。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式: ssh [参数] [远程主机]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-1</td><td>强制使用ssh协议版本1</td></tr><tr><td>-2</td><td>强制使用ssh协议版本2</td></tr><tr><td>-4</td><td>强制使用IPv4地址</td></tr><tr><td>-6</td><td>强制使用IPv6地址</td></tr><tr><td>-A</td><td>开启认证代理连接转发功能</td></tr><tr><td>-a</td><td>关闭认证代理连接转发功能</td></tr><tr><td>-b&lt;IP地址&gt;</td><td>使用本机指定的地址作为对位连接的源IP地址</td></tr><tr><td>-C</td><td>请求压缩所有数据</td></tr><tr><td>-F&lt;配置文件&gt;</td><td>指定ssh指令的配置文件，默认的配置文件为“&#x2F;etc&#x2F;ssh&#x2F;ssh_config”</td></tr><tr><td>-f</td><td>后台执行ssh指令</td></tr><tr><td>-g</td><td>允许远程主机连接本机的转发端口</td></tr><tr><td>-i&lt;身份文件&gt;</td><td>指定身份文件（即私钥文件）</td></tr><tr><td>-l&lt;登录名&gt;</td><td>指定连接远程服务器的登录用户名</td></tr><tr><td>-N</td><td>不执行远程指令</td></tr><tr><td>-o&lt;选项&gt;</td><td>指定配置选项</td></tr><tr><td>-p&lt;端口&gt;</td><td>指定远程服务器上的端口</td></tr><tr><td>-q</td><td>静默模式，所有的警告和诊断信息被禁止输出</td></tr><tr><td>-X</td><td>开启X11转发功能</td></tr><tr><td>-x</td><td>关闭X11转发功能</td></tr><tr><td>-y</td><td>开启信任X11转发功能</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>登录远程服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh 10.211.55.100</span><br></pre></td></tr></table></figure><p>用test用户连接远程服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -l <span class="built_in">test</span> 10.211.55.100</span><br></pre></td></tr></table></figure><p>查看分区列表：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh 10.211.55.100 /sbin/fdisk -l</span><br></pre></td></tr></table></figure><p>强制使用ssh协议版本1：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -1</span><br></pre></td></tr></table></figure><p>开启认证代理连接转发功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -A</span><br></pre></td></tr></table></figure><h3 id="2️⃣-netstat-命令-–-显示网络状态"><a href="#2️⃣-netstat-命令-–-显示网络状态" class="headerlink" title="2️⃣ netstat 命令 – 显示网络状态"></a>2️⃣ netstat 命令 – 显示网络状态</h3><p>netstat 命令用于显示各种网络相关信息，如网络连接，路由表，接口状态 (Interface Statistics)，masquerade 连接，多播成员 (Multicast Memberships) 等等。</p><p>从整体上看，netstat的输出结果可以分为两个部分：一个是Active Internet connections，称为有源TCP连接，其中”Recv-Q”和”Send-Q”指%0A的是接收队列和发送队列。这些数字一般都应该是0。如果不是则表示软件包正在队列中堆积。这种情况只能在非常少的情况见到；另一个是Active UNIX domain sockets，称为有源Unix域套接口(和网络套接字一样，但是只能用于本机通信，性能可以提高一倍)。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：netstat [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>显示所有连线中的Socket</td></tr><tr><td>-p</td><td>显示正在使用Socket的程序识别码和程序名称</td></tr><tr><td>-u</td><td>显示UDP传输协议的连线状况</td></tr><tr><td>-i</td><td>显示网络界面信息表单</td></tr><tr><td>-n</td><td>直接使用IP地址，不通过域名服务器</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示详细的网络状况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -a</span><br></pre></td></tr></table></figure><p>显示当前户籍UDP连接状况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nu</span><br></pre></td></tr></table></figure><p>显示UDP端口号的使用情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -apu </span><br></pre></td></tr></table></figure><p>显示网卡列表：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -i</span><br></pre></td></tr></table></figure><p>显示组播组的关系：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -g</span><br></pre></td></tr></table></figure><h3 id="3️⃣-ping-命令-–-测试主机间网络连通性"><a href="#3️⃣-ping-命令-–-测试主机间网络连通性" class="headerlink" title="3️⃣ ping 命令 – 测试主机间网络连通性"></a>3️⃣ ping 命令 – 测试主机间网络连通性</h3><p>ping命令主要用来测试主机之间网络的连通性，也可以用于。执行ping指令会使用ICMP传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常。</p><p>不过值得我们注意的是：Linux系统下的ping命令与Windows系统下的ping命令稍有不同。Windows下运行ping命令一般会发出4个请求就结束运行该命令；而Linux下不会自动终止，此时需要我们按CTR+C终止或者使用-c参数为ping命令指定发送的请求数目。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：ping [参数] [目标主机]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-d</td><td>使用Socket的SO_DEBUG功能</td></tr><tr><td>-c</td><td>指定发送报文的次数</td></tr><tr><td>-i</td><td>指定收发信息的间隔时间</td></tr><tr><td>-I</td><td>使用指定的网络接口送出数据包</td></tr><tr><td>-l</td><td>设置在送出要求信息之前，先行发出的数据包</td></tr><tr><td>-n</td><td>只输出数值</td></tr><tr><td>-p</td><td>设置填满数据包的范本样式</td></tr><tr><td>-q</td><td>不显示指令执行过程</td></tr><tr><td>-R</td><td>记录路由过程</td></tr><tr><td>-s</td><td>设置数据包的大小</td></tr><tr><td>-t</td><td>设置存活数值TTL的大小</td></tr><tr><td>-v</td><td>详细显示指令的执行过程</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>检测与百度网站的连通性：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure><p>连续ping4次：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping -c 4 www.baidu.com </span><br></pre></td></tr></table></figure><p>设置次数为4，时间间隔为3秒：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping -c 4 -i 3 www.baidu.com</span><br></pre></td></tr></table></figure><p>利用ping命令获取指定网站的IP地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping -c 1 baidu.com | grep from | <span class="built_in">cut</span> -d <span class="string">&quot; &quot;</span> -f 4</span><br></pre></td></tr></table></figure><h3 id="4️⃣-dhclient-命令-–-动态获取或释放IP地址"><a href="#4️⃣-dhclient-命令-–-动态获取或释放IP地址" class="headerlink" title="4️⃣ dhclient 命令 – 动态获取或释放IP地址"></a>4️⃣ dhclient 命令 – 动态获取或释放IP地址</h3><p>dhclient命令的作用是：使用动态主机配置协议动态的配置网络接口的网络参数，也支持BOOTP协议。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：dhclient [参数] [网络接口]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-p</td><td>指定dhcp客户端监听的端口号（默认端口号86）</td></tr><tr><td>-d</td><td>总是以前台方式运行程序</td></tr><tr><td>-q</td><td>安静模式，不打印任何错误的提示信息</td></tr><tr><td>-r</td><td>释放ip地址</td></tr><tr><td>-n</td><td>不配置任何接口</td></tr><tr><td>-x</td><td>停止正在运行的DHCP客户端，而不释放当前租约，杀死现有的dhclient</td></tr><tr><td>-s</td><td>在获取ip地址之前指定DHCP服务器</td></tr><tr><td>-w</td><td>即使没有找到广播接口，也继续运行</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>在指定网络接口上发出DHCP请求：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dhclient eth0</span><br></pre></td></tr></table></figure><p>释放IP地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dhclient -r</span><br></pre></td></tr></table></figure><p>从指定的服务器获取ip地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dhclient -s 10.211.55.100</span><br></pre></td></tr></table></figure><p>停止运行dhclient：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dhclient -x</span><br></pre></td></tr></table></figure><h3 id="5️⃣-ifconfig-命令-–-显示或设置网络设备"><a href="#5️⃣-ifconfig-命令-–-显示或设置网络设备" class="headerlink" title="5️⃣ ifconfig 命令 – 显示或设置网络设备"></a>5️⃣ ifconfig 命令 – 显示或设置网络设备</h3><p>ifconfig命令的英文全称是“network interfaces configuring”，即用于配置和显示Linux内核中网络接口的网络参数。用ifconfig命令配置的网卡信息，在网卡重启后机器重启后，配置就不存在。要想将上述的配置信息永远的存的电脑里，那就要修改网卡的配置文件了。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：ifconfig [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>add&lt;地址&gt;</td><td>设置网络设备IPv6的IP地址</td></tr><tr><td>del&lt;地址&gt;</td><td>删除网络设备IPv6的IP地址</td></tr><tr><td>down</td><td>关闭指定的网络设备</td></tr><tr><td>up</td><td>启动指定的网络设备</td></tr><tr><td>IP地址</td><td>指定网络设备的IP地址</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示网络设备信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure><p>启动关闭指定网卡：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 down</span><br><span class="line">ifconfig eth0 up </span><br></pre></td></tr></table></figure><p>为网卡配置和删除IPv6地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 add 33ffe:3240:800:1005::2/64</span><br><span class="line">ifconfig eth0 del 33ffe:3240:800:1005::2/64</span><br></pre></td></tr></table></figure><p>用ifconfig修改MAC地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 down</span><br><span class="line">ifconfig eth0 hw ether 00:AA:BB:CC:DD:EE</span><br><span class="line">ifconfig eth0 up</span><br><span class="line">ifconfig eth1 hw ether 00:1D:1C:1D:1E </span><br><span class="line">ifconfig eth1 up</span><br></pre></td></tr></table></figure><p>配置IP地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0 192.168.1.56 </span><br><span class="line">ifconfig eth0 192.168.1.56 netmask 255.255.255.0</span><br><span class="line">ifconfig eth0 192.168.1.56 netmask 255.255.255.0 broadcast 192.168.1.255</span><br></pre></td></tr></table></figure><h2 id="🍒-设备管理"><a href="#🍒-设备管理" class="headerlink" title="🍒 设备管理"></a>🍒 设备管理</h2><h3 id="1️⃣-mount-命令-–-文件系统挂载"><a href="#1️⃣-mount-命令-–-文件系统挂载" class="headerlink" title="1️⃣ mount 命令 – 文件系统挂载"></a>1️⃣ mount 命令 – 文件系统挂载</h3><p>mount命令用于加载文件系统到指定的加载点。此命令的最常用于挂载cdrom，使我们可以访问cdrom中的数据，因为你将光盘插入cdrom中，Linux并不会自动挂载，必须使用Linux mount命令来手动完成挂载。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：mount [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-t</td><td>指定挂载类型</td></tr><tr><td>-l</td><td>显示已加载的文件系统列表</td></tr><tr><td>-h</td><td>显示帮助信息并退出</td></tr><tr><td>-V</td><td>显示程序版本</td></tr><tr><td>-n</td><td>加载没有写入文件“&#x2F;etc&#x2F;mtab”中的文件系统</td></tr><tr><td>-r</td><td>将文件系统加载为只读模式</td></tr><tr><td>-a</td><td>加载文件“&#x2F;etc&#x2F;fstab”中描述的所有文件系统</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>查看版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -V</span><br></pre></td></tr></table></figure><p>启动所有挂载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -a</span><br></pre></td></tr></table></figure><p>挂载 &#x2F;dev&#x2F;cdrom 到 &#x2F;mnt：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt</span><br></pre></td></tr></table></figure><p>挂载nfs格式文件系统：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t nfs /123 /mnt</span><br></pre></td></tr></table></figure><p>挂载第一块盘的第一个分区到&#x2F;etc目录 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t ext4 -o loop,default /dev/sda1 /etc</span><br></pre></td></tr></table></figure><h3 id="2️⃣-MAKEDEV命令-–-建立设备"><a href="#2️⃣-MAKEDEV命令-–-建立设备" class="headerlink" title="2️⃣ MAKEDEV命令 – 建立设备"></a>2️⃣ MAKEDEV命令 – 建立设备</h3><p>MAKEDEV是一个脚本程序, 用于在 &#x2F;dev 目录下建立设备, 通过这些设备文件可以 访问位于内核的驱动程序。</p><p>MAKEDEV 脚本创建静态的设备节点，通常位于&#x2F;dev目录下。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：MAKEDEV [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-v</td><td>显示出执行的每一个动作</td></tr><tr><td>-n</td><td>并不做真正的更新, 只是显示一下它的执行效果</td></tr><tr><td>-d</td><td>删除设备文件</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示出执行的每一个动作:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./MAKEDEV -v update</span><br></pre></td></tr></table></figure><p>删除设备:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./MAKEDEV -d device</span><br></pre></td></tr></table></figure><h3 id="3️⃣-lspci命令-–-显示当前设备所有PCI总线信息"><a href="#3️⃣-lspci命令-–-显示当前设备所有PCI总线信息" class="headerlink" title="3️⃣ lspci命令 – 显示当前设备所有PCI总线信息"></a>3️⃣ lspci命令 – 显示当前设备所有PCI总线信息</h3><p>lspci命令用于显示当前主机的所有PCI总线信息，以及所有已连接的PCI设备信息。 现在主流设备如网卡储存等都采用PCI总线</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：lspci [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-n</td><td>以数字方式显示PCI厂商和设备代码</td></tr><tr><td>-t</td><td>以树状结构显示PCI设备的层次关系</td></tr><tr><td>-b</td><td>以总线为中心的视图</td></tr><tr><td>-s</td><td>仅显示指定总线插槽的设备和功能块信息</td></tr><tr><td>-i</td><td>指定PCI编号列表文件，不使用默认文件</td></tr><tr><td>-m</td><td>以机器可读方式显示PCI设备信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示当前主机的所有PCI总线信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci</span><br></pre></td></tr></table></figure><p>以树状结构显示PCI设备的层次关系：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci -t</span><br></pre></td></tr></table></figure><h3 id="4️⃣-setleds命令-–-设定键盘上方三个-LED-的状态"><a href="#4️⃣-setleds命令-–-设定键盘上方三个-LED-的状态" class="headerlink" title="4️⃣ setleds命令 – 设定键盘上方三个 LED 的状态"></a>4️⃣ setleds命令 – 设定键盘上方三个 LED 的状态</h3><p>setleds即是英文词组“set leds”的合并，翻译为中文就是设置LED灯。setleds命令用来设定键盘上方三个 LED 灯的状态。在 Linux 中，每一个虚拟主控台都有独立的设定。</p><p>这是一个十分神奇的命令，竟然可以通过命令来控制键盘的灯的状态。那么下面我一起来学习一下这个命令吧。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：setleds [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-F</td><td>设定虚拟主控台的状态</td></tr><tr><td>-D</td><td>改变虚拟主控台的状态和预设的状态</td></tr><tr><td>-L</td><td>直接改变 LED 显示的状态</td></tr><tr><td>+num&#x2F;-num</td><td>将数字键打开或关闭</td></tr><tr><td>+caps&#x2F;-caps</td><td>把大小写键打开或关闭</td></tr><tr><td>+scroll &#x2F;-scroll</td><td>把选项键打开或关闭</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>控制键盘灯num灯亮和灯灭：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setleds +num </span><br><span class="line">setleds -num </span><br></pre></td></tr></table></figure><p>控制键盘的大小写键打开或关闭，键盘指示灯亮与灭：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setleds +caps </span><br><span class="line">setleds -caps </span><br></pre></td></tr></table></figure><p>控制键盘的选项键打开或关闭，键盘指示灯亮与灭：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setleds +scroll </span><br></pre></td></tr></table></figure><p>对三灯的亮与灭的情况进行组合，分别设置为数字灯亮，大小写灯灭，选项键scroll灯灭：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setleds +num -caps -scroll</span><br></pre></td></tr></table></figure><h3 id="5️⃣-sensors命令-–-检测服务器内部温度及电压"><a href="#5️⃣-sensors命令-–-检测服务器内部温度及电压" class="headerlink" title="5️⃣ sensors命令 – 检测服务器内部温度及电压"></a>5️⃣ sensors命令 – 检测服务器内部温度及电压</h3><p>sensors命令用于检测服务器内部降温系统是否健康，可以监控主板，CPU的工作电压，风扇转速、温度等数据 。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：sensors</p></blockquote><p><strong><font color='oragen'>参考实例：</font></strong></p><p>检测cpu工作电压，温度等：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sensors</span><br></pre></td></tr></table></figure><h2 id="🍍-备份压缩"><a href="#🍍-备份压缩" class="headerlink" title="🍍 备份压缩"></a>🍍 备份压缩</h2><h3 id="1️⃣-zip-命令-–-压缩文件"><a href="#1️⃣-zip-命令-–-压缩文件" class="headerlink" title="1️⃣ zip 命令 – 压缩文件"></a>1️⃣ zip 命令 – 压缩文件</h3><p>zip程序将一个或多个压缩文件与有关文件的信息(名称、路径、日期、上次修改的时间、保护和检查信息以验证文件完整性)一起放入一个压缩存档中。可以使用一个命令将整个目录结构打包到zip存档中。</p><p>对于文本文件来说，压缩比为2：1和3：1是常见的。zip只有一种压缩方法(通缩)，并且可以在不压缩的情况下存储文件。(如果添加了bzip 2支持，zip也可以使用bzip 2压缩，但这些条目需要一个合理的现代解压缩来解压缩。当选择bzip 2压缩时，它将通货紧缩替换为默认方法。)zip会自动为每个要压缩的文件选择更好的两个文件(通缩或存储，如果选择bzip2，则选择bzip2或Store)。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：zip [参数] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-q</td><td>不显示指令执行过程</td></tr><tr><td>-r</td><td>递归处理，将指定目录下的所有文件和子目录一并处理</td></tr><tr><td>-z</td><td>替压缩文件加上注释</td></tr><tr><td>-v</td><td>显示指令执行过程或显示版本信息</td></tr><tr><td>-n&lt;字尾字符串&gt;</td><td>不压缩具有特定字尾字符串的文件</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>将 &#x2F;home&#x2F;html&#x2F; 这个目录下所有文件和文件夹打包为当前目录下的 html.zip：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -q -r html.zip /home/html</span><br></pre></td></tr></table></figure><p>压缩文件 cp.zip 中删除文件 a.c：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -dv cp.zip a.c</span><br></pre></td></tr></table></figure><p>把&#x2F;home目录下面的mydata目录压缩为mydata.zip：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r mydata.zip mydata</span><br></pre></td></tr></table></figure><p>把&#x2F;home目录下面的abc文件夹和123.txt压缩成为abc123.zip：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r abc123.zip abc 123.txt </span><br></pre></td></tr></table></figure><p>将 logs目录打包成 log.zip：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r log.zip ./logs</span><br></pre></td></tr></table></figure><h3 id="2️⃣-zipinfo命令-–-查看压缩文件信息"><a href="#2️⃣-zipinfo命令-–-查看压缩文件信息" class="headerlink" title="2️⃣ zipinfo命令 – 查看压缩文件信息"></a>2️⃣ zipinfo命令 – 查看压缩文件信息</h3><p>zipinfo命令的全称为“zip information”，该命令用于列出压缩文件信息。执行zipinfo指令可得知zip压缩文件的详细信息。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：zipinfo [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-1</td><td>只列出文件名称</td></tr><tr><td>-2</td><td>此参数的效果和指定”-1″参数类似，但可搭配”-h”,”-t”和”-z”参数使用</td></tr><tr><td>-h</td><td>只列出压缩文件的文件名称</td></tr><tr><td>-l</td><td>此参数的效果和指定”-m”参数类似，但会列出原始文件的大小而非每个文件的压缩率</td></tr><tr><td>-m</td><td>此参数的效果和指定”-s”参数类似，但多会列出每个文件的压缩率</td></tr><tr><td>-M</td><td>若信息内容超过一个画面，则采用类似more指令的方式列出信息</td></tr><tr><td>-s</td><td>用类似执行”ls -l”指令的效果列出压缩文件内容</td></tr><tr><td>-t</td><td>只列出压缩文件内所包含的文件数目，压缩前后的文件大小及压缩率</td></tr><tr><td>-T</td><td>将压缩文件内每个文件的日期时间用年，月，日，时，分，秒的顺序列出</td></tr><tr><td>-v</td><td>详细显示压缩文件内每一个文件的信息</td></tr><tr><td>-x&lt;范本样式&gt;</td><td>不列出符合条件的文件的信息</td></tr><tr><td>-z</td><td>如果压缩文件内含有注释，就将注释显示出来</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示压缩文件信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo file.zip </span><br></pre></td></tr></table></figure><p>显示压缩文件中每个文件的信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo -v file.zip</span><br></pre></td></tr></table></figure><p>只显示压缩包大小、文件数目：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo -h file.zip</span><br></pre></td></tr></table></figure><p>生成一个基本的、长格式的列表(而不是冗长的)，包括标题和总计行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo -l file</span><br></pre></td></tr></table></figure><p>查看存档中最近修改的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zipinfo -T file | <span class="built_in">sort</span> –nr -k 7 | sed 15q</span><br></pre></td></tr></table></figure><h3 id="3️⃣-unzip命令-–-解压缩zip文件"><a href="#3️⃣-unzip命令-–-解压缩zip文件" class="headerlink" title="3️⃣ unzip命令 – 解压缩zip文件"></a>3️⃣ unzip命令 – 解压缩zip文件</h3><p>unzip命令是用于.zip格式文件的解压缩工具 ，unzip命令将列出、测试或从zip格式存档中提取文件，这些文件通常位于MS-DOS系统上。</p><p>默认行为（就是没有选项）是从指定的ZIP存档中提取所有的文件到当前目录（及其下面的子目录）。一个配套程序zip（1L）创建ZIP存档；这两个程序都与PKWARE的PKZIP和PKUNZIP为MS-DOS创建的存档文件兼容，但许多情况下，程序选项或默认行为是不同的。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：unzip [参数] [文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-l</td><td>显示压缩文件内所包含的文件</td></tr><tr><td>-v</td><td>执行时显示详细的信息</td></tr><tr><td>-c</td><td>将解压缩的结果显示到屏幕上，并对字符做适当的转换</td></tr><tr><td>-n</td><td>解压缩时不要覆盖原有的文件</td></tr><tr><td>-j</td><td>不处理压缩文件中原有的目录路径</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>把&#x2F;home目录下面的mydata.zip解压到mydatabak目录里面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip mydata.zip -d mydatabak </span><br></pre></td></tr></table></figure><p>把&#x2F;home目录下面的wwwroot.zip直接解压到&#x2F;home目录里面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip wwwroot.zip</span><br></pre></td></tr></table></figure><p>把&#x2F;home目录下面的abc12.zip、abc23.zip、abc34.zip同时解压到&#x2F;home目录里面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip abc\*.zip</span><br></pre></td></tr></table></figure><p>查看把&#x2F;home目录下面的wwwroot.zip里面的内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip -v wwwroot.zip</span><br></pre></td></tr></table></figure><p>验证&#x2F;home目录下面的wwwroot.zip是否完整：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip -t wwwroot.zip</span><br></pre></td></tr></table></figure><h3 id="4️⃣-gzip命令-–-压缩和解压文件"><a href="#4️⃣-gzip命令-–-压缩和解压文件" class="headerlink" title="4️⃣ gzip命令 – 压缩和解压文件"></a>4️⃣ gzip命令 – 压缩和解压文件</h3><p>gzip命令的英文是“GNUzip”，是常用来压缩文件的工具，gzip是个使用广泛的压缩程序，文件经它压缩过后，其名称后面会多处“.gz”扩展名。</p><p>gzip是在Linux系统中经常使用的一个对文件进行压缩和解压缩的命令，既方便又好用。gzip不仅可以用来压缩大的、较少使用的文件以节省磁盘空间，还可以和tar命令一起构成Linux操作系统中比较流行的压缩文件格式。据统计，gzip命令对文本文件有60%～70%的压缩率。减少文件大小有两个明显的好处，一是可以减少存储空间，二是通过网络传输文件时，可以减少传输的时间。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：gzip [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>使用ASCII文字模式</td></tr><tr><td>-d</td><td>解开压缩文件</td></tr><tr><td>-f</td><td>强行压缩文件</td></tr><tr><td>-l</td><td>列出压缩文件的相关信息</td></tr><tr><td>-c</td><td>把压缩后的文件输出到标准输出设备，不去更动原始文件</td></tr><tr><td>-r</td><td>递归处理，将指定目录下的所有文件及子目录一并处理</td></tr><tr><td>-q</td><td>不显示警告信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>把rancher-v2.2.0目录下的每个文件压缩成.gz文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip *</span><br></pre></td></tr></table></figure><p>把上例中每个压缩的文件解压，并列出详细的信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -dv *</span><br></pre></td></tr></table></figure><p>递归地解压目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -dr rancher.gz</span><br></pre></td></tr></table></figure><h3 id="5️⃣-unarj命令-–-解压-arj文件"><a href="#5️⃣-unarj命令-–-解压-arj文件" class="headerlink" title="5️⃣ unarj命令 – 解压.arj文件"></a>5️⃣ unarj命令 – 解压.arj文件</h3><p>unarj命令用于解压缩.arj文件。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：unarj [参数] [.arj压缩文件]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-e</td><td>解压缩.arj文件</td></tr><tr><td>-l</td><td>显示压缩文件内所包含的文件</td></tr><tr><td>-t</td><td>检查压缩文件是否正确</td></tr><tr><td>-x</td><td>解压缩时保留原有的路径</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>解压缩.arj文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unarj -e test.arj</span><br></pre></td></tr></table></figure><p>显示压缩文件内所包含的文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unarj -l test.arj</span><br></pre></td></tr></table></figure><p>检查压缩文件是否正确：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unarj -t test.arj</span><br></pre></td></tr></table></figure><p>解压缩时保留原有的路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unarj -x test.arj</span><br></pre></td></tr></table></figure><p>把文件解压到当前路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unarj -ex test.arj</span><br></pre></td></tr></table></figure><h2 id="🍌-其他命令"><a href="#🍌-其他命令" class="headerlink" title="🍌 其他命令"></a>🍌 其他命令</h2><h3 id="1️⃣-hash-命令-–-显示与清除命令运行时查询的哈希表"><a href="#1️⃣-hash-命令-–-显示与清除命令运行时查询的哈希表" class="headerlink" title="1️⃣ hash 命令 – 显示与清除命令运行时查询的哈希表"></a>1️⃣ hash 命令 – 显示与清除命令运行时查询的哈希表</h3><p>hash命令负责显示与清除命令运行时系统优先查询的哈希表（hash table）。</p><p>当执行hash命令不指定参数或标志时，hash命令向标准输出报告路径名列表的内容。此报告含有先前hash命令调用找到的当前shell环境中命令的路径名。而且还包含通过正常命令搜索进程调用并找到的那些命令。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式: hash [参数] [目录]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-d</td><td>在哈希表中清除记录</td></tr><tr><td>-l</td><td>显示哈希表中的命令</td></tr><tr><td>-p&lt;指令&gt;</td><td>将具有完整路径的命令加入到哈希表中</td></tr><tr><td>-r</td><td>清除哈希表中的记录</td></tr><tr><td>-t</td><td>显示哈希表中命令的完整路径</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示哈希表中的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span> -l </span><br></pre></td></tr></table></figure><p>删除哈希表中的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span> -r </span><br></pre></td></tr></table></figure><p>向哈希表中添加命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span> -p /usr/sbin/adduser myadduser </span><br></pre></td></tr></table></figure><p>在哈希表中清除记录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span> -d</span><br></pre></td></tr></table></figure><p>显示哈希表中命令的完整路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span> -t</span><br></pre></td></tr></table></figure><h3 id="2️⃣-grep-命令-–-强大的文本搜索工具"><a href="#2️⃣-grep-命令-–-强大的文本搜索工具" class="headerlink" title="2️⃣ grep 命令 – 强大的文本搜索工具"></a>2️⃣ grep 命令 – 强大的文本搜索工具</h3><p>grep是“global search regular expression and print out the line”的简称，意思是全面搜索正则表达式，并将其打印出来。这个命令可以结合正则表达式使用，它也是linux使用最为广泛的命令。</p><p>grep命令的选项用于对搜索过程的补充，而其命令的模式十分灵活，可以是变量、字符串、正则表达式。需要注意的是：一当模式中包含了空格，务必要用双引号将其引起来。</p><p>linux系统支持三种形式的grep命令，大儿子就是grep，标准，模仿的代表。二儿子兴趣爱好多-egrep，简称扩展grep命令，其实和grep -E等价，支持基本和扩展的正则表达式。小儿子跑的最快-fgrep，简称快速grep命令，其实和grep -F等价，不支持正则表达式，按照字符串表面意思进行匹配。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式： grep [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-i</td><td>搜索时，忽略大小写</td></tr><tr><td>-c</td><td>只输出匹配行的数量</td></tr><tr><td>-l</td><td>只列出符合匹配的文件名，不列出具体的匹配行</td></tr><tr><td>-n</td><td>列出所有的匹配行，显示行号</td></tr><tr><td>-h</td><td>查询多文件时不显示文件名</td></tr><tr><td>-s</td><td>不显示不存在、没有匹配文本的错误信息</td></tr><tr><td>-v</td><td>显示不包含匹配文本的所有行</td></tr><tr><td>-w</td><td>匹配整词</td></tr><tr><td>-x</td><td>匹配整行</td></tr><tr><td>-r</td><td>递归搜索</td></tr><tr><td>-q</td><td>禁止输出任何结果，已退出状态表示搜索是否成功</td></tr><tr><td>-b</td><td>打印匹配行距文件头部的偏移量，以字节为单位</td></tr><tr><td>-o</td><td>与-b结合使用，打印匹配的词据文件头部的偏移量，以字节为单位</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>支持多文件查询并支持使用通配符：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep zwx file_* /etc/hosts</span><br></pre></td></tr></table></figure><p>输出匹配字符串行的数量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -c zwx file_*</span><br></pre></td></tr></table></figure><p>列出所有的匹配行，并显示行号：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -n zwx file_*</span><br></pre></td></tr></table></figure><p>显示不包含模式的所有行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -vc zwx file_*</span><br></pre></td></tr></table></figure><p>不再显示文件名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -h zwx file_*</span><br></pre></td></tr></table></figure><p>只列出符合匹配的文件名，不列出具体匹配的行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -l zwx file_*</span><br></pre></td></tr></table></figure><p>不显示不存在或无匹配的文本信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep  -s zwx file1 file_1</span><br><span class="line">grep zwx file1 file_1</span><br></pre></td></tr></table></figure><p>递归搜索，不仅搜索当前目录，还搜索子目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -r zwx file_2 *</span><br></pre></td></tr></table></figure><p>匹配整词，以字面意思去解释他，相当于精确匹配：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep zw* file_1</span><br><span class="line">grep -w zw* file_1</span><br></pre></td></tr></table></figure><p>匹配整行，文件中的整行与模式匹配时，才打印出来：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -x zwx file_*</span><br></pre></td></tr></table></figure><p>不输出任何结果，已退出状态表示结果：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grep -q zwx file_1</span><br><span class="line"><span class="built_in">echo</span> $?</span><br><span class="line">grep -q zwx file_5</span><br><span class="line"><span class="built_in">echo</span> $?</span><br><span class="line">grep -q zwx file5</span><br><span class="line"><span class="built_in">echo</span> $?</span><br></pre></td></tr></table></figure><p>查找一个文件中的空行和非空行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -c ^$ file_1</span><br><span class="line">grep -c ^[^$] file_1</span><br></pre></td></tr></table></figure><p>匹配任意或重复字符用“.”或“*”符号来实现：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep ^z.x file_1</span><br><span class="line">grep ^z* file_6</span><br></pre></td></tr></table></figure><h3 id="3️⃣-wait命令-–-等待指令"><a href="#3️⃣-wait命令-–-等待指令" class="headerlink" title="3️⃣ wait命令 – 等待指令"></a>3️⃣ wait命令 – 等待指令</h3><p>wait命令用来等待指令的指令，直到其执行完毕后返回终端。该指令常用于shell脚本编程中，待指定的指令执行完成后，才会继续执行后面的任务。该指令等待作业时，在作业标识号前必须添加备份号”%”。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：wait [参数]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>22 或%1</td><td>进程号 或 作业号</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>等待作业号为1的作业完成后再返回：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wait</span> %1</span><br><span class="line">find / -name password</span><br></pre></td></tr></table></figure><h3 id="4️⃣-bc命令-–-浮点运算"><a href="#4️⃣-bc命令-–-浮点运算" class="headerlink" title="4️⃣ bc命令 – 浮点运算"></a>4️⃣ bc命令 – 浮点运算</h3><p>bc的英文全拼为“ Binary Calculator ”，是一种支持任意精度的交互执行的计算器语言。bash内置了对整数四则运算的支持，但是并不支持浮点运算，而bc命令可以很方便的进行浮点运算，当然整数运算也不再话下。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式：bc [选项]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-i</td><td>强制进入交互式模式</td></tr><tr><td>-l</td><td>定义使用的标准数学库</td></tr><tr><td>-w</td><td>定义使用的标准数学库</td></tr><tr><td>-q</td><td>打印正常的GNU bc环境信息</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>算术操作高级运算bc命令它可以执行浮点运算和一些高级函数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1.212*3&quot;</span> | bc </span><br></pre></td></tr></table></figure><p>设定小数精度（数值范围）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;scale=2;3/8&quot;</span> | bc</span><br></pre></td></tr></table></figure><p>计算平方和平方根：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;10^10&quot;</span> | bc</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;sqrt(100)&quot;</span> | bc</span><br></pre></td></tr></table></figure><h3 id="5️⃣-history命令-–-显示与操纵历史命令"><a href="#5️⃣-history命令-–-显示与操纵历史命令" class="headerlink" title="5️⃣ history命令 – 显示与操纵历史命令"></a>5️⃣ history命令 – 显示与操纵历史命令</h3><p>history命令用于显示用户以前执行过的历史命令，并且能对历史命令进行追加和删除等操作。</p><p>如果你经常使用Linux命令，那么使用history命令可以有效地提升你的效率。</p><p><strong><font color='oragen'>语法：</font></strong></p><blockquote><p>语法格式: history [参数] [目录]</p></blockquote><p><strong><font color='oragen'>常用参数：</font></strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-a</td><td>将当前shell会话的历史命令追加到命令历史文件中,命令历史文件是保存历史命令的配置文件</td></tr><tr><td>-c</td><td>清空当前历史命令列表</td></tr><tr><td>-d</td><td>删除历史命令列表中指定序号的命令</td></tr><tr><td>-n</td><td>从命令历史文件中读取本次Shell会话开始时没有读取的历史命令</td></tr><tr><td>-r</td><td>读取命令历史文件到当前的Shell历史命令内存缓冲区</td></tr><tr><td>-s</td><td>将指定的命令作为单独的条目加入命令历史内存缓冲区。在执行添加之前先删除命令历史内存缓冲区中最后一条命令</td></tr><tr><td>-w</td><td>把当前的shell历史命令内存缓冲区的内容写入命令历史文件</td></tr></tbody></table><p><strong><font color='oragen'>参考实例：</font></strong></p><p>显示最近的10条命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> 10</span><br></pre></td></tr></table></figure><p>将本次登录的命令写入历史文件中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> -w</span><br></pre></td></tr></table></figure><p>将命令历史文件中的内容读入到目前shell的history记忆中 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> -r</span><br></pre></td></tr></table></figure><p>将当前Shell会话的历史命令追加到命令历史文件中：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> -a</span><br></pre></td></tr></table></figure><p>清空当前历史命令列表：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">history</span> -c </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库 SQL 入门基础教程</title>
      <link href="/post/44cfa5bd.html"/>
      <url>/post/44cfa5bd.html</url>
      
        <content type="html"><![CDATA[<h1 id="📚-前言"><a href="#📚-前言" class="headerlink" title="📚 前言"></a>📚 前言</h1><p>SQL语言有40多年的历史，从它被应用至今几乎无处不在。我们消费的每一笔支付记录，收集的每一条用户信息，发出去的每一条消息，都会使用数据库或与其相关的产品来存储，而操纵数据库的语言正是 SQL ！</p><p><img src="https://img-blog.csdnimg.cn/a5afef7109c1415992a071a97b190364.png"></p><p>SQL 对于现在的互联网公司生产研发等岗位几乎是一个必备技能，如果不会 SQL 的话，可能什么都做不了。你可以把 SQL 当做是一种工具，利用它可以帮助你完成你的工作，创造价值。</p><p> <font color='red'><b>文章结尾有 SQL 小测验哦！看看你能得几分？</b></font></p><p><strong>⭐️ <a href="#jump_100">点我跳转到 SQL 测验！</a></strong></p><h1 id="🌴-SQL-介绍"><a href="#🌴-SQL-介绍" class="headerlink" title="🌴 SQL 介绍"></a>🌴 SQL 介绍</h1><h2 id="🌼-什么是-SQL"><a href="#🌼-什么是-SQL" class="headerlink" title="🌼 什么是 SQL"></a>🌼 什么是 SQL</h2><p>SQL 是用于访问和处理数据库的标准的计算机语言。</p><ul><li>SQL 指结构化查询语言</li><li>SQL 使我们有能力访问数据库</li><li>SQL 是一种 ANSI 的标准计算机语言</li></ul><p><img src="https://img-blog.csdnimg.cn/72e2475eee7047e1a867f61dd2ca8808.png"></p><p>SQL 可与数据库程序协同工作，比如 MS Access、DB2、Informix、MS SQL Server、Oracle、Sybase 以及其他数据库系统。但是由于各种各样的数据库出现，导致很多不同版本的 SQL 语言，为了与 ANSI 标准相兼容，它们必须以相似的方式共同地来支持一些主要的关键词（比如 SELECT、UPDATE、DELETE、INSERT、WHERE 等等），这些就是我们要学习的SQL基础。</p><h2 id="🌀-SQL-的类型"><a href="#🌀-SQL-的类型" class="headerlink" title="🌀 SQL 的类型"></a>🌀 SQL 的类型</h2><p>可以把 SQL 分为两个部分：数据操作语言 (DML) 和 数据定义语言 (DDL)。</p><ul><li>数据查询语言（DQL: Data Query Language）</li><li>数据操纵语言（DML：Data Manipulation Language）</li></ul><h2 id="🌵-学习-SQL-的作用"><a href="#🌵-学习-SQL-的作用" class="headerlink" title="🌵 学习 SQL 的作用"></a>🌵 学习 SQL 的作用</h2><p>SQL 是一门 ANSI 的标准计算机语言，用来访问和操作数据库系统。SQL 语句用于取回和更新数据库中的数据。</p><ul><li>SQL 面向数据库执行查询</li><li>SQL 可从数据库取回数据</li><li>SQL 可在数据库中插入新的记录</li><li>SQL 可更新数据库中的数据</li><li>SQL 可从数据库删除记录</li><li>SQL 可创建新数据库</li><li>SQL 可在数据库中创建新表</li><li>SQL 可在数据库中创建存储过程</li><li>SQL 可在数据库中创建视图</li><li>SQL 可以设置表、存储过程和视图的权限</li></ul><h2 id="🍄-数据库是什么"><a href="#🍄-数据库是什么" class="headerlink" title="🍄 数据库是什么"></a>🍄 数据库是什么</h2><p><strong>顾名思义，你可以理解为数据库是用来存放数据的一个容器。</strong></p><p>打个比方，每个人家里都会有冰箱，冰箱是用来干什么的？冰箱是用来存放食物的地方。</p><p><img src="https://img-blog.csdnimg.cn/196294d8250d4e85982204e59447dff7.png"></p><p>同样的，数据库是存放数据的地方。正是因为有了数据库后，我们可以直接查找数据。例如你每天使用余额宝查看自己的账户收益，就是从数据库读取数据后给你的。</p><p><strong>最常见的数据库类型是关系型数据库管理系统（RDBMS）：</strong></p><p>RDBMS 是 SQL 的基础，同样也是所有现代数据库系统的基础，比如 MS SQL Server, IBM DB2, Oracle, MySQL 以及 Microsoft Access等等。</p><p><img src="https://img-blog.csdnimg.cn/5d3752cad1c241e2a624ca1e41bc7c20.png"></p><p><code>RDBMS</code> 中的数据存储在被称为表（tables）的数据库对象中。<code>表</code> 是相关的数据项的集合，它由列和行组成。</p><p>由于本文主要讲解 SQL 基础，因此对数据库不做过多解释，只需要大概了解即可。**<font color='orage'>咱们直接开始学习SQL！</font>**</p><h1 id="🐥-SQL-基础语言学习"><a href="#🐥-SQL-基础语言学习" class="headerlink" title="🐥 SQL 基础语言学习"></a>🐥 SQL 基础语言学习</h1><p>在了解 SQL 基础语句使用之前，我们先讲一下 <code>表</code> 是什么？</p><p>一个数据库通常包含一个或多个表。每个表由一个名字标识（例如“客户”或者“订单”）。表包含带有数据的记录(行)。</p><p><strong>下面的例子是一个名为 “Persons” 的表：</strong></p><table><thead><tr><th>Id</th><th>LastName</th><th>FirstName</th><th>Address</th><th>City</th></tr></thead><tbody><tr><td>1</td><td>Adams</td><td>John</td><td>Oxford Street</td><td>London</td></tr><tr><td>2</td><td>Bush</td><td>George</td><td>Fifth Avenue</td><td>New York</td></tr><tr><td>3</td><td>Carter</td><td>Thomas</td><td>Changan Street</td><td>Beijing</td></tr></tbody></table><p>上面的表包含三条记录（每一条对应一个人）和五个列（Id、姓、名、地址和城市）。</p><p><strong><font color='orage'>有表才能查询，那么如何创建这样一个表？</font></strong></p><h2 id="🐤-CREATE-TABLE-–-创建表"><a href="#🐤-CREATE-TABLE-–-创建表" class="headerlink" title="🐤 CREATE TABLE – 创建表"></a>🐤 CREATE TABLE – 创建表</h2><p>CREATE TABLE 语句用于创建数据库中的表。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名称</span><br><span class="line">(</span><br><span class="line">列名称<span class="number">1</span> 数据类型,</span><br><span class="line">列名称<span class="number">2</span> 数据类型,</span><br><span class="line">列名称<span class="number">3</span> 数据类型,</span><br><span class="line">....</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>数据类型（data_type）规定了列可容纳何种数据类型。下面的表格包含了SQL中最常用的数据类型：</p><table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>integer(size),int(size),smallint(size),tinyint(size)</td><td>仅容纳整数、在括号内规定数字的最大位数</td></tr><tr><td>decimal(size,d),numeric(size,d)</td><td>容纳带有小数的数字、”size” 规定数字的最大位数、”d” 规定小数点右侧的最大位数</td></tr><tr><td>char(size)</td><td>容纳固定长度的字符串（可容纳字母、数字以及特殊字符）、在括号中规定字符串的长度</td></tr><tr><td>varchar(size)</td><td>容纳可变长度的字符串（可容纳字母、数字以及特殊的字符）、在括号中规定字符串的最大长度</td></tr><tr><td>date(yyyymmdd)</td><td>容纳日期</td></tr></tbody></table><p><strong><font color='orage'>实例：</font></strong></p><p>本例演示如何创建名为 “Persons” 的表。</p><p>该表包含 5 个列，列名分别是：”Id_P”、”LastName”、”FirstName”、”Address” 以及 “City”：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons</span><br><span class="line">(</span><br><span class="line">Id_P <span class="type">int</span>,</span><br><span class="line">LastName <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">FirstName <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>Id_P 列的数据类型是 int，包含整数。其余 4 列的数据类型是 varchar，最大长度为 255 个字符。</p><p><img src="https://img-blog.csdnimg.cn/b60a078e11cc41648d68d138d8ff5255.png"></p><p><img src="https://img-blog.csdnimg.cn/23fdf786f1194420a61783f626e10602.png"></p><p><strong>空的 “Persons” 表类似这样：</strong></p><p><img src="https://img-blog.csdnimg.cn/97a880f0db5948f4871acf61b9bdc718.png"></p><p>可使用 INSERT INTO 语句向空表写入数据。</p><h2 id="🐑-INSERT-–-插入数据"><a href="#🐑-INSERT-–-插入数据" class="headerlink" title="🐑 INSERT – 插入数据"></a>🐑 INSERT – 插入数据</h2><p>INSERT INTO 语句用于向表格中插入新的行。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名称 <span class="keyword">VALUES</span> (值<span class="number">1</span>, 值<span class="number">2</span>,....);</span><br></pre></td></tr></table></figure><p>我们也可以指定所要插入数据的列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (列<span class="number">1</span>, 列<span class="number">2</span>,...) <span class="keyword">VALUES</span> (值<span class="number">1</span>, 值<span class="number">2</span>,....);</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>本例演示 “Persons” 表插入记录的两种方式：</p><p><strong>1、插入新的行</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Gates&#x27;</span>, <span class="string">&#x27;Bill&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>2、在指定的列中插入数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons (LastName, Address) <span class="keyword">VALUES</span> (<span class="string">&#x27;Wilson&#x27;</span>, <span class="string">&#x27;Champs-Elysees&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/4ac725e7e3324bfe97998a08941a233e.png"></p><p><strong>插入成功后，数据如下：</strong></p><p><img src="https://img-blog.csdnimg.cn/6824a8e2bf50489fbb48ce37686e38e3.png"></p><p>这个数据插入之后，是通过 <code>SELECT</code> 语句进行查询出来的，别急马上讲！</p><h2 id="🐼-SELECT-–-查询数据"><a href="#🐼-SELECT-–-查询数据" class="headerlink" title="🐼 SELECT – 查询数据"></a>🐼 SELECT – 查询数据</h2><p>SELECT 语句用于从表中选取数据，结果被存储在一个结果表中（称为结果集）。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名称;</span><br></pre></td></tr></table></figure><p>我们也可以指定所要查询数据的列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名称 <span class="keyword">FROM</span> 表名称;</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> SQL 语句对大小写不敏感，SELECT 等效于 select。</p><p><strong><font color='orage'>实例：</font></strong></p><p><strong>SQL SELECT * 实例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a9d38f90b2f84580b779ab229951b025.png"></p><p><strong>📢 注意：</strong> 星号（*）是选取所有列的快捷方式。</p><p>如需获取名为 “LastName” 和 “FirstName” 的列的内容（从名为 “Persons” 的数据库表），请使用类似这样的 SELECT 语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LastName,FirstName <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/0543e99d10eb41d1b49f43efe9ce7d3e.png"></p><h2 id="🐫-DISTINCT-–-去除重复值"><a href="#🐫-DISTINCT-–-去除重复值" class="headerlink" title="🐫 DISTINCT – 去除重复值"></a>🐫 DISTINCT – 去除重复值</h2><p>如果一张表中有多行重复数据，如何去重显示呢？可以了解下 <code>DISTINCT</code> 。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> 列名称 <span class="keyword">FROM</span> 表名称;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>如果要从 “LASTNAME” 列中选取所有的值，我们需要使用 <code>SELECT</code> 语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LASTNAME <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/7e3faf9ee1a345f89b01b46ff4b38d61.png"></p><p>可以发现，在结果集中，Wilson 被列出了多次。</p><p>如需从 “LASTNAME” 列中仅选取唯一不同的值，我们需要使用 SELECT DISTINCT 语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> LASTNAME <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/6a2227801a354448aeb5124c94df482a.png"></p><p>通过上述查询，结果集中只显示了一列 Wilson，显然已经去除了重复列。</p><h2 id="🐸-WHERE-–-条件过滤"><a href="#🐸-WHERE-–-条件过滤" class="headerlink" title="🐸 WHERE – 条件过滤"></a>🐸 WHERE – 条件过滤</h2><p>如果需要从表中选取指定的数据，可将 WHERE 子句添加到 SELECT 语句。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名称 <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列 运算符 值;</span><br></pre></td></tr></table></figure><p>下面的运算符可在 WHERE 子句中使用：</p><table><thead><tr><th>操作符</th><th>描述</th></tr></thead><tbody><tr><td>&#x3D;</td><td>等于</td></tr><tr><td>&lt;&gt;</td><td>不等于</td></tr><tr><td>&gt;</td><td>大于</td></tr><tr><td>&lt;</td><td>小于</td></tr><tr><td>&gt;&#x3D;</td><td>大于等于</td></tr><tr><td>&lt;&#x3D;</td><td>小于等于</td></tr><tr><td>BETWEEN</td><td>在某个范围内</td></tr><tr><td>LIKE</td><td>搜索某种模式</td></tr></tbody></table><p><strong>📢 注意：</strong> 在某些版本的 SQL 中，操作符 &lt;&gt; 可以写为 !&#x3D;。</p><p><strong><font color='orage'>实例：</font></strong></p><p>如果只希望选取居住在城市 “Beijing” 中的人，我们需要向 SELECT 语句添加 WHERE 子句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> City<span class="operator">=</span><span class="string">&#x27;Beijing&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/49195c9589be4366b44abc9392995266.png"></p><p><strong>📢 注意：</strong> SQL 使用单引号来环绕文本值（大部分数据库系统也接受双引号）。如果是数值，请不要使用引号。</p><h2 id="🐹-AND-amp-OR-–-运算符"><a href="#🐹-AND-amp-OR-–-运算符" class="headerlink" title="🐹 AND &amp; OR – 运算符"></a>🐹 AND &amp; OR – 运算符</h2><p>AND 和 OR 可在 WHERE 子语句中把两个或多个条件结合起来。</p><ul><li>如果第一个条件和第二个条件都成立，则 AND 运算符显示一条记录。</li><li>如果第一个条件和第二个条件中只要有一个成立，则 OR 运算符显示一条记录。</li></ul><p><strong><font color='orage'>语法：</font></strong></p><p><strong>AND 运算符实例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列 运算符 值 <span class="keyword">AND</span> 列 运算符 值;</span><br></pre></td></tr></table></figure><p><strong>OR 运算符实例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列 运算符 值 <span class="keyword">OR</span> 列 运算符 值;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>由于 Persons 表数据太少，因此增加几条记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Adams&#x27;</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Oxford Street&#x27;</span>, <span class="string">&#x27;London&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Bush&#x27;</span>, <span class="string">&#x27;George&#x27;</span>, <span class="string">&#x27;Fifth Avenue&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, <span class="string">&#x27;Changan Street&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;William&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/44378f501d2149b0afe9f8405e465bfc.png"></p><p><strong>AND 运算符实例：</strong></p><p>使用 AND 来显示所有姓为 “Carter” 并且名为 “Thomas” 的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> FirstName<span class="operator">=</span><span class="string">&#x27;Thomas&#x27;</span> <span class="keyword">AND</span> LastName<span class="operator">=</span><span class="string">&#x27;Carter&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/7a5e293ef07649a8a1d5ce8950f0a744.png"></p><p><strong>OR 运算符实例：</strong></p><p>使用 OR 来显示所有姓为 “Carter” 或者名为 “Thomas” 的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> firstname<span class="operator">=</span><span class="string">&#x27;Thomas&#x27;</span> <span class="keyword">OR</span> lastname<span class="operator">=</span><span class="string">&#x27;Carter&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/81560c1384fe4dcb9690544e06b77d1c.png"></p><p><strong>结合 AND 和 OR 运算符：</strong></p><p>我们也可以把 AND 和 OR 结合起来（使用圆括号来组成复杂的表达式）:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> (FirstName<span class="operator">=</span><span class="string">&#x27;Thomas&#x27;</span> <span class="keyword">OR</span> FirstName<span class="operator">=</span><span class="string">&#x27;William&#x27;</span>) <span class="keyword">AND</span> LastName<span class="operator">=</span><span class="string">&#x27;Carter&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/052acfbed08743809653c1aa4057a22c.png"></p><h2 id="🐰-ORDER-BY-–-排序"><a href="#🐰-ORDER-BY-–-排序" class="headerlink" title="🐰 ORDER BY – 排序"></a>🐰 ORDER BY – 排序</h2><p>ORDER BY 语句用于根据指定的列对结果集进行排序，默认按照升序对记录进行排序，如果您希望按照降序对记录进行排序，可以使用 DESC 关键字。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名称 <span class="keyword">ORDER</span> <span class="keyword">BY</span> 列<span class="number">1</span>,列<span class="number">2</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>默认排序为 ASC 升序，DESC 代表降序。</p><p><strong><font color='orage'>实例：</font></strong></p><p>以字母顺序显示 <code>LASTNAME</code> 名称：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">ORDER</span> <span class="keyword">BY</span> LASTNAME;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/cdb66209cdbf4f37a3852684f851e508.png"></p><p>空值（NULL）默认排序在有值行之后。</p><p>以数字顺序显示<code>ID_P</code>，并以字母顺序显示 <code>LASTNAME</code> 名称：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">ORDER</span> <span class="keyword">BY</span> ID_P,LASTNAME;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/26cf3cad53d14c99be9b4dc1975ba600.png"></p><p>以数字降序显示<code>ID_P</code>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">ORDER</span> <span class="keyword">BY</span> ID_P <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/8552137098e541108eda00d54279cc62.png"></p><p><strong>📢 注意：</strong> 在第一列中有相同的值时，第二列是以升序排列的。如果第一列中有些值为 null 时，情况也是这样的。</p><h2 id="🐱-UPDATE-–-更新数据"><a href="#🐱-UPDATE-–-更新数据" class="headerlink" title="🐱 UPDATE – 更新数据"></a>🐱 UPDATE – 更新数据</h2><p>Update 语句用于修改表中的数据。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名称 <span class="keyword">SET</span> 列名称 <span class="operator">=</span> 新值 <span class="keyword">WHERE</span> 列名称 <span class="operator">=</span> 某值;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p><strong>更新某一行中的一个列：</strong></p><p>目前 <code>Persons</code> 表有很多字段为 <code>null </code> 的数据，可以通过 <code>UPDATE</code> 为 LASTNAME 是 “Wilson” 的人添加FIRSTNAME：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Persons <span class="keyword">SET</span> FirstName <span class="operator">=</span> <span class="string">&#x27;Fred&#x27;</span> <span class="keyword">WHERE</span> LastName <span class="operator">=</span> <span class="string">&#x27;Wilson&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d7f7facd22314ba48c5ceec8bc52adfe.png"></p><p><strong>更新某一行中的若干列：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Persons <span class="keyword">SET</span> ID_P <span class="operator">=</span> <span class="number">6</span>,city<span class="operator">=</span> <span class="string">&#x27;London&#x27;</span> <span class="keyword">WHERE</span> LastName <span class="operator">=</span> <span class="string">&#x27;Wilson&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c58528527ed744d68b32b670bcd21064.png"></p><h2 id="🐨-DELETE-–-删除数据"><a href="#🐨-DELETE-–-删除数据" class="headerlink" title="🐨 DELETE – 删除数据"></a>🐨 DELETE – 删除数据</h2><p>DELETE 语句用于删除表中的行。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列名称 <span class="operator">=</span> 值;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p><strong>删除某行：</strong></p><p>删除 <code>Persons</code> 表中 LastName 为 “Fred Wilson” 的行：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> LastName <span class="operator">=</span> <span class="string">&#x27;Wilson&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/96af8936877f4cb4bb2c515a3f2b5cb6.png"></p><p><strong>删除所有行：</strong></p><p>可以在不删除表的情况下删除所有的行。这意味着表的结构、属性和索引都是完整的：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a71ee01df5c34e9a985ef0162868baac.png"></p><h2 id="🐵-TRUNCATE-TABLE-–-清除表数据"><a href="#🐵-TRUNCATE-TABLE-–-清除表数据" class="headerlink" title="🐵 TRUNCATE TABLE – 清除表数据"></a>🐵 TRUNCATE TABLE – 清除表数据</h2><p>如果我们仅仅需要除去表内的数据，但并不删除表本身，那么我们该如何做呢？</p><p>可以使用 TRUNCATE TABLE 命令（仅仅删除表格中的数据）：</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> 表名称;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>本例演示如何删除名为 “Persons” 的表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> persons;</span><br></pre></td></tr></table></figure><h2 id="🐯-DROP-TABLE-–-删除表"><a href="#🐯-DROP-TABLE-–-删除表" class="headerlink" title="🐯 DROP TABLE – 删除表"></a>🐯 DROP TABLE – 删除表</h2><p>DROP TABLE 语句用于删除表（表的结构、属性以及索引也会被删除）。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> 表名称;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>本例演示如何删除名为 “Persons” 的表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a3a4b51c18664b438ef201d92704440f.png"></p><p>从上图可以看出，第一次执行删除时，成功删除了表 <code>persons</code>，第二次执行删除时，报错找不到表 <code>persons</code>，说明表已经被删除了。</p><h1 id="🚀-SQL-高级言语学习"><a href="#🚀-SQL-高级言语学习" class="headerlink" title="🚀 SQL 高级言语学习"></a>🚀 SQL 高级言语学习</h1><h2 id="🚢-LIKE-–-查找类似值"><a href="#🚢-LIKE-–-查找类似值" class="headerlink" title="🚢 LIKE – 查找类似值"></a>🚢 LIKE – 查找类似值</h2><p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名<span class="operator">/</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列名称 <span class="keyword">LIKE</span> 值;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p><code>Persons</code> 表插入数据：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Gates&#x27;</span>, <span class="string">&#x27;Bill&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Adams&#x27;</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Oxford Street&#x27;</span>, <span class="string">&#x27;London&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Bush&#x27;</span>, <span class="string">&#x27;George&#x27;</span>, <span class="string">&#x27;Fifth Avenue&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, <span class="string">&#x27;Changan Street&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;William&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/cba1142393554d3490acdc69efa541be.png"></p><p>1、现在，我们希望从上面的 “Persons” 表中选取居住在以 “N” 开头的城市里的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> City <span class="keyword">LIKE</span> <span class="string">&#x27;N%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/66498b6c0c884d42b1d299db17a14389.png"></p><p>2、接下来，我们希望从 “Persons” 表中选取居住在以 “g” 结尾的城市里的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> City <span class="keyword">LIKE</span> <span class="string">&#x27;%g&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/0ef01afee4934a8eacd2d0abd494a8e0.png"></p><p>3、接下来，我们希望从 “Persons” 表中选取居住在包含 “lon” 的城市里的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> City <span class="keyword">LIKE</span> <span class="string">&#x27;%on%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/deccca6bc636468d9f33a218d65834c8.png"></p><p>4、通过使用 NOT 关键字，我们可以从 “Persons” 表中选取居住在不包含 “lon” 的城市里的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> City <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%on%&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/49066d5ee50f4a34b918ceac3a9f162f.png"><br><strong>📢注意：</strong> “%” 可用于定义通配符（模式中缺少的字母）。</p><h2 id="🚤-IN-–-锁定多个值"><a href="#🚤-IN-–-锁定多个值" class="headerlink" title="🚤 IN – 锁定多个值"></a>🚤 IN – 锁定多个值</h2><p>IN 操作符允许我们在 WHERE 子句中规定多个值。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名<span class="operator">/</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列名称 <span class="keyword">IN</span> (值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3</span>);</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>现在，我们希望从 <code>Persons</code> 表中选取姓氏为 Adams 和 Carter 的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> LastName <span class="keyword">IN</span> (<span class="string">&#x27;Adams&#x27;</span>,<span class="string">&#x27;Carter&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/7e47403959854b02bbe172c422ec4ce5.png"></p><h2 id="⛵️-BETWEEN-–-选取区间数据"><a href="#⛵️-BETWEEN-–-选取区间数据" class="headerlink" title="⛵️ BETWEEN – 选取区间数据"></a>⛵️ BETWEEN – 选取区间数据</h2><p>操作符 BETWEEN … AND 会选取介于两个值之间的数据范围。这些值可以是数值、文本或者日期。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名<span class="operator">/</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列名称 <span class="keyword">BETWEEN</span> 值<span class="number">1</span> <span class="keyword">AND</span> 值<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>1、查询以字母顺序显示介于 “Adams”（包括）和 “Carter”（不包括）之间的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> LastName <span class="keyword">BETWEEN</span> <span class="string">&#x27;Adams&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;Carter&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f6704c60c7b440afb699b55840754f4c.png"></p><p>2、查询上述结果相反的结果，可以使用 NOT：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Persons <span class="keyword">WHERE</span> LastName <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="string">&#x27;Adams&#x27;</span> <span class="keyword">AND</span> <span class="string">&#x27;Carter&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/12133eca504c42df8e97126de4d182a9.png"></p><p><strong>📢 注意：</strong> 不同的数据库对 BETWEEN…AND 操作符的处理方式是有差异的。</p><blockquote><p>某些数据库会列出介于 “Adams” 和 “Carter” 之间的人，但不包括 “Adams” 和 “Carter” ；某些数据库会列出介于 “Adams” 和 “Carter” 之间并包括 “Adams” 和 “Carter” 的人；而另一些数据库会列出介于 “Adams” 和 “Carter” 之间的人，包括 “Adams” ，但不包括 “Carter” 。</p></blockquote><p><strong><font color='orage'>所以，请检查你的数据库是如何处理 BETWEEN….AND 操作符的！</font></strong></p><h2 id="🚂-AS-–-别名"><a href="#🚂-AS-–-别名" class="headerlink" title="🚂 AS – 别名"></a>🚂 AS – 别名</h2><p>通过使用 SQL，可以为列名称和表名称指定别名（Alias），别名使查询程序更易阅读和书写。</p><p><strong><font color='orage'>语法：</font></strong></p><p><strong>表别名：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名称<span class="operator">/</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> 表名称 <span class="keyword">AS</span> 别名;</span><br></pre></td></tr></table></figure><p><strong>列别名：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名称 <span class="keyword">as</span> 别名 <span class="keyword">FROM</span> 表名称;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p><strong>使用表名称别名：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p.LastName, p.FirstName</span><br><span class="line"><span class="keyword">FROM</span> Persons p </span><br><span class="line"><span class="keyword">WHERE</span> p.LastName<span class="operator">=</span><span class="string">&#x27;Adams&#x27;</span> <span class="keyword">AND</span> p.FirstName<span class="operator">=</span><span class="string">&#x27;John&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/6b71f64d59f54db893012548217d61d5.png"></p><p><strong>使用列名别名：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LastName &quot;Family&quot;, FirstName &quot;Name&quot; <span class="keyword">FROM</span> Persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f4f1fc19cf584151b2b358a5aea07b40.png"></p><p><strong>📢 注意：</strong> 实际应用时，这个 <code>AS</code> 可以省略，但是列别名需要加上 <code>&quot; &quot;</code>。</p><h2 id="🚁-JOIN-–-多表关联"><a href="#🚁-JOIN-–-多表关联" class="headerlink" title="🚁 JOIN – 多表关联"></a>🚁 JOIN – 多表关联</h2><p><code>JOIN</code> 用于根据两个或多个表中的列之间的关系，从这些表中查询数据。</p><p>有时为了得到完整的结果，我们需要从两个或更多的表中获取结果。我们就需要执行 <code>join</code>。</p><p>数据库中的表可通过键将彼此联系起来。主键（Primary Key）是一个列，在这个列中的每一行的值都是唯一的。在表中，每个主键的值都是唯一的。这样做的目的是在不重复每个表中的所有数据的情况下，把表间的数据交叉捆绑在一起。</p><p><img src="https://img-blog.csdnimg.cn/74fcb74caa284bc1b4ec1a4adc088595.png"></p><p>如图，”Id_P” 列是 Persons 表中的的主键。这意味着没有两行能够拥有相同的 Id_P。即使两个人的姓名完全相同，Id_P 也可以区分他们。</p><p><strong>❤️ 为了下面实验的继续，我们需要再创建一个表：Orders。</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> orders (id_o number,orderno number,id_p number);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">11111</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">22222</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">33333</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">44444</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders <span class="keyword">values</span>(<span class="number">6</span>,<span class="number">66666</span>,<span class="number">6</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> orders;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/03cc7abc58a14fe3b68d0947eede15c4.png"></p><p>如图，”Id_O” 列是 Orders 表中的的主键，同时，”Orders” 表中的 “Id_P” 列用于引用 “Persons” 表中的人，而无需使用他们的确切姓名。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons p,orders o <span class="keyword">where</span> p.id_p<span class="operator">=</span>o.id_p;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c8c6b28a84b346479500110c56af0bd2.png"></p><p>可以看到，”Id_P” 列把上面的两个表联系了起来。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名</span><br><span class="line"><span class="keyword">from</span> 表A</span><br><span class="line"><span class="keyword">INNER</span><span class="operator">|</span><span class="keyword">LEFT</span><span class="operator">|</span><span class="keyword">RIGHT</span><span class="operator">|</span><span class="keyword">FULL</span> <span class="keyword">JOIN</span> 表B</span><br><span class="line"><span class="keyword">ON</span> 表A主键列 <span class="operator">=</span> 表B外键列;</span><br></pre></td></tr></table></figure><p><strong>不同的 SQL JOIN：</strong></p><p>下面列出了您可以使用的 JOIN 类型，以及它们之间的差异。</p><ul><li>JOIN: 如果表中有至少一个匹配，则返回行</li><li>INNER JOIN: 内部连接，返回两表中匹配的行</li><li>LEFT JOIN: 即使右表中没有匹配，也从左表返回所有的行</li><li>RIGHT JOIN: 即使左表中没有匹配，也从右表返回所有的行</li><li>FULL JOIN: 只要其中一个表中存在匹配，就返回行</li></ul><p><strong><font color='orage'>实例：</font></strong></p><p>如果我们希望列出所有人的定购，可以使用下面的 SELECT 语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p.LastName, p.FirstName, o.OrderNo</span><br><span class="line"><span class="keyword">FROM</span> Persons p</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Orders o</span><br><span class="line"><span class="keyword">ON</span> p.Id_P <span class="operator">=</span> o.Id_P</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> p.LastName <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9088a46c0bd645538112dd2447d5788f.png"></p><h2 id="🚜-UNION-–-合并结果集"><a href="#🚜-UNION-–-合并结果集" class="headerlink" title="🚜 UNION – 合并结果集"></a>🚜 UNION – 合并结果集</h2><p><code>UNION</code> 操作符用于合并两个或多个 SELECT 语句的结果集。</p><p><strong><font color='orage'>UNION 语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名 <span class="keyword">FROM</span> 表A</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> 列名 <span class="keyword">FROM</span> 表B;</span><br></pre></td></tr></table></figure><p><strong>📢注意：</strong> UNION 操作符默认为选取不同的值。如果查询结果需要显示重复的值，请使用 <code>UNION ALL</code>。</p><p><strong><font color='orage'>UNION ALL 语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名 <span class="keyword">FROM</span> 表A</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> 列名 <span class="keyword">FROM</span> 表B;</span><br></pre></td></tr></table></figure><p>另外，UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名。</p><p>为了实验所需，创建 Person_b 表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Persons_b</span><br><span class="line">(</span><br><span class="line">Id_P <span class="type">int</span>,</span><br><span class="line">LastName <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">FirstName <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">Address <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">City <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons_b <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Bill&#x27;</span>, <span class="string">&#x27;Gates&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Londo&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons_b <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Adams&#x27;</span>, <span class="string">&#x27;Oxford Street&#x27;</span>, <span class="string">&#x27;nBeijing&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons_b <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;George&#x27;</span>, <span class="string">&#x27;Bush&#x27;</span>, <span class="string">&#x27;Fifth Avenue&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons_b <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;Thomas&#x27;</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;Changan Street&#x27;</span>, <span class="string">&#x27;New York&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> Persons_b <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;William&#x27;</span>, <span class="string">&#x27;Carter&#x27;</span>, <span class="string">&#x27;Xuanwumen 10&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons_b;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a641fd651a6a4d9b83062a9588573fdf.png"></p><p><strong><font color='orage'>实例：</font></strong></p><p><strong>使用 UNION 命令：</strong></p><p>列出 persons 和 persons_b 中不同的人：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons_b;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/27b435cd45364edb936d7c3139859906.png"></p><p><strong>📢注意：</strong> UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</p><h2 id="🚌-NOT-NULL-–-非空"><a href="#🚌-NOT-NULL-–-非空" class="headerlink" title="🚌 NOT NULL – 非空"></a>🚌 NOT NULL – 非空</h2><p><code>NOT NULL</code> 约束强制列不接受 NULL 值。</p><p>NOT NULL 约束强制字段始终包含值。这意味着，如果不向字段添加值，就无法插入新记录或者更新记录。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表</span><br><span class="line">(</span><br><span class="line">列 <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>如上，创建一个表，设置列值不能为空。</p><p><strong><font color='orage'>实例：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> lucifer (id number <span class="keyword">not</span> <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> lucifer <span class="keyword">values</span> (<span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e46f02ac44a04292a9e7cd99760d60db.png"></p><p><strong>📢 注意：</strong> 如果插入 <code>NULL</code> 值，则会报错 <code>ORA-01400</code> 提示无法插入！</p><p><strong>⭐️ 拓展小知识：</strong><code>NOT NULL</code> 也可以用于查询条件：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons <span class="keyword">where</span> FirstName <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2eb63f8b3d3147efb474f9d5cafe9b84.png"></p><p>同理，<code>NULL</code> 也可：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons <span class="keyword">where</span> FirstName <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><p>感兴趣的朋友，可以自己尝试一下！</p><h2 id="🚐-VIEW-–-视图"><a href="#🚐-VIEW-–-视图" class="headerlink" title="🚐 VIEW – 视图"></a>🚐 VIEW – 视图</h2><p>在 SQL 中，视图是基于 SQL 语句的结果集的可视化的表。</p><p>视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> 视图名 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> 列名</span><br><span class="line"><span class="keyword">FROM</span> 表名</span><br><span class="line"><span class="keyword">WHERE</span> 查询条件;</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 视图总是显示最近的数据。每当用户查询视图时，数据库引擎通过使用 SQL 语句来重建数据。</p><p><strong><font color='orage'>实例：</font></strong></p><p>下面，我们将 Persons 表中住在 Beijing 的人筛选出来创建视图：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> persons_beijing <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons <span class="keyword">where</span> city<span class="operator">=</span><span class="string">&#x27;Beijing&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/ed8f1036aa77471e94b9924e0e14b14b.png"></p><p>查询上面这个视图：</p><p><img src="https://img-blog.csdnimg.cn/0a16cd59fb9b45789c7c68ddc4416592.png"></p><p>如果需要更新视图中的列或者其他信息，无需删除，使用 <code>CREATE OR REPLACE VIEW</code> 选项：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> 视图名 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> 列名</span><br><span class="line"><span class="keyword">FROM</span> 表名</span><br><span class="line"><span class="keyword">WHERE</span> 查询条件;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>现在需要筛选出，LASTNAME 为 Gates 的记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">view</span> persons_beijing <span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> persons <span class="keyword">where</span> lastname<span class="operator">=</span><span class="string">&#x27;Gates&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e3c1af27e95f4b24b020e245e06a4772.png"></p><p><img src="https://img-blog.csdnimg.cn/9740abcfb2374da3b913dc3c4b089a4d.png"></p><p>删除视图就比较简单，跟表差不多，使用 <code>DROP</code> 即可：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> persons_beijing;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d2bae67146ed45c0879125f6dec3a3f7.png"></p><p><strong>❤️ <font color='orage'>本章要讲的高级语言就先到此为止，不宜一次性介绍太多~</font></strong></p><h1 id="🎯-SQL-常用函数学习"><a href="#🎯-SQL-常用函数学习" class="headerlink" title="🎯 SQL 常用函数学习"></a>🎯 SQL 常用函数学习</h1><p>SQL 拥有很多可用于计数和计算的内建函数。</p><p><strong><font color='orage'>函数的使用语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">function</span>(列) <span class="keyword">FROM</span> 表;</span><br></pre></td></tr></table></figure><p><strong>❤️ 下面就来看看有哪些常用的函数！</strong></p><h2 id="🍔-AVG-–-平均值"><a href="#🍔-AVG-–-平均值" class="headerlink" title="🍔 AVG – 平均值"></a>🍔 AVG – 平均值</h2><p>AVG 函数返回数值列的平均值。NULL 值不包括在计算中。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(列名) <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>计算 “orderno” 字段的平均值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(orderno) <span class="keyword">from</span> orders;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/0ba1624010aa405b8c70f921a48996ce.png"></p><p>当然，也可以用在查询条件中，例如查询低于平均值的记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> orders <span class="keyword">where</span> orderno <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(orderno) <span class="keyword">from</span> orders);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/bc2680cf06734219b28b021208b05aa7.png"></p><h2 id="🍕-COUNT-–-汇总行数"><a href="#🍕-COUNT-–-汇总行数" class="headerlink" title="🍕 COUNT – 汇总行数"></a>🍕 COUNT – 汇总行数</h2><p>COUNT() 函数返回匹配指定条件的行数。</p><p><strong><font color='orage'>语法：</font></strong></p><p><code>count()</code> 中可以有不同的语法：</p><ul><li>COUNT(*) ：返回表中的记录数。</li><li>COUNT(DISTINCT 列名) ：返回指定列的不同值的数目。</li><li>COUNT(列名) ：返回指定列的值的数目（NULL 不计入）。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> 列名) <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(列名) <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure></li></ul><p><strong><font color='orage'>实例：</font></strong></p><p><strong>COUNT(*) ：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f1672ddf8b214063b41d96875f07340c.png"></p><p><strong>COUNT(DISTINCT 列名) ：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> city) <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/47691a8ae30e4d97a496269c18d87e6d.png"></p><p><strong>COUNT(列名) ：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(city) <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a296906be25649c6bd75377030f05bfc.png"></p><h2 id="🍘-MAX-–-最大值"><a href="#🍘-MAX-–-最大值" class="headerlink" title="🍘 MAX – 最大值"></a>🍘 MAX – 最大值</h2><p><code>MAX</code> 函数返回一列中的最大值。NULL 值不包括在计算中。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(列名) <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p>MIN 和 MAX 也可用于文本列，以获得按字母顺序排列的最高或最低值。</p><p><strong><font color='orage'>实例：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(orderno) <span class="keyword">from</span> orders;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e949393106d343f6bbb75c217732525f.png"></p><h2 id="🍢-MIN-–-最小值"><a href="#🍢-MIN-–-最小值" class="headerlink" title="🍢 MIN – 最小值"></a>🍢 MIN – 最小值</h2><p><code>MIN</code> 函数返回一列中的最小值。NULL 值不包括在计算中。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(列名) <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(orderno) <span class="keyword">from</span> orders;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e8e10ea1ce104fa8a217bd66f627d0c2.png"></p><h2 id="🍰-SUM-–-求和"><a href="#🍰-SUM-–-求和" class="headerlink" title="🍰 SUM – 求和"></a>🍰 SUM – 求和</h2><p><code>SUM</code> 函数返回数值列的总数（总额）。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(列名) <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(orderno) <span class="keyword">from</span> orders;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c94d6c638a694c11be62b767386fac98.png"></p><h2 id="🍪-GROUP-BY-–-分组"><a href="#🍪-GROUP-BY-–-分组" class="headerlink" title="🍪 GROUP BY – 分组"></a>🍪 GROUP BY – 分组</h2><p>GROUP BY 语句用于结合合计函数，根据一个或多个列对结果集进行分组。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名A, 统计函数(列名B)</span><br><span class="line"><span class="keyword">FROM</span> 表名</span><br><span class="line"><span class="keyword">WHERE</span> 查询条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 列名A;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>获取 Persons 表中住在北京的总人数，根据 LASTNAME 分组：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> lastname,<span class="built_in">count</span>(city) <span class="keyword">from</span> persons </span><br><span class="line"><span class="keyword">where</span> city<span class="operator">=</span><span class="string">&#x27;Beijing&#x27;</span> </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> lastname;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/af82cd53c365445fa0717d9585dfa2b6.png"></p><p>如果不加 <code>GROUP BY </code> 则会报错：</p><p><img src="https://img-blog.csdnimg.cn/bb8a710b709c4e8db0002216c866435a.png"></p><p>也就是常见的 <code>ORA-00937</code> 不是单组分组函数的错误。</p><h2 id="🍭-HAVING-–-句尾连接"><a href="#🍭-HAVING-–-句尾连接" class="headerlink" title="🍭 HAVING – 句尾连接"></a>🍭 HAVING – 句尾连接</h2><p>在 SQL 中增加 HAVING 子句原因是，WHERE 关键字无法与合计函数一起使用。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名A, 统计函数(列名B)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> 查询条件</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> 列名A</span><br><span class="line"><span class="keyword">HAVING</span> 统计函数(列名B) 查询条件;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>获取 Persons 表中住在北京的总人数大于1的 LASTNAME，根据 LASTNAME 分组：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> lastname,<span class="built_in">count</span>(city) <span class="keyword">from</span> persons </span><br><span class="line"><span class="keyword">where</span> city<span class="operator">=</span><span class="string">&#x27;Beijing&#x27;</span> </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> lastname</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(city) <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/06e650fa97bb4db793eb387fae2a2e77.png"></p><h2 id="🍷-UCASE-x2F-UPPER-–-大写"><a href="#🍷-UCASE-x2F-UPPER-–-大写" class="headerlink" title="🍷 UCASE&#x2F;UPPER – 大写"></a>🍷 UCASE&#x2F;UPPER – 大写</h2><p><code>UCASE/UPPER</code> 函数把字段的值转换为大写。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>选取 “LastName” 和 “FirstName” 列的内容，然后把 “LastName” 列转换为大写：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">upper</span>(lastname),firstname <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/ebe6b301f2e741d1b517ad80c858b293.png"></p><h2 id="🍶-LCASE-x2F-LOWER-–-小写"><a href="#🍶-LCASE-x2F-LOWER-–-小写" class="headerlink" title="🍶 LCASE&#x2F;LOWER – 小写"></a>🍶 LCASE&#x2F;LOWER – 小写</h2><p><code>LCASE/LOWER</code> 函数把字段的值转换为小写。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>选取 “LastName” 和 “FirstName” 列的内容，然后把 “LastName” 列转换为小写：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">lower</span>(lastname),firstname <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/5b55a6fbb96e403f98ba918d34e23bd9.png"></p><h2 id="👛-LEN-x2F-LENGTH-–-获取长度"><a href="#👛-LEN-x2F-LENGTH-–-获取长度" class="headerlink" title="👛 LEN&#x2F;LENGTH – 获取长度"></a>👛 LEN&#x2F;LENGTH – 获取长度</h2><p><code>LEN/LENGTH</code> 函数返回文本字段中值的长度。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> length(列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>获取 LASTNAME 的值字符长度：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> length(lastname),lastname <span class="keyword">from</span> persons;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/f619855ec4d6452fb1df41c6bf85cdd8.png"></p><h2 id="🍗-ROUND-–-数值取舍"><a href="#🍗-ROUND-–-数值取舍" class="headerlink" title="🍗 ROUND – 数值取舍"></a>🍗 ROUND – 数值取舍</h2><p><code>ROUND</code> 函数用于把数值字段舍入为指定的小数位数。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> round(列名,精度) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p><strong>保留2位：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> round(<span class="number">1.1314</span>,<span class="number">2</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> round(<span class="number">1.1351</span>,<span class="number">2</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/a1d05954be9b4f60982fa69d268d305b.png"></p><p><img src="https://img-blog.csdnimg.cn/aaf26b400823433a825501ed97c68d72.png"></p><p>📢 注意：<code>ROUND</code> 取舍是 <strong>四舍五入</strong> 的！</p><p><strong>取整：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> round(<span class="number">1.1351</span>,<span class="number">0</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">select</span> round(<span class="number">1.56</span>,<span class="number">0</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/9985ab017b784a36a1f7e60e3c8e19ce.png"></p><h2 id="🍞-NOW-x2F-SYSDATE-–-当前时间"><a href="#🍞-NOW-x2F-SYSDATE-–-当前时间" class="headerlink" title="🍞 NOW&#x2F;SYSDATE – 当前时间"></a>🍞 NOW&#x2F;SYSDATE – 当前时间</h2><p><code>NOW/SYSDATE</code> 函数返回当前的日期和时间。</p><p><strong><font color='orage'>语法：</font></strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sysdate <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong><font color='orage'>实例：</font></strong></p><p>获取当前时间：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sysdate <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/27ad5f3cacdc4fc98557c813b78697e3.png"></p><p><strong>📢 注意：</strong> 如果您在使用 Sql Server 数据库，请使用 <code>getdate()</code> 函数来获得当前的日期时间。</p><h1 id="🍺-写在最后"><a href="#🍺-写在最后" class="headerlink" title="🍺 写在最后"></a>🍺 写在最后</h1><p>上述如果都学完了的话，可以来做个小测验：<a href="https://www.w3school.com.cn/quiz/quiz.asp?quiz=sql">SQL 测验</a>，看看掌握的怎么样！<br><a id="jump_100"></a><br><strong>❤️ 测验会被记分：</strong></p><p>每道题的分值是 1 分。在您完成全部的20道题之后，系统会为您的测验打分，并提供您做错的题目的正确答案。其中，绿色为正确答案，而红色为错误答案。</p><p><strong>☞ <a href="https://www.w3school.com.cn/quiz/quiz.asp?quiz=sql">现在就开始测验！</a></strong> 祝您好运。</p>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redhat 7 安装 Oracle 12CR2 RAC 完全避坑宝典</title>
      <link href="/post/261c23fa.html"/>
      <url>/post/261c23fa.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>相信在 Redhat 7 上安装过 <code>Oracle 12CR2 RAC</code> 的朋友，看了本文一定会后悔没有早点看到这篇完美的避坑指南！</p><p>😜 如果有朋友不信邪，可以按照常规的方式安装，大概率是会遇到下面我列出的这些坑。</p><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h1 id="一、聊聊哪些坑"><a href="#一、聊聊哪些坑" class="headerlink" title="一、聊聊哪些坑"></a>一、聊聊哪些坑</h1><p>本文主要介绍 <code>Redhat 7.6</code> 系统安装 <code>Oracle 12201</code> 版本 <code>RAC</code> 的一些坑以及避坑方式。</p><p>绝对干货满满，物超所值，当然更欢迎大家来补充和纠错！</p><blockquote><p><strong>📢 注意：</strong> 坑点主要位于 Grid 软件安装步骤中 <code>cvu check</code> 和 <code>root.sh</code> 执行。</p></blockquote><h2 id="坑-1：ASM-device-sharedness-check"><a href="#坑-1：ASM-device-sharedness-check" class="headerlink" title="坑 1：ASM device sharedness check"></a>坑 1：ASM device sharedness check</h2><p>Grid 软件安装过程检查报错：Shared Storage Accessibility:&#x2F;dev&#x2F;asm_ocr …FAILED (PRVG-11506)</p><p><img src="https://img-blog.csdnimg.cn/7b60914c28444d4e94d952299448a3f1.png"></p><p>可参照 <code>MOS</code> 文档：</p><ul><li>12.2: PRVG-0802 : Storage type for path “&#x2F;dev&#x2F;mapper&#x2F;asm011p1” could not be determined (Doc ID 2251322.1)</li></ul><p>这里先卖个关子，不说解决方案，MOS 建议是打一个补丁 25784424 来修复：</p><blockquote><p><strong>Apply patch <a href="https://support.oracle.com/epmos/faces/ui/patch/PatchDetail.jspx?parent=DOCUMENT&sourceId=2251322.1&patchId=25784424">25784424</a>, if CVU storage check fails for ASMLib paths 。</strong></p></blockquote><h2 id="坑-2：执行-root-sh-报错"><a href="#坑-2：执行-root-sh-报错" class="headerlink" title="坑 2：执行 root.sh 报错"></a>坑 2：执行 root.sh 报错</h2><p><strong><font color='red'>😤 先吐槽一下，这 TM 简直巨坑无比！</font></strong></p><p>当执行 <code>root.sh</code> 命令到进度 14&#x2F;19 时，突然停止并且报错 <code>CLSRSC-400</code>，并提示重启主机系统，重启之后安装进程已经终止，继续执行依然报错，无奈卸载重装，结果依然报错，<font color='orage'><b>当时搞了将近 3 个多小时</b></font>，网上找遍了都没发现相关问题，<b>真是一把心酸泪 😢</b>！</p><p><img src="https://img-blog.csdnimg.cn/ce3b6101cabd40dd904a7199cd2968ec.png"></p><p>在 <code>MOS</code> 上找了个相关文档，但没解决问题，可以参考一下：</p><ul><li>ALERT: root.sh Fails With “CLSRSC-400” While Installing GI 12.2.0.1 on RHEL or OL with RedHat Compatible Kernel (RHCK) 7.3 (Doc ID 2284463.1)</li></ul><p><code>MOS</code> 建议仍然是通过 <code>applyOneOffs</code> 打补丁来修复：</p><blockquote><p><strong>Interim patch 25078431 is required before installing 12.2 GI on Linux 7.3 (RedHat and OL7 with RHCK).</strong></p></blockquote><p><strong>📢 注意：</strong> 这里虽然没有帮助我解决问题，但是帮我打开了一个思路，让我想到了 12C 开始支持的新的打补丁方式 <code>applyPSU</code>，对我后面解决问题带来了很大的帮助！</p><h2 id="坑-3：ASMCMD-报错"><a href="#坑-3：ASMCMD-报错" class="headerlink" title="坑 3：ASMCMD 报错"></a>坑 3：ASMCMD 报错</h2><p>在修复了上述 2 个问题之后，😀 我又高高兴兴的开始执行 <code>root.sh</code>，看着一路畅通无阻，本想着收拾收拾回家了。</p><p>结果 <code>root.sh</code> 执行到进度 <code>19/19</code> 时，突然报错停止，报错内容为：kgfnGetConnDetails requires 4 parameters at&#x2F;u01&#x2F;app&#x2F;12.2.0&#x2F;grid&#x2F;lib&#x2F;asmcmdbase.pm line 5704，显示 <code>root.sh</code> 执行失败。</p><p><img src="https://img-blog.csdnimg.cn/7fff740d41ad4613a859184eb27a266e.png"></p><p>此时，我不认命的觉得它安装成功，去试了下 <code>asmcmd</code> 命令，我直接裂开了 😵！</p><p><img src="https://img-blog.csdnimg.cn/144e5423ed5d44d3920fc6934a8f8815.png"></p><p>好吧，放下书包，看报错日志，然后 <code>MOS</code> 一通发现了下面这些文档，以供参考：</p><ul><li>install.sh Hung And root.sh Is Failing At asmcmd lsdg –suppressheader While Installing A Zone With Clusterware (Doc ID 2414241.1)</li><li>ASMCMD Failing With “KGFNGETCONNDETAILS Requires 4 Parameters at <GI_HOME>&#x2F;lib&#x2F;asmcmdbase.pm (Doc ID 2748316.1)</li></ul><p>这个问题还算简单，但是还要卸载重装一遍，最后经过九九八一难，使出九牛二虎之力，终于把 Grid 软件安装成功了，后面 Oracle 软件安装和建库都尤为顺利。</p><h1 id="二、说说如何避坑"><a href="#二、说说如何避坑" class="headerlink" title="二、说说如何避坑"></a>二、说说如何避坑</h1><p>聊完了有哪些坑，下面当然要说说怎么避开了！</p><h2 id="applyPSU"><a href="#applyPSU" class="headerlink" title="applyPSU"></a>applyPSU</h2><p>之前坑 2 有个 MOS 说要使用 <code>applyOneOffs</code> 打补丁来修复，于是就去搜了一下这个参数的用法，发现可以在 <code>Grid</code> 软件安装前打上补丁，顺带着还发现了 <code>applyPSU</code>，感觉找到了出路！</p><p>当时我使用 MOS 的方式进行单个补丁修复，结果一个又一个，感觉没完了一样，后来转念一想，<code>PSU</code> 季度补丁是包含之前的 BUG 修复补丁的，直接使用 <code>applyPSU</code> 提前打上季度补丁来进行修复，就没那么多问题，值得一试！</p><ul><li>How to Apply a Grid Infrastructure Patch Before Grid Infrastructure Configuration (before root.sh or rootupgrade.sh or gridsetup.bat) is Executed (Doc ID 1410202.1)</li></ul><p>参考上述 MOS 文档，有详细的介绍和使用方法。</p><h2 id="修复坑1、2"><a href="#修复坑1、2" class="headerlink" title="修复坑1、2"></a>修复坑1、2</h2><p>通过 <code>12C</code> 开始支持的 <code>applyPSU</code> 方式，提前给 <code>Grid</code> 软件打上最新的季度 <code>PSU</code> 补丁，修复坑 1，2 的 <code>BUG</code>：</p><p><strong>1、解压 OPatch 补丁包</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## grid 用户下执行解压，覆盖 OPatch 旧版本</span></span><br><span class="line">unzip -o /soft/p6880880_122010_Linux-x86-64.zip -d /u01/app/12.2.0/grid/</span><br></pre></td></tr></table></figure><p><strong>2、查看 OPatch 补丁包版本</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## grid 用户下执行</span></span><br><span class="line">/u01/app/12.2.0/grid/OPatch/opatch version</span><br><span class="line"></span><br><span class="line">OPatch Version: 12.2.0.1.24</span><br></pre></td></tr></table></figure><p><strong>3、解压最新 PSU 补丁</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## grid 用户下执行</span></span><br><span class="line">unzip /soft/p32226491_122010_Linux-x86-64.zip -d /soft</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 由于本文是在 2021年1月份写的，所以补丁包版本非最新，请下载当前最新的 PSU 补丁包！</p><p><strong>4、执行 Grid 软件安装</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## grid 用户下执行</span></span><br><span class="line">./gridSetup.sh -applyPSU /soft/32226491</span><br><span class="line"></span><br><span class="line">Preparing the home to patch...</span><br><span class="line">Applying the patch /soft/32226491/...</span><br><span class="line">Successfully applied the patch.</span><br><span class="line">The <span class="built_in">log</span> can be found at: /u01/app/oraInventory/logs/GridSetupActions2021-04-01_04-18-54PM/installerPatchActions_2021-04-01_04-18-54PM.log</span><br><span class="line">Launching Oracle Grid Infrastructure Setup Wizard...</span><br></pre></td></tr></table></figure><p>通过上述命令执行结果，可以看到成功安装了 PSU 补丁后才开始安装 Grid 软件！</p><p><strong>📢 注意：</strong> 当通过上述方式提前安装了 PSU 补丁后，后面简直可以说是一帆风顺，直到执行 root.sh 到最后一步，遇到了坑 3。</p><h2 id="修复坑-3"><a href="#修复坑-3" class="headerlink" title="修复坑 3"></a>修复坑 3</h2><p>这个问题很简单，只需要执行一行命令即可，但是要注意执行命令的时机。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 在 root 用户下执行，需要提前配置 grid 软件的 ORACLE_HOME 环境变量</span></span><br><span class="line">/usr/bin/make -f <span class="variable">$ORACLE_HOME</span>/rdbms/lib/ins_rdbms.mk client_sharedlib libasmclntsh12.ohso libasmperl12.ohso ORACLE_HOME=<span class="variable">$ORACLE_HOME</span></span><br></pre></td></tr></table></figure><p><strong>执行顺序：</strong></p><p>当 Grid 软件安装 <font color='orage'><b>执行到出现 <code>root.sh</code> 提示框时</b></font>，执行以上命令，📢 需在两个节点以<code>root</code> 身份执行该命令，<code>ORACLE_HOME</code> 路径请根据实际情况填写！确保所有节点执行完之后，再执行 <code>root.sh</code>，就可以完美修复坑 3。</p><p><strong>接下来，就是顺风顺水，常规安装步骤了！不过，有 19C 了谁还用 12C 呢？😎</strong></p><h1 id="三、知识拓展"><a href="#三、知识拓展" class="headerlink" title="三、知识拓展"></a>三、知识拓展</h1><p>咱们上面讲的几个坑，说白了都是 <code>BUG</code>，解决方案都是通过补丁来修复。事后我就在想，<strong>官方为什么不在安装之前先把补丁都打上呢？<font color='orage'>这样不就可以避免这些 BUG 报错嘛！</font></strong></p><p><strong>于是，我在试着整了一版打好 PSU 的 12C GRID 安装包，下面介绍一下如何操作！</strong></p><h2 id="1、实现依据"><a href="#1、实现依据" class="headerlink" title="1、实现依据"></a>1、实现依据</h2><p>通过以下👇🏻 两个参数可以将基础安装包和补丁包进行集成打包。</p><ul><li>Oracle 12C开始支持Grid安装前安装PSU补丁：-applyPSU</li><li>Oracle 18C&#x2F;19C支持Grid&#x2F;Oracle安装前安装RU补丁：-applyRU</li></ul><p><strong>集成目的：</strong> 安装时可以省去安装补丁的步骤，直接解压集成安装包安装即可！</p><h2 id="2、实现方式"><a href="#2、实现方式" class="headerlink" title="2、实现方式"></a>2、实现方式</h2><p>以下举例 <code>12CR2 Grid</code> 集成补丁包 <code>32540149</code> 步骤：</p><p><strong>1、上传安装介质</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##Grid基础安装包</span></span><br><span class="line">LINUX.X64_122010_grid_home.zip</span><br><span class="line"><span class="comment">##OPatch补丁包</span></span><br><span class="line">p6880880_122010_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##PSU补丁包</span></span><br><span class="line">p32540149_122010_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##Oracle一键配置脚本</span></span><br><span class="line">OracleShellInstall.sh</span><br></pre></td></tr></table></figure><p><strong>2、配置主机环境</strong></p><p>使用我编写的 Oracle 一键安装脚本进行环境配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./OracleShellInstall.sh -i 10.211.55.100 `<span class="comment">#Public ip`\</span></span><br><span class="line">-n restart `<span class="comment"># hostname`\</span></span><br><span class="line">-o nocdb `<span class="comment"># oraclesid`\</span></span><br><span class="line">-gp oracle `<span class="comment"># grid user password`\</span></span><br><span class="line">-op oracle `<span class="comment"># oracle user password`\</span></span><br><span class="line">-b /oracle/app `<span class="comment"># install basedir`\</span></span><br><span class="line">-s AL32UTF8 `<span class="comment"># characterset`\</span></span><br><span class="line">-m Y</span><br></pre></td></tr></table></figure><p><strong>​3、安装补丁</strong></p><p>分别解压 <code>OPatch</code> 补丁包和 <code>PSU</code> 补丁包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##解压更新OPatch包</span></span><br><span class="line">unzip -o p6880880_122010_Linux-x86-64.zip -d /oracle/app/12.2.0/grid</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /oracle/app/12.2.0/grid/OPatch</span><br><span class="line"></span><br><span class="line"><span class="comment">##解压PSU补丁包</span></span><br><span class="line">unzip p32540149_122010_Linux-x86-64.zip /soft</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft/32540149</span><br></pre></td></tr></table></figure><p>Grid 安装好补丁，但是不执行安装过程：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">su - grid -c <span class="string">&quot;/oracle/app/12.2.0/grid/gridSetup.sh -applyPSU /soft/32540149&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装成功后</span></span><br><span class="line"><span class="comment">## 1.修复bug：</span></span><br><span class="line"><span class="comment">## [INS-42505] The installer has detected that the Oracle Grid Infrastructure home software at (/oracle/GRID/12201) is not complete. (Doc ID 2697235.1)</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$ORACLE_HOME</span>/install/files.lst <span class="variable">$ORACLE_HOME</span>/install/files.lst.bak</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/6e63a2a37d8747489bcd050a575fcf21.png"></p><p><strong>📢 注意：</strong> 上面遇到这个小 BUG，也可以无视，没有什么大影响。</p><p><strong>4、压缩 ORACLE_HOME 目录</strong></p><p>这里我将安装好的 Grid ORACLE_HOME 压缩打包成 <code>zip</code> 安装包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /oracle/app/12.2.0/grid/</span><br><span class="line">zip -r LINUX.X64_122010_grid_home_32540149.zip *</span><br><span class="line"><span class="built_in">mv</span> LINUX.X64_122010_grid_home_32540149.zip /soft</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/4539b02f4b174f95b7081ade147028e9.png"></p><p><strong><font color='orage'>至此，基础安装包和补丁包集成成功。</font></strong></p><h2 id="3、安装测试"><a href="#3、安装测试" class="headerlink" title="3、安装测试"></a>3、安装测试</h2><p>这里我们打开一台新的主机进行安装测试。</p><p><strong>1、上传集成安装包等介质</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##Grid集成安装包</span></span><br><span class="line">LINUX.X64_122010_grid_home_32540149.zip</span><br><span class="line"><span class="comment">##Oracle一键配置脚本</span></span><br><span class="line">OracleShellInstall.sh</span><br></pre></td></tr></table></figure><p><strong>2、主机环境初始化配置</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##iscsi挂载共享盘</span></span><br><span class="line">iscsiadm -m discovery -t st -p 10.211.55.22</span><br><span class="line">iscsiadm -m node -T iqn.2008-08.com.starwindsoftware:10.211.55.22-lucifer -p 10.211.55.22 -l</span><br><span class="line"></span><br><span class="line"><span class="comment">##重命名安装包</span></span><br><span class="line"><span class="built_in">mv</span> LINUX.X64_122010_grid_home_32540149.zip LINUX.X64_122010_grid_home.zip</span><br><span class="line"></span><br><span class="line"><span class="comment">##执行脚本初始化配置</span></span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">./OracleShellInstall.sh -i 10.211.55.100 `<span class="comment">#Public ip`\</span></span><br><span class="line">-n restart `<span class="comment"># hostname`\</span></span><br><span class="line">-o nocdb `<span class="comment"># oraclesid`\</span></span><br><span class="line">-gp oracle `<span class="comment"># grid user password`\</span></span><br><span class="line">-op oracle `<span class="comment"># oracle user password`\</span></span><br><span class="line">-b /u01/app `<span class="comment"># install basedir`\</span></span><br><span class="line">-s AL32UTF8 `<span class="comment"># characterset`\</span></span><br><span class="line">-<span class="built_in">dd</span> /dev/sdc `<span class="comment"># asm data disk`\</span></span><br><span class="line">-dn DATA `<span class="comment"># asm data diskgroupname`\</span></span><br><span class="line">-dr EXTERNAL `<span class="comment"># asm data redundancy`\</span></span><br><span class="line">-m Y</span><br></pre></td></tr></table></figure><p><strong>3、安装 Grid 软件</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">su - grid</span><br><span class="line"><span class="built_in">cd</span> /oracle/app/12.2.0/grid/</span><br><span class="line">./gridSetup.sh</span><br></pre></td></tr></table></figure><p>执行 <code>root.sh</code> 前执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 2.修复bug:ASMCMD Failing With &quot;KGFNGETCONNDETAILS Requires 4 Parameters at &lt;GI_HOME&gt;/lib/asmcmdbase.pm (Doc ID 2748316.1)</span></span><br><span class="line"><span class="built_in">export</span> ORACLE_HOME=/u01/app/12.2.0/grid</span><br><span class="line">/usr/bin/make -f <span class="variable">$ORACLE_HOME</span>/rdbms/lib/ins_rdbms.mk client_sharedlib libasmclntsh12.ohso libasmperl12.ohso ORACLE_HOME=<span class="variable">$ORACLE_HOME</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/e1107cd86032427f85a33fc0594b8518.png"></p><p>顺利安装完毕！虽然实际用处不大，也算是一个思路吧，可以节省一些时间。</p><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>Oracle 学习路漫漫，茫茫文档需要看，直觉前路要变宽，到头还被 BUG 绊！😂</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> Linux </category>
          
          <category> RAC </category>
          
          <category> 12C </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Oracle </tag>
            
            <tag> RAC </tag>
            
            <tag> 12C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一步步教你 Linux 7 安装 Oracle 11GR2 RAC</title>
      <link href="/post/1ae1443c.html"/>
      <url>/post/1ae1443c.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong><font color='orage'>Oracle RAC是什么?</font></strong></p><ul><li>Oracle Real Application Clusters (RAC) 允许客户跨多台服务器运行单个 Oracle 数据库，以最大限度地提高可用性并实现水平可扩展性，同时访问共享存储。</li><li>连接到 Oracle RAC 实例的用户会话可以在中断期间进行故障转移并安全地重放更改，而无需对最终用户应用程序进行任何更改，从而对最终用户隐藏了中断的影响。</li></ul><p><img src="https://img-blog.csdnimg.cn/20210612235829184.png"></p><ul><li>Oracle RAC 运行于集群之上，为 Oracle 数据库提供了最高级别的可用性、可伸缩性和低成本计算能力。</li><li>如果集群内的一个节点发生故障，Oracle 将可以继续在其余的节点上运行。</li><li>Oracle 的主要创新是一项称为高速缓存合并的技术。</li><li>高速缓存合并使得集群中的节点可以通过高速集群互联高效地同步其内存高速缓存，从而最大限度地低降低磁盘 I&#x2F;O。</li><li>高速缓存最重要的优势在于它能够使集群中所有节点的磁盘共享对所有数据的访问,数据无需在节点间进行分区。</li></ul><p><strong><font color='orage'>特点：</font></strong></p><ul><li>多台互连计算机组成，使用共享存储。</li><li>用户无感知，对于最终用户和应用程序而言，它们似乎是一台服务器。</li><li>高可用，只要有一个节点存活，就能正常对外提供服务，避免单点故障。</li><li>高性能，多节点负载均衡。</li><li>易伸缩，可以容易地添加、删除节点，以满足系统自身的调整。</li></ul><p><strong><font color='blue'>那么，如何部署一套RAC数据库环境呢？</font></strong></p><p><strong>大致步骤如下：</strong></p><ul><li>安装两台redhat7.3版本Linux系统（物理内存至少2G）</li><li>网络配置（双网卡，准备IP：Public IP，Virtual IP，Private IP，Scan IP）</li><li>存储配置（6块5G共享盘做ASM盘，根目录留50G用于安装grid和oracle）</li><li>预安装准备（系统参数&#x2F;etc&#x2F;sysctl.conf修改，防火墙selinux关闭，ntpd时钟定时同步，yum源配置安装<br>用户组及用户、目录新建，环境变量配置，用户资源限制&#x2F;etc&#x2F;security&#x2F;limits.conf配置，&#x2F;etc&#x2F;pam.d&#x2F;login修改pam_limits.so等等）</li><li>安装Grid软件</li><li>安装Oracle软件并建库</li><li>修改数据库内存配置，密码不过期，开启归档，布置归档定时删除脚本，布置rman备份机制)</li></ul><p><img src="https://img-blog.csdnimg.cn/20210613001253755.png"></p><div class="note success flat"><p>Oracle一键安装可以跳转：<a href="https://luciferlpc.top/post/54c2aceb.html">Oracle 数据库一键安装，从未如此简单</a></p></div><h1 id="安装前配置"><a href="#安装前配置" class="headerlink" title="安装前配置"></a>安装前配置</h1><p>本文主机配置为 <code>Redhat 7.3 x86_64</code>，<code>内存2G</code>，<code>硬盘100G</code> ，<code>双网卡</code> ，<code>iscsi共享存储盘5G*6</code>！</p><table><thead><tr><th>节点</th><th>主机版本</th><th>主机名</th><th>实例名</th><th>Oracle版本</th><th>Public IP</th><th>Private IP</th><th>Virtual IP</th><th>Scan IP</th></tr></thead><tbody><tr><td>节点一</td><td>redhat 7.3</td><td>rac01</td><td>orcl1</td><td>11.2.0.4</td><td>192.168.56.10</td><td>172.0.0.1</td><td>192.168.56.20</td><td>192.168.56.110</td></tr><tr><td>节点二</td><td>redhat 7.3</td><td>rac02</td><td>orcl2</td><td>11.2.0.4</td><td>192.168.56.11</td><td>172.0.0.2</td><td>192.168.56.21</td><td>192.168.56.110</td></tr></tbody></table><p><strong>注意：</strong> 以下标题中（rac01&amp;rac02）代表节点一和节点二都需要执行，（rac01）代表只需要节点一执行。</p><h2 id="Linux主机安装（rac01-amp-rac02）"><a href="#Linux主机安装（rac01-amp-rac02）" class="headerlink" title="Linux主机安装（rac01&amp;rac02）"></a>Linux主机安装（rac01&amp;rac02）</h2><p>安装 Linux 服务器可选择：Centos，Redhat，Oracle Linux。</p><ul><li>RedHat下载：<a href="https://developers.redhat.com/products/rhel/download">https://developers.redhat.com/products/rhel/download</a></li><li>OracleLinux下载：<a href="https://yum.oracle.com/oracle-linux-isos.html">https://yum.oracle.com/oracle-linux-isos.html</a></li><li>Centos下载：<a href="https://vault.centos.org/">https://vault.centos.org/</a></li></ul><p><strong>📢 注意：</strong> 上述 <strong>Linux 安装包</strong> 和 <strong>Oracle 安装包</strong> 可点击链接跳转获取：</p><p><strong><code>Linux 安装包</code>：</strong> <a href="https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA">https://mp.weixin.qq.com/s/vqhPRNwSeiaTsiWHo0GKVA</a></p><p><strong><code>Oracle 安装包</code>：</strong> <a href="https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw">https://mp.weixin.qq.com/s/NLsI_sRLFGRQhi6r1yD9sw</a></p><p><img src="https://img-blog.csdnimg.cn/20210613002936736.png"></p><p><strong>📢 注意：</strong> Linux 系统的安装本文不做详细演示！</p><h2 id="配置-yum-源并安装依赖包（rac01-amp-rac02）"><a href="#配置-yum-源并安装依赖包（rac01-amp-rac02）" class="headerlink" title="配置 yum 源并安装依赖包（rac01&amp;rac02）"></a>配置 yum 源并安装依赖包（rac01&amp;rac02）</h2><p>Linux远程连接工具：</p><ul><li>本文将使用 XShell 和 Xftp 工具，安装包可以在官网下载。</li><li>其他工具也可以，比如：putty，SecureCRT 等等工具。</li></ul><p>Parallels Desktop挂载Linux主机镜像：</p><p><img src="https://img-blog.csdnimg.cn/20210613010127147.png"></p><p>VMware Workstation挂载Linux镜像：</p><p><img src="https://img-blog.csdnimg.cn/20210613010232723.png"></p><p><strong>注意：</strong> 需要提前挂载系统镜像。</p><p>挂载镜像源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt</span><br><span class="line"><span class="comment">##配置yum源</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/yum.repos.d/local.repo</span></span><br><span class="line"><span class="string">[local]</span></span><br><span class="line"><span class="string">name=local</span></span><br><span class="line"><span class="string">baseurl=file:///mnt</span></span><br><span class="line"><span class="string">gpgcheck=0</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>安装依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">yum groupinstall -y <span class="string">&quot;Server with GUI&quot;</span></span><br><span class="line">yum install -y bc \</span><br><span class="line">binutils \</span><br><span class="line">compat-libcap1 \</span><br><span class="line">compat-libstdc++-33 \</span><br><span class="line">gcc \</span><br><span class="line">gcc-c++ \</span><br><span class="line">elfutils-libelf \</span><br><span class="line">elfutils-libelf-devel \</span><br><span class="line">glibc \</span><br><span class="line">glibc-devel \</span><br><span class="line">ksh \</span><br><span class="line">libaio \</span><br><span class="line">libaio-devel \</span><br><span class="line">libgcc \</span><br><span class="line">libstdc++ \</span><br><span class="line">libstdc++-devel \</span><br><span class="line">libxcb \</span><br><span class="line">libX11 \</span><br><span class="line">libXau \</span><br><span class="line">libXi \</span><br><span class="line">libXtst \</span><br><span class="line">libXrender \</span><br><span class="line">libXrender-devel \</span><br><span class="line">make \</span><br><span class="line">net-tools \</span><br><span class="line">nfs-utils \</span><br><span class="line">smartmontools \</span><br><span class="line">sysstat \</span><br><span class="line">e2fsprogs \</span><br><span class="line">e2fsprogs-libs \</span><br><span class="line">fontconfig-devel \</span><br><span class="line">expect \</span><br><span class="line">unzip \</span><br><span class="line">openssh-clients \</span><br><span class="line">readline* \</span><br><span class="line">tigervnc* \</span><br><span class="line">psmisc --skip-broken</span><br></pre></td></tr></table></figure><p>手动上传并安装依赖包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh compat-libstdc++-33-3.2.3-72.el7.x86_64.rpm</span><br><span class="line">rpm -e ksh-20120801-142.el7.x86_64</span><br><span class="line">rpm -ivh pdksh-5.2.14-37.el5.x86_64.rpm</span><br></pre></td></tr></table></figure><p>检查依赖包安装情况：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q bc binutils compat-libcap1 compat-libstdc++-33 gcc gcc-c++ elfutils-libelf elfutils-libelf-devel glibc glibc-devel ksh libaio libaio-devel libgcc libstdc++ libstdc++-devel libxcb libX11 libXau libXi libXtst libXrender libXrender-devel make net-tools nfs-utils smartmontools sysstat e2fsprogs e2fsprogs-libs fontconfig-devel expect unzip openssh-clients readline | grep <span class="string">&quot;not installed&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613014702237.png"></p><p>确保依赖包均已成功安装！</p><h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><p>Linux 7 版本可以使用 <code>nmcli</code> 命令来配置网络，以下命令中的 <strong>IP地址、子网掩码、网关</strong> 和 <strong>网卡名称</strong> 请根据实际情况进行修改！</p><p><strong>rac01：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置Public IP</span></span><br><span class="line">nmcli connection modify eth0 ipv4.addresses 192.168.56.10/24 ipv4.gateway 192.168.56.1 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##配置Private IP</span></span><br><span class="line">nmcli connection modify eth1 ipv4.addresses 172.0.0.1/24 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##生效</span></span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli connection up eth1</span><br></pre></td></tr></table></figure><p><strong>rac02：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置Public IP</span></span><br><span class="line">nmcli connection modify eth0 ipv4.addresses 192.168.56.11/24 ipv4.gateway 192.168.56.1 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##配置Private IP</span></span><br><span class="line">nmcli connection modify eth1 ipv4.addresses 172.0.0.2/24 ipv4.method manual autoconnect <span class="built_in">yes</span></span><br><span class="line"><span class="comment">##生效</span></span><br><span class="line">nmcli connection up eth0</span><br><span class="line">nmcli connection up eth1</span><br></pre></td></tr></table></figure><p>最后，配置好网络后，输入命令 <code>ip a</code> 查看网络是否配置成功，尝试 <code>ping</code> 测试网络。</p><h2 id="存储配置（rac01-amp-rac02）"><a href="#存储配置（rac01-amp-rac02）" class="headerlink" title="存储配置（rac01&amp;rac02）"></a>存储配置（rac01&amp;rac02）</h2><p><strong><font color='orage'>Windows 下配置 ISCSI 共享存储可参考： </font> <a href="http://luciferlpc.top/post/b153d9c4.html">一步步教你Windows配置ISCSI共享存储</a></strong></p><p>配置好共享存储后，在 Linux 主机连接共享存储：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##iscsi识别共享存储</span></span><br><span class="line">yum install -y iscsi-initiator-utils*</span><br><span class="line"><span class="comment">##输出targetname，10.211.55.18为iscsi共享存储设备IP地址</span></span><br><span class="line">iscsiadm -m discovery -t st -p 10.211.55.18</span><br><span class="line"><span class="comment">##连接共享存储</span></span><br><span class="line">iscsiadm -m node -T iqn.2008-08.com.starwindsoftware:10.211.55.18-lucifer -p 10.211.55.18 -l</span><br><span class="line">lsblk</span><br></pre></td></tr></table></figure><p>安装 <code>multipath</code> 绑定多路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install -y device-mapper*</span><br><span class="line">mpathconf --<span class="built_in">enable</span> --with_multipathd y</span><br><span class="line"><span class="comment">##查看共享盘的scsi_id</span></span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdb</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdc</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdd</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sde</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdf</span><br><span class="line">/usr/lib/udev/scsi_id -g -u /dev/sdg</span><br></pre></td></tr></table></figure><p>配置 multipath 文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;/etc/multipath.conf</span></span><br><span class="line"><span class="string">defaults &#123;</span></span><br><span class="line"><span class="string">    user_friendly_names yes</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">blacklist &#123;</span></span><br><span class="line"><span class="string">  devnode &quot;^sda&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">multipaths &#123;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;27e2b3ddbd14752bb&quot;</span></span><br><span class="line"><span class="string">  alias ocr_1</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;27e2b3ddb87ff88ee&quot;</span></span><br><span class="line"><span class="string">  alias ocr_2</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;27e2b3ddb39fd2463&quot;</span></span><br><span class="line"><span class="string">  alias ocr_3</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;2852b96c1283206bf6&quot;</span></span><br><span class="line"><span class="string">  alias data_1</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;2852b96c12e8449cb9&quot;</span></span><br><span class="line"><span class="string">  alias data_2</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  multipath &#123;</span></span><br><span class="line"><span class="string">  wwid &quot;2852b96c12fc938e95&quot;</span></span><br><span class="line"><span class="string">  alias data_3</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> wwid的值为上面获取的scsi_id，alias可自定义，这里配置3块OCR盘，3块DATA盘！</p><p>激活multipath多路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">multipath -F</span><br><span class="line">multipath -v2</span><br><span class="line">multipath -ll</span><br></pre></td></tr></table></figure><p>配置UDEV绑盘：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ocr_* data_*; <span class="keyword">do</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;%s %s\n&quot;</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span> <span class="string">&quot;<span class="subst">$(udevadm info --query=all --name=/dev/mapper/<span class="string">&quot;<span class="variable">$i</span>&quot;</span> | grep -i dm_uuid)</span>&quot;</span> &gt;&gt;/dev/mapper/udev_info</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> -r line; <span class="keyword">do</span></span><br><span class="line">dm_uuid=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span> | awk -F<span class="string">&#x27;=&#x27;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">disk_name=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$line</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;KERNEL==\&quot;dm-*\&quot;,ENV&#123;DM_UUID&#125;==\&quot;<span class="variable">$&#123;dm_uuid&#125;</span>\&quot;,SYMLINK+=\&quot;asm_<span class="variable">$&#123;disk_name&#125;</span>\&quot;,OWNER=\&quot;grid\&quot;,GROUP=\&quot;asmadmin\&quot;,MODE=\&quot;0660\&quot;&quot;</span> &gt;&gt;/etc/udev/rules.d/99-oracle-asmdevices.rules</span><br><span class="line"><span class="keyword">done</span> &lt;/dev/mapper/udev_info</span><br><span class="line"><span class="comment">##重载udev</span></span><br><span class="line">udevadm control --reload-rules</span><br><span class="line">udevadm trigger --<span class="built_in">type</span>=devices</span><br></pre></td></tr></table></figure><p>确认配置完成后，分别在两个节点输入命令 <code>ls /dev/asm*</code> 查看是否已经成功绑定！</p><h2 id="hosts-文件配置（rac01-amp-rac02）"><a href="#hosts-文件配置（rac01-amp-rac02）" class="headerlink" title="hosts 文件配置（rac01&amp;rac02）"></a>hosts 文件配置（rac01&amp;rac02）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/hosts</span></span><br><span class="line"><span class="string">#Public IP</span></span><br><span class="line"><span class="string">192.168.56.10 rac01</span></span><br><span class="line"><span class="string">192.168.56.11 rac02</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Private IP</span></span><br><span class="line"><span class="string">172.0.0.1 rac01-priv</span></span><br><span class="line"><span class="string">172.0.0.2 rac02-priv</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Vip IP</span></span><br><span class="line"><span class="string">192.168.56.20 rac01-vip</span></span><br><span class="line"><span class="string">192.168.56.21 rac02-vip</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#Scan IP</span></span><br><span class="line"><span class="string">192.168.56.110 rac-scan</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h2 id="防火墙配置（rac01-amp-rac02）"><a href="#防火墙配置（rac01-amp-rac02）" class="headerlink" title="防火墙配置（rac01&amp;rac02）"></a>防火墙配置（rac01&amp;rac02）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line">systemctl status firewalld.service</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613014752447.png"></p><h2 id="selinux-配置（rac01-amp-rac02）"><a href="#selinux-配置（rac01-amp-rac02）" class="headerlink" title="selinux 配置（rac01&amp;rac02）"></a>selinux 配置（rac01&amp;rac02）</h2><p>配置 selinux 临时生效：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##重启后生效</span></span><br><span class="line">sed -i <span class="string">&#x27;s/SELINUX=enforcing/SELINUX=disabled/g&#x27;</span> /etc/selinux/config</span><br><span class="line">setenforce 0</span><br><span class="line"><span class="comment">##重启后检查</span></span><br><span class="line">getenforce</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613014855647.png"></p><p><strong>📢 注意：</strong> selinux 配置需要重启生效！</p><h2 id="时间同步配置（rac01-amp-rac02）"><a href="#时间同步配置（rac01-amp-rac02）" class="headerlink" title="时间同步配置（rac01&amp;rac02）"></a>时间同步配置（rac01&amp;rac02）</h2><p>首先需要禁用 chronyd 和 ntpd 服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##禁用chronyd</span></span><br><span class="line">yum install -y chrony</span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br><span class="line">systemctl stop chronyd.service</span><br><span class="line">systemctl <span class="built_in">disable</span> chronyd.service</span><br><span class="line"><span class="comment">##禁用ntpd</span></span><br><span class="line">yum install -y ntpdate</span><br></pre></td></tr></table></figure><p>配置计划任务，定时刷新系统时间：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##10.211.55.200为时间服务器IP，每天12点同步系统时间</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/var/spool/cron/root</span></span><br><span class="line"><span class="string">00 12 * * * /usr/sbin/ntpdate -u 10.211.55.200 &amp;&amp; /usr/sbin/hwclock -w</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##查看计划任务</span></span><br><span class="line">crontab -l</span><br><span class="line"><span class="comment">##手动执行</span></span><br><span class="line">/usr/sbin/ntpdate -u 10.211.55.200 &amp;&amp; /usr/sbin/hwclock -w</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613015038499.png"></p><h2 id="关闭透明大页和-NUMA（rac01-amp-rac02）"><a href="#关闭透明大页和-NUMA（rac01-amp-rac02）" class="headerlink" title="关闭透明大页和 NUMA（rac01&amp;rac02）"></a>关闭透明大页和 NUMA（rac01&amp;rac02）</h2><p>Linux 7 配置内核文件，关闭透明大页和numa：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/quiet/quiet transparent_hugepage=never numa=off/&#x27;</span> /etc/default/grub</span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg</span><br><span class="line"><span class="comment">##重启后检查是否生效</span></span><br><span class="line"><span class="built_in">cat</span> /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="built_in">cat</span> /proc/cmdline</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021061301513221.png"></p><p><strong>📢 注意：</strong> 关闭 <code>透明大页</code> 和 <code>numa</code> 的配置，需要重启主机生效！</p><h2 id="avahi-daemon-配置（rac01-amp-rac02）"><a href="#avahi-daemon-配置（rac01-amp-rac02）" class="headerlink" title="avahi-daemon 配置（rac01&amp;rac02）"></a>avahi-daemon 配置（rac01&amp;rac02）</h2><p>有些主机安装选择最小化安装，没有安装 avahi-daemon 功能，建议安装之后禁用，防止以后误操作导致出问题：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum install -y avahi*</span><br><span class="line">systemctl stop avahi-daemon.socket</span><br><span class="line">systemctl stop avahi-daemon.service</span><br><span class="line">pgrep -f avahi-daemon | awk <span class="string">&#x27;&#123;print &quot;kill -9 &quot;$2&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>配置 NOZEROCONF：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/sysconfig/network</span></span><br><span class="line"><span class="string">NOZEROCONF=yes</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613015233988.png"></p><h2 id="系统参数配置（rac01-amp-rac02）"><a href="#系统参数配置（rac01-amp-rac02）" class="headerlink" title="系统参数配置（rac01&amp;rac02）"></a>系统参数配置（rac01&amp;rac02）</h2><p>安装 Oracle 数据库需要配置系统参数，以下使用脚本命令一键式配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置参数文件</span></span><br><span class="line">memTotal=$(grep MemTotal /proc/meminfo | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">totalMemory=$((memTotal / <span class="number">2048</span>))</span><br><span class="line">shmall=$((memTotal / <span class="number">4</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$shmall</span> -lt 2097152 ]; <span class="keyword">then</span></span><br><span class="line">shmall=2097152</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">shmmax=$((memTotal * <span class="number">1024</span> - <span class="number">1</span>))</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$shmmax</span>&quot;</span> -lt 4294967295 ]; <span class="keyword">then</span></span><br><span class="line">shmmax=4294967295</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/sysctl.conf</span></span><br><span class="line"><span class="string">fs.aio-max-nr = 1048576</span></span><br><span class="line"><span class="string">fs.file-max = 6815744</span></span><br><span class="line"><span class="string">kernel.shmall = $shmall</span></span><br><span class="line"><span class="string">kernel.shmmax = $shmmax</span></span><br><span class="line"><span class="string">kernel.shmmni = 4096</span></span><br><span class="line"><span class="string">kernel.sem = 250 32000 100 128</span></span><br><span class="line"><span class="string">net.ipv4.ip_local_port_range = 9000 65500</span></span><br><span class="line"><span class="string">net.core.rmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.rmem_max = 4194304</span></span><br><span class="line"><span class="string">net.core.wmem_default = 262144</span></span><br><span class="line"><span class="string">net.core.wmem_max = 1048576</span></span><br><span class="line"><span class="string">net.ipv4.conf.eth0.rp_filter = 1</span></span><br><span class="line"><span class="string">net.ipv4.conf.eth1.rp_filter = 2</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##生效</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613015316589.png"></p><h2 id="系统资源限制配置（rac01-amp-rac02）"><a href="#系统资源限制配置（rac01-amp-rac02）" class="headerlink" title="系统资源限制配置（rac01&amp;rac02）"></a>系统资源限制配置（rac01&amp;rac02）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##配置limits.conf</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/security/limits.conf</span></span><br><span class="line"><span class="string">oracle soft nofile 1024</span></span><br><span class="line"><span class="string">oracle hard nofile 65536</span></span><br><span class="line"><span class="string">oracle soft stack 10240</span></span><br><span class="line"><span class="string">oracle hard stack 32768</span></span><br><span class="line"><span class="string">oracle soft nproc 2047</span></span><br><span class="line"><span class="string">oracle hard nproc 16384</span></span><br><span class="line"><span class="string">oracle hard memlock 134217728</span></span><br><span class="line"><span class="string">oracle soft memlock 134217728</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">grid soft nofile 1024</span></span><br><span class="line"><span class="string">grid hard nofile 65536</span></span><br><span class="line"><span class="string">grid soft stack 10240</span></span><br><span class="line"><span class="string">grid hard stack 32768</span></span><br><span class="line"><span class="string">grid soft nproc 2047</span></span><br><span class="line"><span class="string">grid hard nproc 16384</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##配置pam.d/login</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/etc/pam.d/login</span></span><br><span class="line"><span class="string">session required pam_limits.so</span></span><br><span class="line"><span class="string">session required /lib64/security/pam_limits.so</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/202106130156230.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613015705547.png"></p><h2 id="用户及组、目录创建（rac01-amp-rac02）"><a href="#用户及组、目录创建（rac01-amp-rac02）" class="headerlink" title="用户及组、目录创建（rac01&amp;rac02）"></a>用户及组、目录创建（rac01&amp;rac02）</h2><p>创建安装 Oracle 数据库所需的用户、组以及安装目录：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##组创建</span></span><br><span class="line">/usr/sbin/groupadd -g 54321 oinstall</span><br><span class="line">/usr/sbin/groupadd -g 54322 dba</span><br><span class="line">/usr/sbin/groupadd -g 54323 oper</span><br><span class="line">/usr/sbin/groupadd -g 54324 backupdba</span><br><span class="line">/usr/sbin/groupadd -g 54325 dgdba</span><br><span class="line">/usr/sbin/groupadd -g 54326 kmdba</span><br><span class="line">/usr/sbin/groupadd -g 54327 asmdba</span><br><span class="line">/usr/sbin/groupadd -g 54328 asmoper</span><br><span class="line">/usr/sbin/groupadd -g 54329 asmadmin</span><br><span class="line">/usr/sbin/groupadd -g 54330 racdba</span><br><span class="line"><span class="comment">##用户创建</span></span><br><span class="line">/usr/sbin/useradd -u 11012 -g oinstall -G asmadmin,asmdba,asmoper,dba,racdba,oper grid</span><br><span class="line">/usr/sbin/useradd -u 54321 -g oinstall -G asmdba,dba,backupdba,dgdba,kmdba,racdba,oper oracle</span><br><span class="line"><span class="comment">##修改用户密码为oracle</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;oracle&quot;</span> |passwd oracle --stdin</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;oracle&quot;</span> |passwd grid --stdin</span><br><span class="line"><span class="comment">##创建软件目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/11.2.0/grid</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/grid</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oracle/product/11.2.0/db</span><br><span class="line"><span class="built_in">mkdir</span> -p /u01/app/oraInventory</span><br><span class="line"><span class="built_in">mkdir</span> -p /backup</span><br><span class="line"><span class="built_in">mkdir</span> -p /home/oracle/scripts</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /backup</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /home/oracle/scripts</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/grid</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/11.2.0/grid</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /u01/app/oraInventory</span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /u01/app/oracle</span><br><span class="line"><span class="built_in">chmod</span> -R 775 /u01</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021061301573766.png"></p><h2 id="环境变量配置（rac01-amp-rac02）"><a href="#环境变量配置（rac01-amp-rac02）" class="headerlink" title="环境变量配置（rac01&amp;rac02）"></a>环境变量配置（rac01&amp;rac02）</h2><p>提前配置 profile 文件：</p><p><strong>grid 用户：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/home/grid/.bash_profile</span></span><br><span class="line"><span class="string">################OracleBegin#########################</span></span><br><span class="line"><span class="string">umask 022</span></span><br><span class="line"><span class="string">export TMP=/tmp</span></span><br><span class="line"><span class="string">export TMPDIR=\$TMP</span></span><br><span class="line"><span class="string">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span></span><br><span class="line"><span class="string">export ORACLE_BASE=/u01/app/grid</span></span><br><span class="line"><span class="string">export ORACLE_HOME=/u01/app/11.2.0/grid</span></span><br><span class="line"><span class="string">export ORACLE_TERM=xterm</span></span><br><span class="line"><span class="string">export TNS_ADMIN=\$ORACLE_HOME/network/admin</span></span><br><span class="line"><span class="string">export LD_LIBRARY_PATH=\$ORACLE_HOME/lib:/lib:/usr/lib</span></span><br><span class="line"><span class="string">export ORACLE_SID=+ASM1</span></span><br><span class="line"><span class="string">export PATH=/usr/sbin:\$PATH</span></span><br><span class="line"><span class="string">export PATH=\$ORACLE_HOME/bin:\$ORACLE_HOME/OPatch:\$PATH</span></span><br><span class="line"><span class="string">alias sas=&#x27;sqlplus / as sysasm&#x27;</span></span><br><span class="line"><span class="string">export PS1=&quot;[\`whoami\`@\`hostname\`:&quot;&#x27;\$PWD]\$ &#x27;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 每个节点的 ORACLE_SID 不一样（+ASM1&#x2F;+ASM2），需要自行修改！</p><p><strong>oracle 用户：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/home/oracle/.bash_profile</span></span><br><span class="line"><span class="string">################OracleBegin#########################</span></span><br><span class="line"><span class="string">umask 022</span></span><br><span class="line"><span class="string">export TMP=/tmp</span></span><br><span class="line"><span class="string">export TMPDIR=\$TMP</span></span><br><span class="line"><span class="string">export NLS_LANG=AMERICAN_AMERICA.AL32UTF8</span></span><br><span class="line"><span class="string">export ORACLE_BASE=/u01/app/oracle</span></span><br><span class="line"><span class="string">export ORACLE_HOME=\$ORACLE_BASE/product/11.2.0/db</span></span><br><span class="line"><span class="string">export ORACLE_HOSTNAME=rac01</span></span><br><span class="line"><span class="string">export ORACLE_TERM=xterm</span></span><br><span class="line"><span class="string">export TNS_ADMIN=\$ORACLE_HOME/network/admin</span></span><br><span class="line"><span class="string">export LD_LIBRARY_PATH=\$ORACLE_HOME/lib:/lib:/usr/lib</span></span><br><span class="line"><span class="string">export ORACLE_SID=orcl1</span></span><br><span class="line"><span class="string">export PATH=/usr/sbin:\$PATH</span></span><br><span class="line"><span class="string">export PATH=\$ORACLE_HOME/bin:\$ORACLE_HOME/OPatch:\$PATH</span></span><br><span class="line"><span class="string">alias sas=&#x27;sqlplus / as sysdba&#x27;</span></span><br><span class="line"><span class="string">export PS1=&quot;[\`whoami\`@\`hostname\`:&quot;&#x27;\$PWD]\$ &#x27;</span></span><br><span class="line"><span class="string">################OracleEnd#########################</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 每个节点的 ORACLE_HOSTNAME（rac01&#x2F;rac02）和 ORACLE_SID（orcl1&#x2F;orcl2）不一样，需要自行修改！</p><h2 id="安装介质上传解压（rac01）"><a href="#安装介质上传解压（rac01）" class="headerlink" title="安装介质上传解压（rac01）"></a>安装介质上传解压（rac01）</h2><p>安装包使用     XFTP 工具进行上传，只需要上传至一节点 &#x2F;soft 目录下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##创建安装介质存放目录</span></span><br><span class="line"><span class="built_in">mkdir</span> /soft</span><br><span class="line"><span class="comment">##上传安装介质到/soft目录</span></span><br><span class="line">p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">p13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line">p13390677_112040_Linux-x86-64_3of7.zip</span><br><span class="line"><span class="comment">##解压安装介质</span></span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line">unzip -q p13390677_112040_Linux-x86-64_3of7.zip</span><br><span class="line"><span class="comment">##授权目录</span></span><br><span class="line"><span class="built_in">chown</span> -R oracle:oinstall /soft/database</span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft/grid</span><br><span class="line"><span class="comment">##root用户下，cvuqdisk安装（rac01&amp;rac02）</span></span><br><span class="line"><span class="built_in">cd</span> /soft/grid/rpm</span><br><span class="line">rpm -ivh cvuqdisk-1.0.9-1.rpm</span><br><span class="line"><span class="comment">##传输到节点二安装</span></span><br><span class="line">scp cvuqdisk-1.0.9-1.rpm rac2:/tmp</span><br><span class="line">rpm -ivh /tmp/cvuqdisk-1.0.9-1.rpm</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 安装包只需要在节点一上传解压即可！</p><p><strong><font color='orage'>至此，准备工作已经完成。</font></strong></p><h1 id="安装-Grid-软件（rac01）"><a href="#安装-Grid-软件（rac01）" class="headerlink" title="安装 Grid 软件（rac01）"></a>安装 Grid 软件（rac01）</h1><p>配置 grid 用户 vnc 图形界面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##root用户下切换到grid用户</span></span><br><span class="line">su - grid</span><br><span class="line"><span class="comment">##执行vncserver，按提示输入密码即可</span></span><br><span class="line">vncserver</span><br><span class="line"><span class="comment">##在vnc客户端界面输入192.168.56.10:1，输入刚才输入的密码即可连接。</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613023253366.png"></p><p><img src="https://img-blog.csdnimg.cn/2021061302334592.png"></p><p><img src="https://img-blog.csdnimg.cn/2021061302342734.png"></p><p>右键打开终端：</p><p><img src="https://img-blog.csdnimg.cn/20210613025049210.png"></p><p>开始安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##应用环境变量</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="comment">##进入安装目录</span></span><br><span class="line"><span class="built_in">cd</span> /soft/grid</span><br><span class="line"><span class="comment">##执行安装程序开始安装，加上jar包防止弹窗不显示问题</span></span><br><span class="line">./runInstaller -jreLoc /etc/alternatives/jre_1.8.0</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613025243202.png"></p><p>跳过版本更新：</p><p><img src="https://img-blog.csdnimg.cn/2021061302443768.png"></p><p>选择集群模式安装：</p><p><img src="https://img-blog.csdnimg.cn/20210613024538329.png"></p><p>自定义模式安装：</p><p><img src="https://img-blog.csdnimg.cn/20210613024630691.png"></p><p>选择语言：</p><p><img src="https://img-blog.csdnimg.cn/20210613024721353.png"></p><p>修改集群名称和 scan 名称：</p><p><img src="https://img-blog.csdnimg.cn/20210613024800916.png"></p><p><strong>📢 注意：</strong> scan 名称必须与 &#x2F;etc&#x2F;hosts 中配置的 scan 名称保持一致！</p><p>配置 grid 用户节点间互信：</p><p><img src="https://img-blog.csdnimg.cn/20210613025330906.png"></p><p><strong>📢 注意：</strong> 点击 Add 添加节点二，pubile hostname 为 <code>rac02</code>，virtual hostname 为 <code>rac02-vip</code>，输入密码：<code>oracle</code>，点击 setup 开始互信。</p><p>点击Test测试互信：</p><p><img src="https://img-blog.csdnimg.cn/20210613025625243.png"></p><p>确认网络信息是否正确：</p><p><img src="https://img-blog.csdnimg.cn/20210613025708614.png"></p><p>选择ASM模式安装：</p><p><img src="https://img-blog.csdnimg.cn/20210613025758442.png"></p><p>填写 OCR 裁决盘信息：</p><p><img src="https://img-blog.csdnimg.cn/20210613025836198.png"></p><p><strong>📢 注意：</strong> OCR 裁决盘这里冗余模式 External，Normal，High 对应磁盘数量为 1，3，5。</p><p>填写 ASM 实例 SYS 用户密码为 oracle：</p><p><img src="https://img-blog.csdnimg.cn/20210613030105848.png"></p><p>不使用 IPMI：</p><p><img src="https://img-blog.csdnimg.cn/20210613030204351.png"></p><p>选择用户组，默认即可：</p><p><img src="https://img-blog.csdnimg.cn/20210613030257796.png"></p><p>选择grid安装目录，默认即可：</p><p><img src="https://img-blog.csdnimg.cn/20210707215805712.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613030424840.png"></p><p>安装前预检查：</p><p><img src="https://img-blog.csdnimg.cn/20210613030513955.png"></p><p>开始执行安装：</p><p><img src="https://img-blog.csdnimg.cn/20210613030555819.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613030634609.png"></p><p>执行 root 脚本：（rac01&amp;rac02）</p><p><img src="https://img-blog.csdnimg.cn/2021061303065717.png"></p><p><strong>📢 注意：</strong> Linux7 安装 Oracle 11GR2 版本，执行 root.sh 时存在 BUG：</p><p><img src="https://img-blog.csdnimg.cn/20210613032357659.png"></p><p>需要在执行 root.sh 之前安装补丁 <code>18370031</code> 来修复，<strong>补丁下载地址</strong>：</p><p><a href="https://pan.baidu.com/s/1f1nCwZxfeqsdWGKN1DiI9Q"  target="_blank" rel="noopener noreferrer"><font size="5" color="orage">https://pan.baidu.com/s/1f1nCwZxfeqsdWGKN1DiI9Q</a></font><br><strong>提取码: <code>wbtw</code></strong></p><p>18370031 补丁安装：（rac01&amp;rac02）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##上传补丁包</span></span><br><span class="line">p18370031_112040_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##解压补丁包</span></span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">unzip -q p18370031_112040_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##授权补丁包</span></span><br><span class="line"><span class="built_in">chown</span> -R grid:oinstall /soft/18370031</span><br><span class="line"><span class="comment">##开始安装补丁，两个节点都需要执行</span></span><br><span class="line">opatch napply -oh <span class="variable">$ORACLE_HOME</span> -<span class="built_in">local</span> /soft/18370031 -silent</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613032747188.png"></p><p><strong>📢 注意：</strong> 两个节点都需要安装补丁 <code>18370031</code>！</p><p>打好补丁后，开始执行 root.sh 脚本：（rac01&amp;rac02）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##root用户下执行</span></span><br><span class="line">/u01/app/oraInventory/orainstRoot.sh</span><br><span class="line">/u01/app/11.2.0/grid/root.sh</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613032534680.png"></p><p><font color='orage'><strong>执行过程太长，不做记录！</strong></font></p><p>由于我们没有配置 DNS 解析，因此下方的错误忽略即可：</p><p><img src="https://img-blog.csdnimg.cn/20210613032612268.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613032819116.png"></p><p><img src="https://img-blog.csdnimg.cn/2021061303301445.png"></p><p><font color='orage'><strong>至此，Grid集群软件安装成功！</strong></font></p><p><font color='red'><strong>注意：</strong></font> 如果需要安装 <code>PSU</code> 补丁，建议在建库之前安装，可以省去数据字典升级的步骤！</p><p>以 Grid PSU 补丁 <code>31718723</code> 为例，使用 <code>root</code> 用户执行补丁安装命令：（rac01&amp;rac02）**</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##解压补丁包</span></span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">unzip -q p31718723_112040_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##切换到root用户执行，需要拷贝到2节点也执行一次</span></span><br><span class="line">opatch auto /soft/31718723 -oh <span class="variable">$GRID_ORACLE_HOME</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 需要先替换 grid 和 oracle 软件的 OPatch 包为最新版本，否则无法成功安装补丁！</p><h1 id="创建-ASM-数据盘-DATA"><a href="#创建-ASM-数据盘-DATA" class="headerlink" title="创建 ASM 数据盘 DATA"></a>创建 ASM 数据盘 DATA</h1><p>这里创建的 DATA 磁盘组主要用于存放数据文件、日志文件等数据库文件！</p><p>这里我们可以使用静默创建或者图形化方式创建：</p><p><strong>1、静默创建</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asmca -silent -sysAsmPassword oracle -asmsnmpPassword oracle -oui_internal -configureASM -diskString <span class="string">&#x27;/dev/asm*&#x27;</span> -diskGroupName DATA -diskList /dev/asm_data_1,/dev/asm_data_2,/dev/asm_data_3 -redundancy NORMAL -au_size 1</span><br></pre></td></tr></table></figure><p><strong>2、图形化创建</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asmca</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613033445602.png"></p><p>点击 create 创建 DATA：</p><p><img src="https://img-blog.csdnimg.cn/20210613033543142.png"></p><p>点击 OK 创建 DATA：</p><p><img src="https://img-blog.csdnimg.cn/20210613033609346.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613033637985.png"></p><p><strong><font color='orage'>建议重启两台主机，检查重启后Grid集群是否正常运行！</font></strong></p><h1 id="安装Oracle软件"><a href="#安装Oracle软件" class="headerlink" title="安装Oracle软件"></a>安装Oracle软件</h1><p>配置 oracle 用户 vnc 图形界面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##root用户下切换到grid用户</span></span><br><span class="line">su - oracle</span><br><span class="line"><span class="comment">##执行vncserver，按提示输入密码即可</span></span><br><span class="line">vncserver</span><br><span class="line"><span class="comment">##在vnc客户端界面输入192.168.56.10:2，输入刚才输入的密码即可连接。</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/2021061303411966.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613034243211.png">、</p><p><img src="https://img-blog.csdnimg.cn/2021061302342734.png"></p><p>右键打开终端：</p><p><img src="https://img-blog.csdnimg.cn/20210613025049210.png"></p><p>开始安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##应用环境变量</span></span><br><span class="line"><span class="built_in">source</span> ~/.bash_profile</span><br><span class="line"><span class="comment">##进入安装目录</span></span><br><span class="line"><span class="built_in">cd</span> /soft/database</span><br><span class="line"><span class="comment">##执行安装程序开始安装，加上jar包防止弹窗不显示问题</span></span><br><span class="line">./runInstaller -jreLoc /etc/alternatives/jre_1.8.0</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210613034521828.png"></p><p>不配置 Oracle 邮件发送：</p><p><img src="https://img-blog.csdnimg.cn/20210613034620690.png"></p><p>跳过软件更新：</p><p><img src="https://img-blog.csdnimg.cn/20210613034720155.png"></p><p>选择仅安装 oracle 软件：</p><p><img src="https://img-blog.csdnimg.cn/20210613034744112.png"></p><p>配置 oracle 用户互信：</p><p><img src="https://img-blog.csdnimg.cn/20210613034813256.png"></p><p>输入密码，点击 setup 开始，成功之后点击 Test 。</p><p><img src="https://img-blog.csdnimg.cn/20210613034938141.png"></p><p>选择语言：</p><p><img src="https://img-blog.csdnimg.cn/2021061303501023.png"></p><p>选择企业版安装：</p><p><img src="https://img-blog.csdnimg.cn/202106130350263.png"></p><p>检查用户组，默认即可：</p><p><img src="https://img-blog.csdnimg.cn/2021061303505343.png"></p><p>安装前预检查：</p><p><img src="https://img-blog.csdnimg.cn/2021061303514626.png"></p><p>开始安装 Oracle 软件：</p><p><img src="https://img-blog.csdnimg.cn/20210613035248217.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613035331947.png"></p><p>报错解决：</p><p><img src="https://img-blog.csdnimg.cn/20210613035356111.png"></p><p><strong>📢 注意：</strong> Linux7 安装 Oracle 11GR2 版本，oracle 软件安装过程中报错：<code>ins_emagent.mk</code>，需要修改文件 <code>/sysman/lib/ins_emagent.mk</code> 来修复！</p><p>两个节点都执行以下命令，然后点击继续：（rac01&amp;rac02）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/^\(\s*\$(MK_EMAGENT_NMECTL)\)\s*$/\1 -lnnz11/g&#x27;</span> <span class="string">&quot;<span class="variable">$ORACLE_HOME</span>/sysman/lib/ins_emagent.mk</span></span><br></pre></td></tr></table></figure><p>执行 root.sh 脚本：（rac01&amp;rac02）</p><p><img src="https://img-blog.csdnimg.cn/2021061304003259.png"></p><p>点击下一步，安装成功：</p><p><img src="https://img-blog.csdnimg.cn/20210613040217772.png"></p><p><strong><font color='orage'>至此，Oracle 软件已成功安装！</font></strong></p><p><font color='red'><strong>注意：</strong></font> 如果需要安装 <code>PSU</code> 补丁，建议在建库之前安装，可以省去数据字典升级的步骤！</p><p>以 Grid PSU 补丁 <code>31718723</code> 为例，使用 <code>root</code> 用户执行补丁安装命令：（rac01&amp;rac02）**</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##解压补丁包</span></span><br><span class="line"><span class="built_in">cd</span> /soft</span><br><span class="line">unzip -q p31718723_112040_Linux-x86-64.zip</span><br><span class="line"><span class="comment">##切换到root用户执行，需要拷贝到2节点也执行一次</span></span><br><span class="line">opatch auto /soft/31718723 -oh <span class="variable">$ORACLE_ORACLE_HOME</span></span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 需要先替换 grid 和 oracle 软件的 OPatch 包为最新版本，否则无法成功安装补丁！</p><h1 id="创建数据库实例"><a href="#创建数据库实例" class="headerlink" title="创建数据库实例"></a>创建数据库实例</h1><p>在确保 grid 和 oracle 软件和补丁都已安装成功后，即可开始创建数据库实例！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca</span><br></pre></td></tr></table></figure><p>选择 rac 模式：</p><p><img src="https://img-blog.csdnimg.cn/20210613040910147.png"></p><p>选择创建数据库：</p><p><img src="https://img-blog.csdnimg.cn/20210613040950213.png"></p><p>选择自定义模板：</p><p><img src="https://img-blog.csdnimg.cn/20210613041018746.png"></p><p><strong>📢 注意：</strong> 这里我选择的是 <code>Custom Database</code> 选项，可以自定义安装组件！</p><p>填写数据库实例 ID：</p><p><img src="https://img-blog.csdnimg.cn/2021061304110452.png"></p><p>关闭 EM，保留自动化系统 JOB：</p><p><img src="https://img-blog.csdnimg.cn/20210613041156230.png"></p><p>填写 SYS 密码，需要记住：</p><p><img src="https://img-blog.csdnimg.cn/20210613041252616.png"></p><p>选择存放数据的 ASM 盘：<strong>DATA</strong></p><p><img src="https://img-blog.csdnimg.cn/20210613041322211.png"></p><p>不开启闪回区，建库后可随时开启：</p><p><img src="https://img-blog.csdnimg.cn/20210613041405114.png"></p><p>选择自定义组件，默认即可！</p><p><img src="https://img-blog.csdnimg.cn/20210613041452239.png"></p><p>配置初始化参数：</p><p><img src="https://img-blog.csdnimg.cn/20210613041537704.png"></p><p><strong>📢 注意：</strong> 如果使用自动管理内存，建议使用 <strong>70%~90%</strong> 的物理内存，建议 <code>/etc/shm</code> 和物理内存一样大！</p><p>block 默认 <code>8192</code>（即数据文件默认最大 32G），进程数增加到 <code>1500</code>：</p><p><img src="https://img-blog.csdnimg.cn/20210613041722649.png"></p><p>选择数据库字符集，默认字符集为 <code>AL32UTF8</code>，国家字符集为 <code>AL16UTF16</code>，<strong>需根据业务实际情况进行修改</strong>：</p><p><img src="https://img-blog.csdnimg.cn/20210613041840767.png"></p><p>开始建库：</p><p><img src="https://img-blog.csdnimg.cn/20210613041944128.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613042015258.png"></p><p><img src="https://img-blog.csdnimg.cn/202106130421465.png"></p><p>数据库创建成功：</p><p><img src="https://img-blog.csdnimg.cn/20210613042220964.png"></p><p><img src="https://img-blog.csdnimg.cn/20210613042431687.png"></p><p><strong><font color='orage'>至此，数据库实例创建完成！</font></strong></p><h1 id="数据库优化配置（rac01）"><a href="#数据库优化配置（rac01）" class="headerlink" title="数据库优化配置（rac01）"></a>数据库优化配置（rac01）</h1><h2 id="开启数据库归档模式"><a href="#开启数据库归档模式" class="headerlink" title="开启数据库归档模式"></a>开启数据库归档模式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##关闭数据库实例</span></span><br><span class="line">srvctl stop database -d orcl</span><br><span class="line"><span class="comment">##开启单个节点到mount模式</span></span><br><span class="line">srvctl start instance -d orcl -i orcl1 -o mount</span><br><span class="line"><span class="comment">##开启归档</span></span><br><span class="line">alter database archivelog;</span><br><span class="line"><span class="comment">##设置归档路径</span></span><br><span class="line">ALTER SYSTEM SET LOG_ARCHIVE_DEST_1=<span class="string">&#x27;LOCATION=+DATA&#x27;</span>;</span><br><span class="line"><span class="comment">##重启数据库实例</span></span><br><span class="line">srvctl stop instance -d orcl -i orcl1</span><br><span class="line">srvctl start database -d orcl</span><br><span class="line"><span class="comment">##检查归档</span></span><br><span class="line">archive <span class="built_in">log</span> list</span><br></pre></td></tr></table></figure><h2 id="配置定期删除归档计划任务"><a href="#配置定期删除归档计划任务" class="headerlink" title="配置定期删除归档计划任务"></a>配置定期删除归档计划任务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##进入oracle用户</span></span><br><span class="line">su - oracle</span><br><span class="line"><span class="comment">##写入脚本</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;source ~/.bash_profile&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;deltime=`date +&quot;20%y%m%d%H%M%S&quot;`&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;rman target / nocatalog msglog /home/oracle/scripts/del_arch_\$&#123;deltime&#125;.log&lt;&lt;EOF&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;crosscheck archivelog all;&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;delete noprompt archivelog until time &#x27;sysdate-7&#x27;;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;delete noprompt force archivelog until time &#x27;SYSDATE-10&#x27;;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#125; &gt;&gt;/home/oracle/scripts/del_arch.sh</span><br><span class="line"><span class="comment">##写入计划任务</span></span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF&gt;&gt;/var/spool/cron/oracle</span></span><br><span class="line"><span class="string">12 00 * * * /home/oracle/scripts/del_arch.sh</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="comment">##手动执行测试</span></span><br><span class="line">/home/oracle/scripts/del_arch.sh</span><br></pre></td></tr></table></figure><h2 id="设置密码永不过期"><a href="#设置密码永不过期" class="headerlink" title="设置密码永不过期"></a>设置密码永不过期</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line">ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED;</span><br></pre></td></tr></table></figure><p>Oracle 11GR2 版本需要手动设置密码永不过期，12CR2 版本之后已经默认设置为永不过期了！</p>]]></content>
      
      
      <categories>
          
          <category> Oracle </category>
          
          <category> Linux </category>
          
          <category> RAC </category>
          
          <category> 11GR2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Oracle </tag>
            
            <tag> RAC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用 StarWind 配置 ISCSI 共享存储</title>
      <link href="/post/b153d9c4.html"/>
      <url>/post/b153d9c4.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前讲过一篇文章 <a href="http://luciferlpc.top/post/1ae1443c.html">一步步教你Linux7安装Oracle RAC（11GR2版本）</a> 教大家如何安装 Oracle RAC。</p><p>有朋友希望将共享存储配置这一块详细讲一讲，因此便写了这篇。</p><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p><code>ISCSI</code>（Internet Small Computer System Interface，Internet 小型计算机系统接口)是一种由IBM公司研究开发的IP SAN技术。</p><p>该技术是将现有SCSI接口与以太网络(Ethernet)技术结合，基于 TCP&#x2F;IP的协议连接iSCSI服务端（Target）和客户端(Initiator)，使得封装后的SCSI数据包可以在通用互联网传输，最终实现iSCSI服务端映射为一个存储空间（磁盘）提供给已连接认证后的客户端。</p><p><img src="https://img-blog.csdnimg.cn/20210621155703252.png"></p><p>本文主要讲解的是 Windows 主机下配置 <code>StarWind</code> 软件实现共享存储！</p><h1 id="StarWind安装"><a href="#StarWind安装" class="headerlink" title="StarWind安装"></a>StarWind安装</h1><p><code>StarWind</code> 的特点就是简单快捷，方便操作；对于测试安装来说，Windows平台更实用。</p><h2 id="解压安装包"><a href="#解压安装包" class="headerlink" title="解压安装包"></a>解压安装包</h2><p>首先，需要下载 <code>StarWind</code> 安装包，<strong>下载地址</strong>：</p><p><a href="https://pan.baidu.com/s/1OX7rAiG9AQW8EfEGGHEjlQ"  target="_blank" rel="noopener noreferrer"><font size="5" color="orage">https://pan.baidu.com/s/1OX7rAiG9AQW8EfEGGHEjlQ</a></font> <span class="hide-inline"><button type="button" class="hide-button" style="background-color: #FF7242;color: #fff">查看提取码  </button><span class="hide-content">提取码：kpl9</span></span></p><p><img src="https://img-blog.csdnimg.cn/20210621160410613.png"></p><h2 id="运行安装"><a href="#运行安装" class="headerlink" title="运行安装"></a>运行安装</h2><p><img src="https://img-blog.csdnimg.cn/20210621160504272.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160544313.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160608972.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160637453.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160703248.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160737939.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160810275.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160859729.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621160937349.png"></p><p>选择安装包中的key：</p><p><img src="https://img-blog.csdnimg.cn/20210621161034970.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621161124516.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621161152867.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621161227857.png"></p><p>选择安装：</p><p><img src="https://img-blog.csdnimg.cn/20210621161303502.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621161347768.png"></p><p><strong><font color='orage'>至此，StarWind 软件已经成功安装！</font></strong></p><h1 id="配置服务端StarWind-ISCSI"><a href="#配置服务端StarWind-ISCSI" class="headerlink" title="配置服务端StarWind ISCSI"></a>配置服务端StarWind ISCSI</h1><p>确保成功安装 StarWind 软件之后，接下来就需要通过软件配置共享存储！</p><h2 id="打开StarWind软件"><a href="#打开StarWind软件" class="headerlink" title="打开StarWind软件"></a>打开StarWind软件</h2><p><img src="https://img-blog.csdnimg.cn/20210621161745379.png"></p><h2 id="新建StarWind-Server"><a href="#新建StarWind-Server" class="headerlink" title="新建StarWind Server"></a>新建StarWind Server</h2><p><img src="https://img-blog.csdnimg.cn/20210621161901575.png"></p><p>通过 <code>cmd</code> 命令行输入 <code>ipconfig</code> 查看本机 ip 地址：</p><p><img src="https://img-blog.csdnimg.cn/20210621162027516.png"></p><p>填写本机 IP，点击OK：</p><p><img src="https://img-blog.csdnimg.cn/20210621162116899.png"></p><p>新建成功后，选择 Server，双击或者点击 connect 连接：</p><p><img src="https://img-blog.csdnimg.cn/20210621162300290.png"></p><h2 id="新建Target"><a href="#新建Target" class="headerlink" title="新建Target"></a>新建Target</h2><p><img src="https://img-blog.csdnimg.cn/20210621162447837.png"></p><p>填入 Target 别名，根据自己情况填写：</p><p><img src="https://img-blog.csdnimg.cn/20210707114844389.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621162855821.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621162922623.png"></p><p><img src="https://img-blog.csdnimg.cn/20210707122031113.png"></p><h1 id="添加Device存储盘"><a href="#添加Device存储盘" class="headerlink" title="添加Device存储盘"></a>添加Device存储盘</h1><p><img src="https://img-blog.csdnimg.cn/20210621163324469.png"></p><p>选择虚拟硬盘：</p><p><img src="https://img-blog.csdnimg.cn/20210621163406903.png"></p><p>选择镜像文件：</p><p><img src="https://img-blog.csdnimg.cn/20210621163450530.png"></p><p>创建新的虚拟盘：</p><p><img src="https://img-blog.csdnimg.cn/20210621163555151.png"></p><p>选择镜像文件路径和大小：</p><p><img src="https://img-blog.csdnimg.cn/20210621164100309.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621164317564.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621164424224.png"></p><p>选择已有 Target：</p><p><img src="https://img-blog.csdnimg.cn/20210621164513155.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621164537210.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621164613973.png"></p><p><img src="https://img-blog.csdnimg.cn/20210621164636208.png"></p><p><strong>📢 注意：</strong> 如果需要添加多块共享盘，只需要重复上述添加 Device 即可！</p><p><img src="https://img-blog.csdnimg.cn/2021070712212241.png"></p><p><strong><font color='orage'>至此，StarWind共享存储服务端已经配置完成。</font></strong></p><h1 id="Linux通过-ISCSI-连接共享存储"><a href="#Linux通过-ISCSI-连接共享存储" class="headerlink" title="Linux通过 ISCSI 连接共享存储"></a>Linux通过 ISCSI 连接共享存储</h1><h2 id="Linux-客户端安装-ISCSI-依赖"><a href="#Linux-客户端安装-ISCSI-依赖" class="headerlink" title="Linux 客户端安装 ISCSI 依赖"></a>Linux 客户端安装 ISCSI 依赖</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y iscsi-initiator-utils*</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210621165348769.png" alt="安装依赖"></p><h2 id="搜索服务端-ISCSI-Target"><a href="#搜索服务端-ISCSI-Target" class="headerlink" title="搜索服务端 ISCSI Target"></a>搜索服务端 ISCSI Target</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m discovery -t st -p 10.211.55.33</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> 10.211.55.33 为服务端 IP 地址，即 Windows 主机的 IP 地址。</p><p><img src="https://img-blog.csdnimg.cn/20210621165616390.png"></p><h2 id="连接服务端-ISCSI-共享存储"><a href="#连接服务端-ISCSI-共享存储" class="headerlink" title="连接服务端 ISCSI 共享存储"></a>连接服务端 ISCSI 共享存储</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m node -T iqn.2008-08.com.starwindsoftware:10.211.55.33-lucifer -p 10.211.55.33 -l</span><br></pre></td></tr></table></figure><p><strong>📢 注意：</strong> <code>iqn.2008-08.com.starwindsoftware:10.211.55.33-lucifer</code> 为上一步搜索出的Target名称，复制即可！</p><p><img src="https://img-blog.csdnimg.cn/20210621165834145.png"></p><h2 id="Linux-客户端查看共享存储"><a href="#Linux-客户端查看共享存储" class="headerlink" title="Linux 客户端查看共享存储"></a>Linux 客户端查看共享存储</h2><p>Linux 客户端通过命令 lsblk 查看共享存储是否成功挂载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210621165930891.png"></p><p><strong><font color='orage'>如上所示，共享盘已经挂载成功。</font></strong></p>]]></content>
      
      
      <categories>
          
          <category> StarWind </category>
          
      </categories>
      
      
        <tags>
            
            <tag> StarWind </tag>
            
            <tag> ISCSI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly 主题美化合集</title>
      <link href="/post/794f2e6e.html"/>
      <url>/post/794f2e6e.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/jerryc127/hexo-theme-butterfly">hexo-theme-butterfly</a> 主题是基于 <a href="https://github.com/Molunerfinn/hexo-theme-melody">hexo-theme-melody</a> 的基础上进行开发的。</p><p>本帖的主要目的是用最平实的语言描述博客美化的进程，同时在每个章节为可能涉及的知识点提供相应的工具网站以供读者学习。当然，最重要的是给我自己留个魔改的日记。这样升级主题玩崩了也能找到回家的路。</p><h1 id="Butterfly-主题安装"><a href="#Butterfly-主题安装" class="headerlink" title="Butterfly 主题安装"></a>Butterfly 主题安装</h1><blockquote><p>参考自文章：<a href="https://butterfly.js.org/posts/21cfbf15/">https://butterfly.js.org/posts/21cfbf15/</a></p></blockquote><p>Butterfly 主题安装支持：</p><ul><li>Git 安装（Github 和 Gitee）</li><li>NPM 安装</li></ul><div class="tabs" id="安装"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#安装-1">① GitHub安装</button></li><li class="tab"><button type="button" data-href="#安装-2">② Gitee安装</button></li><li class="tab"><button type="button" data-href="#安装-3">③ NPM安装</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="安装-1"><p>在你的 Hexo 根目录里执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><div class="note info flat"><p>升级方法：在主题目录下，运行 <code>git pull</code></p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="安装-2"><p>在你的 Hexo 根目录里执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> -b master https://gitee.com/immyw/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><div class="note info flat"><p>升级方法：在主题目录下，运行 <code>git pull</code></p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="安装-3"><div class="note warning flat"><p>此方法只支持 Hexo 5.0.0 以上版本</p><p><strong>通过 npm 安装并不会在 themes 里生成主题文件夹，而是在 node_modules 里生成</strong></p></div><p>在你的 Hexo 根目录里执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-theme-butterfly</span><br></pre></td></tr></table></figure><div class="note info flat"><p>升级方法：在 Hexo 根目录下，运行 <code>npm update hexo-theme-butterfly</code></p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="应用主题"><a href="#应用主题" class="headerlink" title="应用主题"></a>应用主题</h2><p>修改 Hexo 根目录下的 <code>_config.yml</code>，把主题改为 <code>butterfly</code>：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">butterfly</span></span><br></pre></td></tr></table></figure><h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><p>如果你没有 pug 以及 stylus 的渲染器，请下载安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><h2 id="升级建议"><a href="#升级建议" class="headerlink" title="升级建议"></a>升级建议</h2><p>为了减少升级主题后带来的不便，请使用以下方法：</p><p>在 hexo 的根目录创建一个文件 _config.butterfly.yml，并把主题目录的 _config.yml 内容复制到 _config.butterfly.yml 去，以后只需要在 <code>_config.butterfly.yml </code> 进行配置就行。</p><h1 id="Butterfly-主题美化"><a href="#Butterfly-主题美化" class="headerlink" title="Butterfly 主题美化"></a>Butterfly 主题美化</h1><ol><li>鉴于每个人的根目录名称都不一样，本帖<strong>博客根目录</strong>一律以<code>[Blogroot]</code>指代。</li><li>本帖涉及魔改源码的内容，会使用<strong>diff代码块</strong>标识，复制时请<strong>不要忘记删除</strong>前面的<code>+、-</code>符号。</li><li>因为<code>.pug</code>和<code>.styl</code>以及<code>.yml</code>等对缩进要求较为严格，请尽量<strong>不要使用记事本等无法提供语法高亮的文本编辑器</strong>进行修改。</li><li>本帖基于<code>Butterfly主题</code>进行魔改方案编写，因此请读者优先掌握 <a href="https://butterfly.js.org/">Butterfly主题官方文档 </a> 的内容后再来进行魔改。以避免不必要的兼容性问题。</li></ol><h2 id="基础美化"><a href="#基础美化" class="headerlink" title="基础美化"></a>基础美化</h2><p>一些基础的 Butterfly 美化方案在官方文档中均可以找到，所以请先熟读 <a href="https://butterfly.js.org/">Butterfly主题官方文档 </a>。</p><h2 id="生成文章唯一链接"><a href="#生成文章唯一链接" class="headerlink" title="生成文章唯一链接"></a>生成文章唯一链接</h2><p>转自<a href="https://blog.huran.xyz/post/16808/"> HuRan Blog《利用Hexo-abbrlink插件生成唯一文章链接》</a>仅用于学习。</p><p>Hexo的默认文章链接格式是年，月，日，标题这种格式来生成的。如果你的标题是中文的话，那你的URL链接就会包含中文，</p><p>复制后的URL路径就是把中文变成了一大堆字符串编码，如果你在其他地方用这边文章的url链接，偶然你又修改了改文章的标题，那这个URL链接就会失效。为了给每一篇文章来上一个属于自己的链接，写下此教程，利用 hexo-abbrlink 插件，<code>A Hexo plugin to generate static post link based on post titles</code> ,来解决这个问题。 参考github官方： hexo-abbrlink 按照此教程配置完之后如下：</p><p>1、安装插件，在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><p>2、插件安装成功后，在根目录  <code>[Blogroot]</code>  的配置文件 _config.yml 找到 permalink：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- permalink: :year/:month/:day/:title/</span></span><br><span class="line">#修改为</span><br><span class="line"><span class="addition">+permalink: post/:abbrlink.html # post为自定义前缀</span></span><br><span class="line"><span class="addition">+ abbrlink:</span></span><br><span class="line"><span class="addition">+    alg: crc32   #算法： crc16(default) and crc32</span></span><br><span class="line"><span class="addition">+    rep: hex     #进制： dec(default) and hex</span></span><br></pre></td></tr></table></figure><h2 id="公告2个小人"><a href="#公告2个小人" class="headerlink" title="公告2个小人"></a>公告2个小人</h2><p>1、在<code>Butterfly/layout/includes/widget/card_announcement.pug</code>下添加如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> .<span class="title function_">xpand</span>(style=<span class="string">&#x27;height:200px;&#x27;</span>)</span><br><span class="line">  canvas.<span class="title function_">illo</span>(width=<span class="string">&#x27;800&#x27;</span> height=<span class="string">&#x27;800&#x27;</span> style=<span class="string">&#x27;max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;&#x27;</span>)</span><br><span class="line"><span class="title function_">script</span>(src=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople1.js&#x27;</span>)</span><br><span class="line"><span class="title function_">script</span>(src=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/zdog.dist.js&#x27;</span>)</span><br><span class="line">script#rendered-<span class="title function_">js</span>(src=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/xiaopengand/blogCdn@latest/xzxr/twopeople.js&#x27;</span>)</span><br><span class="line">style.</span><br><span class="line">  .<span class="property">card</span>-widget.<span class="property">card</span>-announcement &#123;</span><br><span class="line">  <span class="attr">margin</span>: <span class="number">0</span>;</span><br><span class="line">  align-<span class="attr">items</span>: center;</span><br><span class="line">  justify-<span class="attr">content</span>: center;</span><br><span class="line">  text-<span class="attr">align</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line">  canvas &#123;</span><br><span class="line">  <span class="attr">display</span>: block;</span><br><span class="line">  <span class="attr">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attr">cursor</span>: move;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="星空背景和流星特效"><a href="#星空背景和流星特效" class="headerlink" title="星空背景和流星特效"></a>星空背景和流星特效</h2><blockquote><p>转自 <a href="https://blog.justlovesmile.top/posts/6a260bf6.html">Justlovesmile 《如何让你的博客拥有星空背景和流星特效》</a> 仅用于学习</p></blockquote><p>1、在 <code>[Blogroot]\themes\source\js\</code> 目录下新建 <code>universe.js</code> 输入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">dark</span>(<span class="params"></span>) &#123;<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>=<span class="variable language_">window</span>.<span class="property">requestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">mozRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">webkitRequestAnimationFrame</span>||<span class="variable language_">window</span>.<span class="property">msRequestAnimationFrame</span>;<span class="keyword">var</span> n,e,i,h,t=<span class="number">.05</span>,s=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;universe&quot;</span>),o=!<span class="number">0</span>,a=<span class="string">&quot;180,184,240&quot;</span>,r=<span class="string">&quot;226,225,142&quot;</span>,d=<span class="string">&quot;226,225,224&quot;</span>,c=[];<span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>)&#123;n=<span class="variable language_">window</span>.<span class="property">innerWidth</span>,e=<span class="variable language_">window</span>.<span class="property">innerHeight</span>,i=<span class="number">.216</span>*n,s.<span class="title function_">setAttribute</span>(<span class="string">&quot;width&quot;</span>,n),s.<span class="title function_">setAttribute</span>(<span class="string">&quot;height&quot;</span>,e)&#125;<span class="keyword">function</span> <span class="title function_">u</span>(<span class="params"></span>)&#123;h.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,n,e);<span class="keyword">for</span>(<span class="keyword">var</span> t=c.<span class="property">length</span>,i=<span class="number">0</span>;i&lt;t;i++)&#123;<span class="keyword">var</span> s=c[i];s.<span class="title function_">move</span>(),s.<span class="title function_">fadeIn</span>(),s.<span class="title function_">fadeOut</span>(),s.<span class="title function_">draw</span>()&#125;&#125;<span class="keyword">function</span> <span class="title function_">y</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">reset</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">giant</span>=<span class="title function_">m</span>(<span class="number">3</span>),<span class="variable language_">this</span>.<span class="property">comet</span>=!<span class="variable language_">this</span>.<span class="property">giant</span>&amp;&amp;!o&amp;&amp;<span class="title function_">m</span>(<span class="number">10</span>),<span class="variable language_">this</span>.<span class="property">x</span>=<span class="title function_">l</span>(<span class="number">0</span>,n-<span class="number">10</span>),<span class="variable language_">this</span>.<span class="property">y</span>=<span class="title function_">l</span>(<span class="number">0</span>,e),<span class="variable language_">this</span>.<span class="property">r</span>=<span class="title function_">l</span>(<span class="number">1.1</span>,<span class="number">2.6</span>),<span class="variable language_">this</span>.<span class="property">dx</span>=<span class="title function_">l</span>(t,<span class="number">6</span>*t)+(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>)+<span class="number">2</span>*t,<span class="variable language_">this</span>.<span class="property">dy</span>=-<span class="title function_">l</span>(t,<span class="number">6</span>*t)-(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)*t*<span class="title function_">l</span>(<span class="number">50</span>,<span class="number">120</span>),<span class="variable language_">this</span>.<span class="property">fadingOut</span>=<span class="literal">null</span>,<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!<span class="number">0</span>,<span class="variable language_">this</span>.<span class="property">opacity</span>=<span class="number">0</span>,<span class="variable language_">this</span>.<span class="property">opacityTresh</span>=<span class="title function_">l</span>(<span class="number">.2</span>,<span class="number">1</span>-<span class="number">.4</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)),<span class="variable language_">this</span>.<span class="property">do</span>=<span class="title function_">l</span>(<span class="number">5e-4</span>,<span class="number">.002</span>)+<span class="number">.001</span>*(<span class="variable language_">this</span>.<span class="property">comet</span>+<span class="number">1</span>-<span class="number">1</span>)&#125;,<span class="variable language_">this</span>.<span class="property">fadeIn</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingIn</span>&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingIn</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&gt;<span class="variable language_">this</span>.<span class="property">opacityTresh</span>),<span class="variable language_">this</span>.<span class="property">opacity</span>+=<span class="variable language_">this</span>.<span class="property">do</span>)&#125;,<span class="variable language_">this</span>.<span class="property">fadeOut</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!(<span class="variable language_">this</span>.<span class="property">opacity</span>&lt;<span class="number">0</span>),<span class="variable language_">this</span>.<span class="property">opacity</span>-=<span class="variable language_">this</span>.<span class="property">do</span>/<span class="number">2</span>,(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">1</span>,<span class="variable language_">this</span>.<span class="title function_">reset</span>()))&#125;,<span class="variable language_">this</span>.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">if</span>(h.<span class="title function_">beginPath</span>(),<span class="variable language_">this</span>.<span class="property">giant</span>)h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+a+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">comet</span>)&#123;h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">arc</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="number">1.5</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">1</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;<span class="number">30</span>;t++)h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+d+<span class="string">&quot;,&quot;</span>+(<span class="variable language_">this</span>.<span class="property">opacity</span>-<span class="variable language_">this</span>.<span class="property">opacity</span>/<span class="number">20</span>*t)+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>-<span class="variable language_">this</span>.<span class="property">dx</span>/<span class="number">4</span>*t,<span class="variable language_">this</span>.<span class="property">y</span>-<span class="variable language_">this</span>.<span class="property">dy</span>/<span class="number">4</span>*t-<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>),h.<span class="title function_">fill</span>()&#125;<span class="keyword">else</span> h.<span class="property">fillStyle</span>=<span class="string">&quot;rgba(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+<span class="variable language_">this</span>.<span class="property">opacity</span>+<span class="string">&quot;)&quot;</span>,h.<span class="title function_">rect</span>(<span class="variable language_">this</span>.<span class="property">x</span>,<span class="variable language_">this</span>.<span class="property">y</span>,<span class="variable language_">this</span>.<span class="property">r</span>,<span class="variable language_">this</span>.<span class="property">r</span>);h.<span class="title function_">closePath</span>(),h.<span class="title function_">fill</span>()&#125;,<span class="variable language_">this</span>.<span class="property">move</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="variable language_">this</span>.<span class="property">x</span>+=<span class="variable language_">this</span>.<span class="property">dx</span>,<span class="variable language_">this</span>.<span class="property">y</span>+=<span class="variable language_">this</span>.<span class="property">dy</span>,!<span class="number">1</span>===<span class="variable language_">this</span>.<span class="property">fadingOut</span>&amp;&amp;<span class="variable language_">this</span>.<span class="title function_">reset</span>(),(<span class="variable language_">this</span>.<span class="property">x</span>&gt;n-n/<span class="number">4</span>||<span class="variable language_">this</span>.<span class="property">y</span>&lt;<span class="number">0</span>)&amp;&amp;(<span class="variable language_">this</span>.<span class="property">fadingOut</span>=!<span class="number">0</span>)&#125;,<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;o=!<span class="number">1</span>&#125;,<span class="number">50</span>)&#125;<span class="keyword">function</span> <span class="title function_">m</span>(<span class="params">t</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="number">1e3</span>*<span class="title class_">Math</span>.<span class="title function_">random</span>())+<span class="number">1</span>&lt;<span class="number">10</span>*t&#125;<span class="keyword">function</span> <span class="title function_">l</span>(<span class="params">t,i</span>)&#123;<span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">random</span>()*(i-t)+t&#125;<span class="title function_">f</span>(),<span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>,f,!<span class="number">1</span>),<span class="keyword">function</span>(<span class="params"></span>)&#123;h=s.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;i;t++)c[t]=<span class="keyword">new</span> y,c[t].<span class="title function_">reset</span>();<span class="title function_">u</span>()&#125;(),<span class="keyword">function</span> <span class="title function_">t</span>(<span class="params"></span>)&#123;<span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;html&#x27;</span>)[<span class="number">0</span>].<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>)==<span class="string">&#x27;dark&#x27;</span>&amp;&amp;<span class="title function_">u</span>(),<span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(t)&#125;()&#125;;</span><br><span class="line"><span class="title function_">dark</span>()</span><br></pre></td></tr></table></figure><p>2、在 <code>[Blogroot]\themes\source\css\</code> 目录下新建 <code>universe.css</code> 输入：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 背景宇宙星光  */</span></span><br><span class="line"><span class="selector-id">#universe</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、在 <code>[Blogroot]\_config.butterfly.yml</code> 的 <code>inject</code> 配置项中 <code>bottom</code> 下填入：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+# 星空背景</span></span><br><span class="line"><span class="addition">+    - &lt;canvas id=&quot;universe&quot;&gt;&lt;/canvas&gt;</span></span><br><span class="line"><span class="addition">+    - &lt;script defer src=&quot;/js/universe.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>4、在 <code>[Blogroot]\_config.butterfly.yml</code> 的 <code>inject</code> 配置项中 <code>head</code> 下填入：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+    ## 星空背景</span></span><br><span class="line"><span class="addition">+    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/universe.css&quot;&gt;</span></span><br></pre></td></tr></table></figure><h2 id="天气小部件"><a href="#天气小部件" class="headerlink" title="天气小部件"></a>天气小部件</h2><blockquote><p>转自<a href="https://sunguoqi.com/posts/32121.html"> 小孙同学《Butterfly 主题添加天气小部件》</a>仅用于学习。</p></blockquote><h3 id="申请天气-API"><a href="#申请天气-API" class="headerlink" title="申请天气 API"></a>申请天气 API</h3><p>国内天气API有多种，此处推荐 和风天气 ，如果您第一次使用和风天气，首先，您应该去官网注册一个账号，<a href="https://id.qweather.com/#/register"> 点我进入</a></p><p><a href="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012116465.jpg"><img src="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012116465.jpg"></a></p><p>申请账号并登录后，请到 和风天气开发平台 <a href="https://widget.qweather.com/create-simple">点我进入</a></p><p><a href="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012116769.jpg"><img src="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012116769.jpg"></a></p><p>配置插件的相关属性，首先，您应该为您的插件取一个名字，内容属性均可以自定义。</p><p>  注意：为了确保天气小部件的正常显示，这里选择固定在浏览器中，具体位置后续在调节。</p><p><a href="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012122302.jpg"><img src="https://cdn.jsdelivr.net/gh/sun0225SUN/photos/images/202109012122302.jpg"></a></p><p>设置完成后，选择下面的生成代码即可，生成的代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;he-plugin-simple&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable constant_">WIDGET</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;CONFIG&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;modules&quot;</span>: <span class="string">&quot;01234&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;background&quot;</span>: <span class="string">&quot;5&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;tmpColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;tmpSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;cityColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;citySize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;aqiColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;aqiSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;weatherIconSize&quot;</span>: <span class="string">&quot;24&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;alertIconSize&quot;</span>: <span class="string">&quot;18&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;padding&quot;</span>: <span class="string">&quot;10px 10px 10px 10px&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;shadow&quot;</span>: <span class="string">&quot;0&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;language&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;fixed&quot;</span>: <span class="string">&quot;true&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;vertical&quot;</span>: <span class="string">&quot;top&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;horizontal&quot;</span>: <span class="string">&quot;left&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;left&quot;</span>: <span class="string">&quot;10&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;top&quot;</span>: <span class="string">&quot;10&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;key&quot;</span>: <span class="string">&quot;您自己的key&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="添加-lt-div-gt"><a href="#添加-lt-div-gt" class="headerlink" title="添加 &lt;div&gt;"></a>添加 <code>&lt;div&gt;</code></h3><p>打开您的博客所在文件夹，在 blog\themes\butterfly\layout\includes\headers 目录下的 nav.pug 文件中添加以下内容。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;he-plugin-simple&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="添加-weather-js"><a href="#添加-weather-js" class="headerlink" title="添加 weather.js"></a>添加 <code>weather.js</code></h3><p>打开您的博客所在文件夹，在 blog\themes\butterfly\source\js 目录下添加 weather.js 文件，并填入一下内容。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">WIDGET</span> = &#123;</span><br><span class="line">  <span class="string">&quot;CONFIG&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;modules&quot;</span>: <span class="string">&quot;01234&quot;</span>,</span><br><span class="line">    <span class="string">&quot;background&quot;</span>: <span class="string">&quot;5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tmpColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tmpSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cityColor&quot;</span>: <span class="string">&quot;FF9900&quot;</span>,</span><br><span class="line">    <span class="string">&quot;citySize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aqiColor&quot;</span>: <span class="string">&quot;4A86E8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aqiSize&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">    <span class="string">&quot;weatherIconSize&quot;</span>: <span class="string">&quot;24&quot;</span>,</span><br><span class="line">    <span class="string">&quot;alertIconSize&quot;</span>: <span class="string">&quot;18&quot;</span>,</span><br><span class="line">    <span class="string">&quot;padding&quot;</span>: <span class="string">&quot;0px 0px 0px 0px&quot;</span>,</span><br><span class="line">    <span class="string">&quot;shadow&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;language&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">    <span class="string">&quot;fixed&quot;</span>: <span class="string">&quot;true&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vertical&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="string">&quot;horizontal&quot;</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">    <span class="string">&quot;left&quot;</span>: <span class="string">&quot;125&quot;</span>,</span><br><span class="line">    <span class="string">&quot;top&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">    <span class="string">&quot;key&quot;</span>: <span class="string">&quot;你的key&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Inject-引入"><a href="#Inject-引入" class="headerlink" title="Inject 引入"></a>Inject 引入</h3><p>在配置文件 _config.butterfly 的 inject 属性中引入以下代码。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">bottom:</span><br><span class="line"><span class="addition">+    ## 和风天气</span></span><br><span class="line"><span class="addition">+    - &lt;script async src=&quot;/js/weather.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="addition">+    - &lt;script src=&quot;https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="引入阿里矢量图标库"><a href="#引入阿里矢量图标库" class="headerlink" title="引入阿里矢量图标库"></a>引入阿里矢量图标库</h2><blockquote><p>转自 <a href="https://akilar.top/posts/d2ebecef/">Akilar《confont Inject》</a> 仅用于学习。</p></blockquote><p>阿里图标库全名阿里巴巴矢量图标库。提供了丰富的免费图标资源。并且支持多种引入方式。</p><h3 id="新建图标项目"><a href="#新建图标项目" class="headerlink" title="新建图标项目"></a>新建图标项目</h3><p>1、访问 <a href="https://www.iconfont.cn/">阿里巴巴矢量图标库</a> , 注册登录。</p><p>2、搜索自己心仪的图标，然后选择<strong>添加入库</strong>，加到购物车。</p><p>3、选择完毕后点击右上角的购物车图标，打开侧栏，选择添加到项目，如果没有项目就新建一个。</p><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/81982c3a.png"></p><p>4、可以通过上方顶栏菜单 -&gt; 资源管理 -&gt; 我的项目，找到之前添加的图标项目。</p><p>5、现在的 iconfont 可以在图标库的项目设置里直接打开彩色设置，然后采用 fontclass 的引用方式即可使用多彩图标。但是<strong>单一项目彩色图标上限是 40 个图标</strong>，酌情采用。</p><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/a11217c7.png"><br><img src="https://npm.elemecdn.com/akilar-candyassets/image/110a882c.png"></p><h3 id="引入图标"><a href="#引入图标" class="headerlink" title="引入图标"></a>引入图标</h3><p>1、找到之前新建的图标项目，选择Symbol-&gt;查看在线链接，获取 <code>Symbol.js</code> 的在线链接，并引入。在 <code>[Blogroot]\_config.butterfly.yml</code> 的 <code>inject</code> 配置项中填入：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    inject:</span><br><span class="line">      head:</span><br><span class="line">      bottom:</span><br><span class="line"><span class="addition">+       - &lt;script async src=&quot;//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>2、打开 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code>, 输入以下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">svg<span class="selector-class">.icon</span> &#123;</span><br><span class="line">   <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">   <span class="comment">/* width和height定义图标的默认宽度和高度*/</span></span><br><span class="line">   <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">   fill: currentColor;</span><br><span class="line">   <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、添加外挂标签，在 <code>[Blogroot]\themes\butterfly\scripts\tag\</code> 目录下新建 <code>iconfont.js</code>，打开 <code>[Blogroot]\themes\butterfly\scripts\tag\iconfont.js</code>, 输入：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">iconFont</span>(<span class="params">args</span>) &#123;</span><br><span class="line">  args = args.<span class="title function_">join</span>(<span class="string">&#x27; &#x27;</span>).<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">  <span class="keyword">let</span> p0 = args[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">let</span> p1 = args[<span class="number">1</span>]?args[<span class="number">1</span>]:<span class="number">1</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;svg class=&quot;icon&quot; style=&quot;width:<span class="subst">$&#123;p1&#125;</span>em; height:<span class="subst">$&#123;p1&#125;</span>em&quot; aria-hidden=&quot;true&quot;&gt;&lt;use xlink:href=&quot;#<span class="subst">$&#123;p0&#125;</span>&quot;&gt;&lt;/use&gt;&lt;/svg&gt;`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">tag</span>.<span class="title function_">register</span>(<span class="string">&#x27;icon&#x27;</span>,iconFont);</span><br></pre></td></tr></table></figure><p><code>hexo cl &amp;&amp; hexo g</code> 以后即可使用外挂标签的形式来写入图标了。</p><h2 id="封面节日挂件效果"><a href="#封面节日挂件效果" class="headerlink" title="封面节日挂件效果"></a>封面节日挂件效果</h2><p>1、新建 <code>[Blogroot]\themes\butterfly\scripts\festival.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">helper</span>.<span class="title function_">register</span>(<span class="string">&#x27;getFestivalIcon&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> icon = [</span><br><span class="line">        <span class="string">&#x27;#icon-qiandai&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-denglong&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-juanzhou&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-hongbao&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-duilian&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-bianpao&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-shanzi&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-tangguo&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-yuanbao&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-qianchuan&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;#icon-denglong2&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">var</span> index = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*icon.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">return</span> icon[index]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>2、修改 <code>[Blogroot]\themes\butterfly\layout\includes\mixins\post-ui.pug</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  if post_cover &amp;&amp; theme.cover.index_enable</span><br><span class="line">    .post_cover(class=leftOrRight)</span><br><span class="line">      a(href=url_for(link) title=title)</span><br><span class="line"><span class="addition">+       svg.icon.festival-decoration(aria-hidden=&quot;true&quot;)</span></span><br><span class="line"><span class="addition">+         use(xlink:href=getFestivalIcon())    </span></span><br><span class="line">        if theme.lazyload.enable</span><br><span class="line">          img.post_bg(data-lazy-src=url_for(post_cover) onerror=`this.onerror=null;this.src=&#x27;`+ url_for(theme.error_img.post_page) + `&#x27;` alt=title)</span><br><span class="line">        else</span><br><span class="line">          img.post_bg(src=url_for(post_cover) onerror=`this.onerror=null;this.src=&#x27;`+ url_for(theme.error_img.post_page) + `&#x27;` alt=title)</span><br></pre></td></tr></table></figure><p>3、新建 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">svg<span class="selector-class">.icon</span><span class="selector-class">.festival-decoration</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">3em</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">3em</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: -<span class="number">3em</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    -webkit-<span class="attribute">animation</span>: sway <span class="number">1s</span> infinite ease-in-out alternate;</span><br><span class="line">    <span class="attribute">animation</span>: sway <span class="number">1s</span> infinite ease-in-out alternate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> sway &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">20deg</span>);</span><br><span class="line">    <span class="attribute">transform-origin</span>: center top;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">20deg</span>);</span><br><span class="line">    <span class="attribute">transform-origin</span>: center top;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> sway &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">20deg</span>);</span><br><span class="line">    <span class="attribute">transform-origin</span>: center top;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">20deg</span>);</span><br><span class="line">    <span class="attribute">transform-origin</span>: center top;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、修改<code>_config.butterfly.yml</code> 的 <code>inject</code> 配置项，引入 <code>custom.css</code> 和 <code>iconfont</code> 的 <code>js</code>，此处为我的图标库链接，熟练掌握前置教程后可以换成自己的：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span><br><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom.css&quot;  media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt; #教学用样式</span><br><span class="line">  bottom:</span><br><span class="line">    # 阿里矢量图标</span><br><span class="line">    - &lt;script async src=&quot;//at.alicdn.com/t/font_2032782_ev6ytrh30f.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="时间轴生肖图标"><a href="#时间轴生肖图标" class="headerlink" title="时间轴生肖图标"></a>时间轴生肖图标</h2><blockquote><p>转自 <a href="https://akilar.top/posts/22257072/">Akilar《Archive Beautify》</a> 仅用于学习。</p></blockquote><p>需要使用阿里矢量图标的 symbol 引入方案，为彩色图标。</p><p>1、在 <code>[Blogroot]\themes\butterfly\scripts\</code> 目录下新建 <code>year.js</code>，并在 <code>[Blogroot]\themes\butterfly\scripts\year.js</code> 中输入以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hexo.<span class="property">extend</span>.<span class="property">helper</span>.<span class="title function_">register</span>(<span class="string">&#x27;getAnimalIcon&#x27;</span>, <span class="keyword">function</span> (<span class="params">year</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> index = <span class="built_in">parseInt</span>(year) % <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">var</span> icon = &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="string">&#x27;icon-monkey&#x27;</span>,</span><br><span class="line">        <span class="number">1</span>: <span class="string">&#x27;icon-rooster&#x27;</span>,</span><br><span class="line">        <span class="number">2</span>: <span class="string">&#x27;icon-dog&#x27;</span>,</span><br><span class="line">        <span class="number">3</span>: <span class="string">&#x27;icon-boar&#x27;</span>,</span><br><span class="line">        <span class="number">4</span>: <span class="string">&#x27;icon-rat&#x27;</span>,</span><br><span class="line">        <span class="number">5</span>: <span class="string">&#x27;icon-ox&#x27;</span>,</span><br><span class="line">        <span class="number">6</span>: <span class="string">&#x27;icon-tiger&#x27;</span>,</span><br><span class="line">        <span class="number">7</span>: <span class="string">&#x27;icon-rabbit&#x27;</span>,</span><br><span class="line">        <span class="number">8</span>: <span class="string">&#x27;icon-dragon&#x27;</span>,</span><br><span class="line">        <span class="number">9</span>: <span class="string">&#x27;icon-snake&#x27;</span>,</span><br><span class="line">        <span class="number">10</span>: <span class="string">&#x27;icon-horse&#x27;</span>,</span><br><span class="line">        <span class="number">11</span>: <span class="string">&#x27;icon-goat&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> icon[index]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>2、在 <code>[Blogroot]\_config.butterfly.yml</code> 的 <code>inject</code> 配置项中填入我的生肖图标线上链接，并引入自定义 css 文件（没有 <code>custom.css</code> 文件的可以自己新建一个 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code>）：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    inject:</span><br><span class="line">      head:</span><br><span class="line"><span class="addition">+       - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom.css&quot;  media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">      bottom:</span><br><span class="line"><span class="addition">+       - &lt;script async src=&quot;//at.alicdn.com/t/font_2264842_3izu8i5eoc2.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>此处 <code>async</code> 是异步加载属性，能够减少 HTML 阻塞。</p><p>3、打开 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code>, 输入以下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">svg<span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="comment">/* 这里定义svg.icon，避免和Butterfly自带的note标签冲突 */</span></span><br><span class="line">   <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">   <span class="comment">/* width和height定义图标的默认宽度和高度*/</span></span><br><span class="line">   <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">   fill: currentColor;</span><br><span class="line">   <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、修改 <code>[Blogroot]\themes\butterfly\layout\includes\mixins\article-sort.pug</code>，第 7 行开始，注意缩进。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    - let title = article.title || _p(&#x27;no_title&#x27;)</span><br><span class="line"><span class="addition">+   - let iconAnimal = &#x27;#&#x27;+ getAnimalIcon(tempYear)</span></span><br><span class="line">    if tempYear !== year</span><br><span class="line">      - year = tempYear</span><br><span class="line"><span class="deletion">-     .article-sort-item.year= year</span></span><br><span class="line"><span class="addition">+     .article-sort-item.year</span></span><br><span class="line"><span class="addition">+       span= year</span></span><br><span class="line"><span class="addition">+       svg.icon(aria-hidden=&#x27;true&#x27;)</span></span><br><span class="line"><span class="addition">+         use(xlink:href=iconAnimal)</span></span><br><span class="line">    .article-sort-item(class=no_cover)</span><br><span class="line">      if article.cover &amp;&amp; theme.cover.archives_enable</span><br></pre></td></tr></table></figure><h2 id="添加看板娘"><a href="#添加看板娘" class="headerlink" title="添加看板娘"></a>添加看板娘</h2><blockquote><p>转自 <a href="https://akilar.top/posts/5b8f515f/">Akilar《Live2d Widget》</a> 仅用于学习。</p></blockquote><p>1、在<code>[Blogroot]\themes\butterfly\source\</code>目录下打开终端,输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/stevenjoezhang/live2d-widget.git live2d-widget</span><br></pre></td></tr></table></figure><p>2、找到路径<code>[Blogroot]\themes\butterfly\source\live2d-widget\autoload.js</code>，打开<code>autoload.js</code>，修改内容：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- const live2d_path = &quot;https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/&quot;;</span></span><br><span class="line"><span class="addition">+ const live2d_path = &quot;/live2d-widget/&quot;;</span></span><br></pre></td></tr></table></figure><p>3、在<code>Butterfly</code>的主题配置文件<code>[Blogroot]\_config.butterfly.yml</code>中,<br><code>butterfly</code>主题其实自带<code>fontawesome</code>依赖，无需引入，</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    # Inject</span><br><span class="line">    # Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span><br><span class="line">    # 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span><br><span class="line">    inject:</span><br><span class="line">      head:</span><br><span class="line">        # - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span><br><span class="line">      bottom:</span><br><span class="line">        # - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span><br><span class="line"><span class="addition">+       - &lt;script defer src=&quot;/live2d-widget/autoload.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="昼夜转换动画"><a href="#昼夜转换动画" class="headerlink" title="昼夜转换动画"></a>昼夜转换动画</h2><blockquote><p>转自 <a href="https://akilar.top/posts/d9550c81/">Akilar《添加白天夜间模式转换动画》</a> 仅用于学习。</p></blockquote><p>1、新建 <code>[Blogroot]\themes\butterfly\layout\includes\custom\sun_moon.pug</code>, 这部分其实实质上就是一个 svg 文件，通过 js 操作它的旋转显隐，淡入淡出实现动画效果。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">svg(aria-hidden=&#x27;true&#x27;, style=&#x27;position:absolute; overflow:hidden; width:0; height:0&#x27;)</span><br><span class="line">  symbol#icon-sun(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z&#x27;, fill=&#x27;#FFD878&#x27;, p-id=&#x27;8420&#x27;)</span><br><span class="line">    path(d=&#x27;M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z&#x27;, fill=&#x27;#FFE4A9&#x27;, p-id=&#x27;8421&#x27;)</span><br><span class="line">    path(d=&#x27;M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8422&#x27;)</span><br><span class="line">    path(d=&#x27;M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8423&#x27;)</span><br><span class="line">  symbol#icon-moon(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z&#x27;, fill=&#x27;#FFB531&#x27;, p-id=&#x27;11345&#x27;)</span><br><span class="line">    path(d=&#x27;M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z&#x27;, fill=&#x27;#030835&#x27;, p-id=&#x27;11346&#x27;)</span><br></pre></td></tr></table></figure><p>2、新建 <code>[Blogroot]\themes\butterfly\source\css\_layout\sun_moon.styl</code>：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Cuteen_DarkSky</span>,</span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">  <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">88888888</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">  <span class="attribute">background</span> linear-gradient(<span class="number">#feb8b0</span>, <span class="number">#fef9db</span>)</span><br><span class="line">  <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">    <span class="attribute">transition</span> <span class="number">2s</span> ease all</span><br><span class="line">    <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">background</span> linear-gradient(<span class="number">#4c3f6d</span>, <span class="number">#6c62bb</span>, <span class="number">#93b1ed</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.DarkMode</span></span><br><span class="line">  <span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">99999999</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">top</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">200%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">200%</span></span><br><span class="line">  -webkit-<span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> cubic-bezier(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> cubic-bezier(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">transform-origin</span> center bottom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    <span class="attribute">transform</span>: rotate(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">left</span> <span class="number">35%</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">40%</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attribute">background</span> linear-gradient(<span class="number">#fefefe</span>, <span class="number">#fffbe8</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span></span><br><span class="line">  <span class="selector-tag">span</span></span><br><span class="line">    <span class="attribute">display</span> none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menus_item</span></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">text-decoration</span> none<span class="meta">!important</span></span><br><span class="line"><span class="comment">//按钮相关，对侧栏按钮做过魔改的可以调整这里的数值</span></span><br><span class="line"><span class="selector-class">.icon-V</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure><p>3、新建 <code>[Blogroot]\themes\butterfly\source\js\sun_moon.js</code>, 去除了冗余代码，去 jquery：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">switchNightMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;beforeend&#x27;</span>, <span class="string">&#x27;&lt;div class=&quot;Cuteen_DarkSky&quot;&gt;&lt;div class=&quot;Cuteen_DarkPlanet&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>),</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;DarkMode&#x27;</span>) ? (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;0&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)) : (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)),</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;opacity 3s&#x27;</span>;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">          <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="title function_">remove</span>();</span><br><span class="line">          &#125;, <span class="number">1e3</span>);</span><br><span class="line">        &#125;, <span class="number">2e3</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">const</span> nowMode = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (nowMode === <span class="string">&#x27;light&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">activateDarkMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;dark&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span> &amp;&amp; btf.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">day_to_night</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">activateLightMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// handle some cases</span></span><br><span class="line">  <span class="keyword">typeof</span> utterancesTheme === <span class="string">&#x27;function&#x27;</span> &amp;&amp; <span class="title function_">utterancesTheme</span>()</span><br><span class="line">  <span class="keyword">typeof</span> <span class="variable constant_">FB</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">loadFBComment</span>()</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">DISQUS</span> &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;disqus_thread&#x27;</span>).<span class="property">children</span>.<span class="property">length</span> &amp;&amp; <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">disqusReset</span>(), <span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、修改 <code>[Blogroot]\themes\butterfly\layout\includes\head.pug</code>, 在文件末位加上一行：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  //- global config</span><br><span class="line">  !=partial(&#x27;includes/head/config&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">  include ./head/config_site.pug</span><br><span class="line">  include ./head/noscript.pug</span><br><span class="line"></span><br><span class="line">  !=fragment_cache(&#x27;injectHeadJs&#x27;, function()&#123;return inject_head_js()&#125;)</span><br><span class="line"></span><br><span class="line">  !=fragment_cache(&#x27;injectHead&#x27;, function()&#123;return injectHtml(theme.inject.head)&#125;)</span><br><span class="line"><span class="addition">+ include ./custom/sun_moon.pug</span></span><br></pre></td></tr></table></figure><p>5、修改 <code>[Blogroot]\themes\butterfly\layout\includes\rightside.pug</code>, 把原本的昼夜切换按钮替换掉：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  when &#x27;translate&#x27;</span><br><span class="line">    if translate.enable</span><br><span class="line">      button#translateLink(type=&quot;button&quot; title=_p(&#x27;rightside.translate_title&#x27;))= translate.default</span><br><span class="line">  when &#x27;darkmode&#x27;</span><br><span class="line">    if darkmode.enable &amp;&amp; darkmode.button</span><br><span class="line"><span class="deletion">-     button#darkmode(type=&quot;button&quot; title=_p(&#x27;rightside.night_mode_title&#x27;))</span></span><br><span class="line"><span class="deletion">-       i.fas.fa-adjust</span></span><br><span class="line"><span class="addition">+     a.icon-V.hidden(onclick=&#x27;switchNightMode()&#x27;,  title=_p(&#x27;rightside.night_mode_title&#x27;))</span></span><br><span class="line"><span class="addition">+       svg(width=&#x27;25&#x27;, height=&#x27;25&#x27;, viewBox=&#x27;0 0 1024 1024&#x27;)</span></span><br><span class="line"><span class="addition">+         use#modeicon(xlink:href=&#x27;#icon-moon&#x27;)</span></span><br></pre></td></tr></table></figure><p>6、修改 <code>[Blogroot]\_config.butterfly.yml</code>, 引入一下 js：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottome:</span><br><span class="line">    - &lt;script src=&quot;/js/sun_moon.js&quot; async&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>7、具体效果就自己切换下夜间模式看看吧。</p><h2 id="添加-Twikoo-评论"><a href="#添加-Twikoo-评论" class="headerlink" title="添加 Twikoo 评论"></a>添加 Twikoo 评论</h2><p><code>Twikoo</code> 是一个简洁、安全、无后端的静态网站评论系统，基于腾讯云开发。</p><h3 id="Vercel-部署"><a href="#Vercel-部署" class="headerlink" title="Vercel 部署"></a>Vercel 部署</h3><p>参考自 <a href="https://twikoo.js.org/">Twikoo 中文文档</a> ，Vercel 免费部署方式：<a href="https://www.bilibili.com/video/BV1Fh411e7ZH">查看视频教程</a>。</p><ol><li>申请 <a href="https://www.mongodb.com/cloud/atlas/register">MongoDB (opens new window)</a> 账号。</li><li>创建免费 MongoDB 数据库，区域推荐选择 <code>AWS / N. Virginia (us-east-1)</code></li><li>在 Clusters 页面点击 CONNECT，按步骤设置允许所有 IP 地址的连接（<a href="https://vercel.com/support/articles/how-to-allowlist-deployment-ip-address">为什么？ (opens new window)</a>），创建数据库用户，并记录数据库连接字符串，请将连接字符串中的 <code>&lt;password&gt;</code> 修改为数据库密码</li><li>申请 <a href="https://vercel.com/signup">Vercel (opens new window) </a>账号</li><li>点击以下按钮将 Twikoo 一键部署到 Vercel<br><a href="https://vercel.com/import/project?template=https://github.com/imaegoo/twikoo/tree/dev/src/vercel-min"><img src="https://vercel.com/button" alt="img">(opens new window)</a></li><li>进入 Settings - Environment Variables，添加环境变量 <code>MONGODB_URI</code>，值为第 3 步的数据库连接字符串</li><li>进入 Overview，点击 Domains 下方的链接，如果环境配置正确，可以看到 “Twikoo 云函数运行正常” 的提示</li><li>Vercel Domains（包含 <code>https://</code> 前缀，例如 <code>https://xxx.vercel.app</code>）即为您的 <code>环境ID (envId)</code></li></ol><h3 id="前端部署"><a href="#前端部署" class="headerlink" title="前端部署"></a>前端部署</h3><p>修改主题配置文件 <code>[Blogroot]\_config.butterfly.yml</code>，你只需要把获取到 Vercel 的 <code>环境ID (envId)</code> 填写到配置上去就行：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">twikoo:</span></span><br><span class="line">  <span class="attr">envId:</span></span><br><span class="line">  <span class="attr">region:</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">option:</span></span><br></pre></td></tr></table></figure><p>然后设置评论应用为</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="attr">use:</span> <span class="string">twikoo</span></span><br></pre></td></tr></table></figure><h2 id="Twikoo-评论块气泡风格魔改美化"><a href="#Twikoo-评论块气泡风格魔改美化" class="headerlink" title="Twikoo 评论块气泡风格魔改美化"></a>Twikoo 评论块气泡风格魔改美化</h2><blockquote><p>转自 <a href="https://akilar.top/posts/d99b5f01/">Akilar《twikoo 评论块气泡风格魔改美化》</a> 仅用于学习。</p></blockquote><p>1、新建 <code>[Blogroot]\themes\butterfly\source\css\custom\twikoo_beautify.css</code>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 自定义twikoo评论输入框高度 */</span></span><br><span class="line"><span class="selector-class">.tk-input</span><span class="selector-attr">[data-v-619b4c52]</span> <span class="selector-class">.el-textarea__inner</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">130px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 输入评论时自动隐藏输入框背景图片 */</span></span><br><span class="line"><span class="selector-class">.tk-input</span><span class="selector-attr">[data-v-619b4c52]</span> <span class="selector-class">.el-textarea__inner</span><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 调整楼中楼样式 ，整体左移，贴合气泡化效果 */</span></span><br><span class="line"><span class="selector-class">.tk-replies</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> + <span class="number">70px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 头像宽度调整 rem单位与全局字体大小挂钩，需配合自己情况调整大小以保证头像显示完整*/</span></span><br><span class="line"><span class="selector-class">.tk-replies</span> <span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-replies</span> <span class="selector-class">.tk-avatar</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 回复框左移，避免窄屏时出框 */</span></span><br><span class="line"><span class="selector-class">.tk-comments-container</span> <span class="selector-class">.tk-submit</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">70px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 评论块气泡化修改 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#00a6ff</span>; <span class="comment">/*默认模式访客气泡配色*/</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>; <span class="comment">/*默认模式访客气泡字体配色*/</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: visible <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">max-height</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 修复图片出框 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 修复过长文本出框 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> pre &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: pre-wrap;</span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#eeecaa</span>; <span class="comment">/*默认模式超链接配色*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">13px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#00a6ff</span>; <span class="comment">/*默认模式访客气泡小三角配色*/</span></span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ff8080</span>; <span class="comment">/*默认模式博主气泡配色*/</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>; <span class="comment">/*默认模式博主气泡字体配色*/</span></span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#eeecaa</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">13px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#ff8080</span>; <span class="comment">/*默认模式博主气泡小三角配色*/</span></span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-row</span><span class="selector-attr">[data-v-d82ce9a0]</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式配色，具体比照上方默认模式class */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#dfa036</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#dfa036</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 自适应内容 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">  <span class="comment">/* 设置宽度上限，避免挤压博主头像 */</span></span><br><span class="line">  <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">75%</span>;</span><br><span class="line">    <span class="attribute">width</span>: fit-content;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">75%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">15px</span> solid <span class="number">#ff8080</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">75%</span> + <span class="number">70px</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-row</span><span class="selector-attr">[data-v-d82ce9a0]</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">75%</span> - <span class="number">230px</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 设备名称常态隐藏，悬停评论时显示 */</span></span><br><span class="line"><span class="selector-class">.tk-extras</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span><span class="selector-pseudo">:hover</span> + <span class="selector-class">.tk-extras</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -moz-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -o-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -ms-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  <span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -webkit-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -moz-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -o-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -ms-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  <span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-moz-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-o-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、修改 <code>[Blogroot]\_config.butterfly.yml</code> 的 <code>inject</code> 配置项：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  inject:</span><br><span class="line">    head:</span><br><span class="line"><span class="addition">+     - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom/twikoo_beautify.css&quot;  media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure><h2 id="留言板动态弹出信封样式"><a href="#留言板动态弹出信封样式" class="headerlink" title="留言板动态弹出信封样式"></a>留言板动态弹出信封样式</h2><blockquote><p>转自 <a href="https://akilar.top/posts/e2d3c450/">Akilar《留言板动态弹出信封样式》</a> 仅用于学习。</p></blockquote><p>已发布插件版，具体配置方案请参看插件文档：<a href="https://www.npmjs.com/package/hexo-butterfly-envelope">hexo-butterfly-envelope</a>。</p><p>1、在 <code>[Blogroot]</code> 运行指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-envelope --save</span><br></pre></td></tr></table></figure><p>2、在站点配置文件或者主题配置文件添加配置项（对，两者任一均可。但不要都写）：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># envelope_comment</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/58900a8/</span></span><br><span class="line"><span class="attr">envelope_comment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#开关</span></span><br><span class="line">  <span class="attr">cover:</span> <span class="string">https://ae01.alicdn.com/kf/U5bb04af32be544c4b41206d9a42fcacfd.jpg</span> <span class="comment">#信笺封面图</span></span><br><span class="line">  <span class="attr">message:</span> <span class="comment">#信笺内容，支持多行</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想问的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想说的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">有什么想吐槽的？</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">哪怕是有什么想吃的，都可以告诉我哦~</span></span><br><span class="line">  <span class="attr">bottom:</span> <span class="string">自动书记人偶竭诚为您服务！</span> <span class="comment">#信笺结束语，只能单行</span></span><br><span class="line">  <span class="attr">height:</span> <span class="comment">#调整信笺划出高度，默认1050px</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】comments 的路径名称。默认为 comments，生成的页面为 comments/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】comments页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">留言板</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="引入-Aplayer-播放音乐"><a href="#引入-Aplayer-播放音乐" class="headerlink" title="引入 Aplayer 播放音乐"></a>引入 Aplayer 播放音乐</h2><blockquote><p>转自 <a href="https://akilar.top/posts/3afa069a/">Akilar《引入 Aplayer 播放音乐》</a> 仅用于学习。</p></blockquote><p>1、在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令安装 <a href="https://www.npmjs.com/package/hexo-tag-aplayer">hexo-tag-aplayer</a> 插件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-tag-aplayer --save</span><br></pre></td></tr></table></figure><p>2、在站点配置文件 <code>[Blogroot]\_config.yml</code> 中新增配置项，建议直接加在最底下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># APlayer</span></span><br><span class="line"><span class="comment"># https://github.com/MoePlayer/hexo-tag-aplayer/blob/master/docs/README-zh_cn.md</span></span><br><span class="line"><span class="attr">aplayer:</span></span><br><span class="line">  <span class="attr">meting:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">asset_inject:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>3、修改主题配置文件 <code>[Blogroot]\_config.butterfly.yml</code> 中关于 Aplayer 的配置内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject the css and script (aplayer/meting)</span></span><br><span class="line"><span class="attr">aplayerInject:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>4、在主题配置文件 <code>[Blogroot]\_config.butterfly.yml</code> 的 inject 配置项中添加 Aplayer 的容器。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;div</span> <span class="string">class=&quot;aplayer</span> <span class="literal">no</span><span class="string">-destroy&quot;</span> <span class="string">data-id=&quot;5183531430&quot;</span> <span class="string">data-server=&quot;netease&quot;</span> <span class="string">data-type=&quot;playlist&quot;</span> <span class="string">data-fixed=&quot;true&quot;</span> <span class="string">data-mini=&quot;true&quot;</span> <span class="string">data-listFolded=&quot;false&quot;</span> <span class="string">data-order=&quot;random&quot;</span> <span class="string">data-preload=&quot;none&quot;</span> <span class="string">data-autoplay=&quot;false&quot;</span> <span class="string">muted&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><p>5、在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>6、关于更换歌单的问题，大部分同学都因为只更改了 data-id 的值，所以出现歌单加载不出的情况，此处需要注意，<strong>data-id</strong>、<strong>data-server</strong>、<strong>data-type</strong> 分别对应了<code>歌单的id，歌单的服务商、歌单的类型</code><del>（感觉自己说了废话）</del>，所以需要确认这三项是一一对应的。</p><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/a163bdad.png"></p><p>如图中所示，找到网易云歌单的 url，<code>https://music.163.com/#/playlist?id=4907060762</code>, 此处的<strong>palylist</strong> 对应的就是<strong>data-type</strong> 的值，<strong>id</strong> 就是<strong>data-id</strong> 的值，而网易云的<strong>data-server</strong> 为<strong>netease</strong>，这个可以通过 Aplayer 的插件文档查阅到。 只有三个参数对应正确才能正常加载歌单。</p><p>7、Aplayer 的网易云歌单接口时不时的会挂掉，所以如果你确定你配置正确，但是歌单还是没有出现。不妨去看看其他人的站点是不是也没有 Aplayer 标签了来判断是 Aplayer 本身接口的问题还是自己配置出错的问题。</p><p>8、配置成功后会发现 Aplayer 的吸底标签一直占据着左下角的一片空间，对手机端阅读不太友好，可以添加一下 CSS 样式使其自动缩进隐藏。在 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code> 中 (没有这个文件就按照路径自己新建) 添加如下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-fixed</span><span class="selector-class">.aplayer-narrow</span> <span class="selector-class">.aplayer-body</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">66px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="comment">/* 默认情况下缩进左侧66px，只留一点箭头部分 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.aplayer</span><span class="selector-class">.aplayer-fixed</span><span class="selector-class">.aplayer-narrow</span> <span class="selector-class">.aplayer-body</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="comment">/* 鼠标悬停是左侧缩进归零，完全显示按钮 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>9、不要忘了到主题配置文件引入自定义样式，修改 <code>[Blogroot]_config.butterfly.yml</code> 的 <code>inject</code> 配置项：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  inject:</span><br><span class="line">    head:</span><br><span class="line"><span class="addition">+     - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom.css&quot;  media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">    bottom:</span><br><span class="line">      - &lt;div class=&quot;aplayer no-destroy&quot; data-id=&quot;5183531430&quot; data-server=&quot;netease&quot; data-type=&quot;playlist&quot; data-fixed=&quot;true&quot; data-mini=&quot;true&quot; data-listFolded=&quot;false&quot; data-order=&quot;random&quot; data-preload=&quot;none&quot; data-autoplay=&quot;false&quot; muted&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="巫师施法特效"><a href="#巫师施法特效" class="headerlink" title="巫师施法特效"></a>巫师施法特效</h2><blockquote><p>转自 <a href="https://akilar.top/posts/3d221bf2/">Akilar《Loading Animation》</a> 仅用于学习。</p></blockquote><p>1、修改 <code>[Blogroot]\themes\butterfly\layout\includes\loading\loading.pug</code>，本教程算上默认的旋转盒子加载动画，一共提供7种款式，读者可以根据代码结构自行改写移除不需要的内容。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">if theme.preloader.enable</span><br><span class="line">  case theme.preloader.load_style    </span><br><span class="line">    when &#x27;gear&#x27;</span><br><span class="line">      include ./load_style/gear.pug</span><br><span class="line">    when &#x27;ironheart&#x27;</span><br><span class="line">      include ./load_style/ironheart.pug</span><br><span class="line">    when &#x27;scarecrow&#x27;</span><br><span class="line">      include ./load_style/scarecrow.pug</span><br><span class="line">    when &#x27;triangles&#x27;</span><br><span class="line">      include ./load_style/triangles.pug</span><br><span class="line">    when &#x27;wizard&#x27;</span><br><span class="line">      include ./load_style/wizard.pug</span><br><span class="line">    when &#x27;image&#x27;</span><br><span class="line">      include ./load_style/image.pug</span><br><span class="line">    default</span><br><span class="line">      include ./load_style/default.pug</span><br></pre></td></tr></table></figure><p>2、新建<code>[Blogroot]\themes\butterfly\layout\includes\loading\load_style\wizard.pug</code>,这是<del>无限施法老头</del>巫师施法加载动画。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#loading-box</span><br><span class="line">  .loading-left-bg</span><br><span class="line">  .loading-right-bg</span><br><span class="line">  .wizard-scene</span><br><span class="line">    .wizard-objects</span><br><span class="line">      .wizard-square</span><br><span class="line">      .wizard-circle</span><br><span class="line">      .wizard-triangle</span><br><span class="line">    .wizard</span><br><span class="line">      .wizard-body</span><br><span class="line">      .wizard-right-arm</span><br><span class="line">        .wizard-right-hand</span><br><span class="line">      .wizard-left-arm</span><br><span class="line">        .wizard-left-hand</span><br><span class="line">      .wizard-head</span><br><span class="line">        .wizard-beard</span><br><span class="line">        .wizard-face</span><br><span class="line">          .wizard-adds</span><br><span class="line">        .wizard-hat</span><br><span class="line">          .wizard-hat-of-the-hat</span><br><span class="line">          .wizard-four-point-star.--first</span><br><span class="line">          .wizard-four-point-star.--second</span><br><span class="line">          .wizard-four-point-star.--third</span><br></pre></td></tr></table></figure><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/wizard.gif"></p><p>3、修改<code>[Blogroot]\themes\butterfly\source\css\_layout\loading.styl</code>，复制以下代码替换全部内容：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.enable&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;gear&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/gear&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;ironheart&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/ironheart&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;scarecrow&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/scarecrow&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;triangles&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/triangles&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;wizard&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/wizard&#x27;</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;preloader.load_style&#x27;</span>) == <span class="string">&#x27;image&#x27;</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/image&#x27;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">@import</span> <span class="string">&#x27;./_load_style/default&#x27;</span></span><br></pre></td></tr></table></figure><p>4、新建<code>[Blogroot]\themes\butterfly\source\css\_load_style\wizard.styl</code>：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.loading-bg</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">1000</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">50%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">background</span> var(--preloader-bg)</span><br><span class="line"><span class="selector-id">#loading-box</span></span><br><span class="line">  <span class="selector-class">.loading-left-bg</span></span><br><span class="line">    <span class="keyword">@extend</span> <span class="selector-class">.loading-bg</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="selector-class">.loading-right-bg</span></span><br><span class="line">    <span class="keyword">@extend</span> <span class="selector-class">.loading-bg</span></span><br><span class="line">    <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">  &amp;<span class="selector-class">.loaded</span></span><br><span class="line">    <span class="attribute">z-index</span> -<span class="number">1000</span></span><br><span class="line">    <span class="selector-class">.loading-left-bg</span></span><br><span class="line">      <span class="attribute">transition</span> all <span class="number">1.0s</span></span><br><span class="line">      <span class="attribute">transform</span> translate(-<span class="number">100%</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="selector-class">.loading-right-bg</span></span><br><span class="line">      <span class="attribute">transition</span> all <span class="number">1.0s</span></span><br><span class="line">      <span class="attribute">transform</span> translate(<span class="number">100%</span>, <span class="number">0</span>)</span><br><span class="line"><span class="selector-id">#loading-box</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">1000</span></span><br><span class="line">  <span class="attribute">display</span> -webkit-box</span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line">  -webkit-box-align center</span><br><span class="line">  <span class="attribute">align-items</span> center</span><br><span class="line">  -webkit-box-pack center</span><br><span class="line">  <span class="attribute">justify-content</span> center</span><br><span class="line">  -webkit-box-orient vertical</span><br><span class="line">  -webkit-box-<span class="attribute">direction</span> normal</span><br><span class="line">  <span class="attribute">flex-direction</span> column</span><br><span class="line">  <span class="attribute">flex-wrap</span> wrap</span><br><span class="line">  <span class="attribute">width</span> <span class="number">100vw</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">100vh</span></span><br><span class="line">  <span class="attribute">overflow</span> hidden</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.loaded</span></span><br><span class="line">    <span class="selector-class">.wizard-scene</span></span><br><span class="line">      <span class="attribute">display</span> none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-scene</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">1001</span></span><br><span class="line">  <span class="attribute">display</span> -webkit-box</span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard</span></span><br><span class="line">  <span class="attribute">position</span> relative</span><br><span class="line">  <span class="attribute">width</span> <span class="number">190px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">240px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-body</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">68px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">60px</span></span><br><span class="line">  <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">  <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">60px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> skewX(<span class="number">14deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> skewX(<span class="number">14deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-right-arm</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">74px</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">110px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">44px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">90px</span></span><br><span class="line">  <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">22px</span></span><br><span class="line">  -webkit-<span class="attribute">transform-origin</span> <span class="number">16px</span> <span class="number">22px</span></span><br><span class="line">  <span class="attribute">transform-origin</span> <span class="number">16px</span> <span class="number">22px</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> right_arm <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> right_arm <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-class">.right-hand</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">right</span> <span class="number">8px</span></span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">8px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">30px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">    -webkit-<span class="attribute">transform-origin</span> center center</span><br><span class="line">    <span class="attribute">transform-origin</span> center center</span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    -webkit-<span class="attribute">animation</span> right_hand <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">    <span class="attribute">animation</span> right_hand <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-class">.wizard-right-hand</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">right</span> <span class="number">0px</span></span><br><span class="line">      <span class="attribute">top</span> -<span class="number">8px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">15px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">10px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">      -webkit-<span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">      <span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">      -webkit-<span class="attribute">animation</span> right_finger <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">      <span class="attribute">animation</span> right_finger <span class="number">10s</span> ease-in-out infinite</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-left-arm</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">74px</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">26px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">44px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">70px</span></span><br><span class="line">  <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span> <span class="number">8px</span></span><br><span class="line">  -webkit-<span class="attribute">transform-origin</span> <span class="number">60px</span> <span class="number">26px</span></span><br><span class="line">  <span class="attribute">transform-origin</span> <span class="number">60px</span> <span class="number">26px</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> left_arm <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> left_arm <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-class">.wizard-left-hand</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">left</span> -<span class="number">18px</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">18px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line">    <span class="attribute">border-top-left-radius</span> <span class="number">35px</span></span><br><span class="line">    <span class="attribute">border-bottom-left-radius</span> <span class="number">35px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">30px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">15px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">      -webkit-<span class="attribute">transform-origin</span> right bottom</span><br><span class="line">      <span class="attribute">transform-origin</span> right bottom</span><br><span class="line">      -webkit-<span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">      <span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">      -webkit-<span class="attribute">animation</span> left_finger <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">      <span class="attribute">animation</span> left_finger <span class="number">10s</span> ease-in-out infinite</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-head</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">14px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">160px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">210px</span></span><br><span class="line">  -webkit-<span class="attribute">transform-origin</span> center center</span><br><span class="line">  <span class="attribute">transform-origin</span> center center</span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> head <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> head <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-class">.wizard-beard</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">38px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">106px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">80px</span></span><br><span class="line">    <span class="attribute">border-bottom-right-radius</span> <span class="number">55%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#ffffff</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">16px</span></span><br><span class="line">      <span class="attribute">left</span> -<span class="number">10px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">40px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#ffffff</span></span><br><span class="line">  <span class="selector-class">.wizard-face</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">76px</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">38px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">60px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0px</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">40px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">40px</span></span><br><span class="line">      <span class="attribute">border-bottom-right-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-bottom-left-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">16px</span></span><br><span class="line">      <span class="attribute">left</span> -<span class="number">10px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">50px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-bottom-right-radius</span> <span class="number">0px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#ffffff</span></span><br><span class="line">    <span class="selector-class">.wizard-adds</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0px</span></span><br><span class="line">      <span class="attribute">left</span> -<span class="number">10px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">40px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">      <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">        <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">top</span> <span class="number">5px</span></span><br><span class="line">        <span class="attribute">left</span> <span class="number">80px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">15px</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">        <span class="attribute">border-bottom-right-radius</span> <span class="number">20px</span></span><br><span class="line">        <span class="attribute">border-top-right-radius</span> <span class="number">20px</span></span><br><span class="line">        <span class="attribute">background</span> <span class="number">#f1c5b4</span></span><br><span class="line">  <span class="selector-class">.wizard-hat</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">106px</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">160px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::before</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> -<span class="number">70px</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">50%</span></span><br><span class="line">      -webkit-<span class="attribute">transform</span> translatex(-<span class="number">50%</span>)</span><br><span class="line">      <span class="attribute">transform</span> translatex(-<span class="number">50%</span>)</span><br><span class="line">      <span class="attribute">width</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">border-style</span> solid</span><br><span class="line">      <span class="attribute">border-width</span> <span class="number">0</span> <span class="number">34px</span> <span class="number">70px</span> <span class="number">50px</span></span><br><span class="line">      <span class="attribute">border-color</span> transparent transparent <span class="number">#3f64ce</span> transparent</span><br><span class="line">    <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">160px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">20px</span></span><br><span class="line">      <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">20px</span></span><br><span class="line">    <span class="selector-class">.wizard-hat-of-the-hat</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">bottom</span> <span class="number">78px</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">79px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">border-style</span> solid</span><br><span class="line">      <span class="attribute">border-width</span> <span class="number">0</span> <span class="number">25px</span> <span class="number">25px</span> <span class="number">19px</span></span><br><span class="line">      <span class="attribute">border-color</span> transparent transparent <span class="number">#3f64ce</span> transparent</span><br><span class="line">      <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">        <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">top</span> <span class="number">6px</span></span><br><span class="line">        <span class="attribute">left</span> -<span class="number">4px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">35px</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">10px</span></span><br><span class="line">        <span class="attribute">border-radius</span> <span class="number">10px</span></span><br><span class="line">        <span class="attribute">border-bottom-left-radius</span> <span class="number">0px</span></span><br><span class="line">        <span class="attribute">background</span> <span class="number">#3f64ce</span></span><br><span class="line">        -webkit-<span class="attribute">transform</span> rotate(<span class="number">40deg</span>)</span><br><span class="line">        <span class="attribute">transform</span> rotate(<span class="number">40deg</span>)</span><br><span class="line">    <span class="selector-class">.wizard-four-point-star</span></span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">width</span> <span class="number">12px</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">12px</span></span><br><span class="line">      <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">        -webkit-<span class="attribute">transform</span> rotate(<span class="number">156.66deg</span>) skew(<span class="number">45deg</span>)</span><br><span class="line">        <span class="attribute">transform</span> rotate(<span class="number">156.66deg</span>) skew(<span class="number">45deg</span>)</span><br><span class="line">      &amp;.<span class="attr">--first</span></span><br><span class="line">        <span class="attribute">bottom</span> <span class="number">28px</span></span><br><span class="line">        <span class="attribute">left</span> <span class="number">46px</span></span><br><span class="line">      &amp;.<span class="attr">--second</span></span><br><span class="line">        <span class="attribute">bottom</span> <span class="number">40px</span></span><br><span class="line">        <span class="attribute">left</span> <span class="number">80px</span></span><br><span class="line">      &amp;.<span class="attr">--third</span></span><br><span class="line">        <span class="attribute">bottom</span> <span class="number">15px</span></span><br><span class="line">        <span class="attribute">left</span> <span class="number">108px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-head</span> <span class="selector-class">.wizard-hat</span> <span class="selector-class">.wizard-four-point-star</span><span class="selector-pseudo">::after</span>, <span class="selector-class">.wizard-head</span> <span class="selector-class">.wizard-hat</span> <span class="selector-class">.wizard-four-point-star</span><span class="selector-pseudo">::before</span></span><br><span class="line">  <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">background</span> <span class="number">#ffffff</span></span><br><span class="line">  <span class="attribute">display</span> block</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">141.4213%</span></span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">10%</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(<span class="number">66.66deg</span>) skewX(<span class="number">45deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(<span class="number">66.66deg</span>) skewX(<span class="number">45deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-objects</span></span><br><span class="line">  <span class="attribute">position</span> relative</span><br><span class="line">  <span class="attribute">width</span> <span class="number">200px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">240px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-square</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> -<span class="number">60px</span></span><br><span class="line">  <span class="attribute">left</span> -<span class="number">5px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">120px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">120px</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> path_square <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> path_square <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">top</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">50px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">50px</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#9ab3f5</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-circle</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">10px</span></span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">100px</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> path_circle <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> path_circle <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">bottom</span> -<span class="number">10px</span></span><br><span class="line">    <span class="attribute">left</span> <span class="number">25px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">50px</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">50px</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="number">#c56183</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.wizard-triangle</span></span><br><span class="line">  <span class="attribute">position</span> absolute</span><br><span class="line">  <span class="attribute">bottom</span> -<span class="number">62px</span></span><br><span class="line">  <span class="attribute">left</span> -<span class="number">10px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">110px</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">110px</span></span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">  -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">  -webkit-<span class="attribute">animation</span> path_triangle <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="attribute">animation</span> path_triangle <span class="number">10s</span> ease-in-out infinite</span><br><span class="line">  <span class="selector-pseudo">&amp;::after</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">right</span> -<span class="number">10px</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">border-style</span> solid</span><br><span class="line">    <span class="attribute">border-width</span> <span class="number">0</span> <span class="number">28px</span> <span class="number">48px</span> <span class="number">28px</span></span><br><span class="line">    <span class="attribute">border-color</span> transparent transparent <span class="number">#89beb3</span> transparent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 10s animation - 10% = 1s */</span></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> right_arm</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">20deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">20deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">26deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">26deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">9deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">9deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">74deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">74deg</span>)</span><br><span class="line">  <span class="number">62%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> right_arm</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">20deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">20deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">26deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">26deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">9deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">9deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">28deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">74deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">74deg</span>)</span><br><span class="line">  <span class="number">62%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">70deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> left_arm</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">17deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">17deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">74deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">74deg</span>)</span><br><span class="line">  <span class="number">62%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> left_arm</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">17deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">17deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">18deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">74deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">74deg</span>)</span><br><span class="line">  <span class="number">62%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">70deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> right_hand</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">20deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">20deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">60%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> right_hand</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">20deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">20deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">60deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">60%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">40deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> right_finger</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> none</span><br><span class="line">    <span class="attribute">transform</span> none</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> none</span><br><span class="line">    <span class="attribute">transform</span> none</span><br><span class="line">  <span class="number">60%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> right_finger</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> none</span><br><span class="line">    <span class="attribute">transform</span> none</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> none</span><br><span class="line">    <span class="attribute">transform</span> none</span><br><span class="line">  <span class="number">60%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">16px</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> left_finger</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> left_finger</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">15%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">20%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">8deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">8deg</span>)</span><br><span class="line">  <span class="number">25%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">30%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">  <span class="number">35%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">40%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">45%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">1</span>) rotate(<span class="number">6deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> scaleX(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> head</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translatex(<span class="number">10px</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translatex(<span class="number">10px</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translatex(<span class="number">0px</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translatex(<span class="number">0px</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">56%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> head</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translatex(<span class="number">10px</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translatex(<span class="number">10px</span>) rotate(<span class="number">7deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translatex(<span class="number">0px</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translatex(<span class="number">0px</span>) rotate(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">56%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">3deg</span>)</span><br><span class="line"><span class="comment">/** 10s animation - 10% = 1s */</span></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> path_circle</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> path_circle</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">5deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">5deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">100px</span>) rotate(-<span class="number">360deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> path_square</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">  <span class="number">57%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> path_square</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">  <span class="number">57%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">155px</span>) translatex(-<span class="number">15px</span>) rotate(-<span class="number">350deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> path_triangle</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> path_triangle</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(<span class="number">0</span>)</span><br><span class="line">  <span class="number">10%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">10deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">10deg</span>)</span><br><span class="line">  <span class="number">55%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">  <span class="number">58%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> translateY(-<span class="number">172px</span>) translatex(<span class="number">10px</span>) rotate(-<span class="number">365deg</span>)</span><br><span class="line">  <span class="number">63%</span></span><br><span class="line">    -webkit-<span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br><span class="line">    <span class="attribute">transform</span> rotate(-<span class="number">360deg</span>)</span><br></pre></td></tr></table></figure><p>5、修改<code>[Blogroot]\themes\butterfly\layout\includes\layout.pug</code>，以适配接下来需要添加的配置项：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    body</span><br><span class="line"><span class="deletion">-     if theme.preloader</span></span><br><span class="line"><span class="addition">+     if theme.preloader.enable</span></span><br><span class="line">        !=partial(&#x27;includes/loading/loading&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><p>6、修改<code>[Blogroot]\themes\butterfly\source\css\var.styl</code>，添加自定义修改背景色的配置项。(大概98行的位置)</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">      // preloader</span><br><span class="line"><span class="deletion">-     $preloader-bg = #37474f</span></span><br><span class="line"><span class="addition">+     $preloader-bg = hexo-config(&#x27;preloader.enable&#x27;) &amp;&amp; hexo-config(&#x27;preloader.load_color&#x27;) ? convert(hexo-config(&#x27;preloader.load_color&#x27;)) : #37474f</span></span><br><span class="line">      $preloader-word-color = #fff</span><br></pre></td></tr></table></figure><p>7、修改<code>[Blogroot]\_config.butterfly.yml</code>的<code>preloader</code>配置项。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    # Loading Animation (加載動畫)</span><br><span class="line"><span class="deletion">-   preloader: true</span></span><br><span class="line"><span class="addition">+   preloader:</span></span><br><span class="line"><span class="addition">+     enable: true # true|false</span></span><br><span class="line"><span class="addition">+     load_color: &#x27;#000000&#x27; # &#x27;#37474f&#x27;</span></span><br><span class="line"><span class="addition">+     load_style: wizard # default|gear|ironheart|scarecrow|triangles|wizard|image</span></span><br><span class="line"><span class="addition">+     load_image:  # url</span></span><br></pre></td></tr></table></figure><p>8、此项为非必要修改项，主要是为了避免使用<code>image</code>主题时，切换夜间模式后，背景色被强制覆盖为黑色<del>，说白了就是治疗强迫症</del>。修改<code>[Blogroot]\themes\butterfly\source\css\_mode\darkmode.styl</code>第10行的<code>--preloader-bg: darken(#121212, 2)</code>。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    --search-input-color: alpha(#FFFFFF, .7)</span><br><span class="line">    --search-result-title: alpha(#FFFFFF, .9)</span><br><span class="line"><span class="deletion">-   --preloader-bg: darken(#121212, 2)</span></span><br><span class="line"><span class="addition">+   --preloader-bg: darken(#ca3b3e, -2)</span></span><br><span class="line">    --preloader-color: alpha(#FFFFFF, .7)</span><br><span class="line">    --tab-border-color: #2c2c2c</span><br></pre></td></tr></table></figure><p>其中<code>#ca3b3e</code>是设置为image主题时，切换为夜间模式后，自定义图片的背景色值。（切换夜间模式时，整个页面会降低色调，所以连带着自定义图片的色值也变暗，需要重新取值。）</p><h2 id="首页置顶轮播图"><a href="#首页置顶轮播图" class="headerlink" title="首页置顶轮播图"></a>首页置顶轮播图</h2><blockquote><p>转自 <a href="https://akilar.top/posts/8e1264d1/">Akilar《Swiper Bar》</a> 仅用于学习。</p></blockquote><p>1、安装插件，在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-swiper --save</span><br></pre></td></tr></table></figure><p>2、添加配置信息，以下为写法示例<br>在站点配置文件<code>_config.yml</code> 或者主题配置文件<code>_config.butterfly.yml</code> 中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-swiper</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/8e1264d1/</span></span><br><span class="line"><span class="attr">swiper:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">timemode:</span> <span class="string">date</span> <span class="comment">#date/updated</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">default_descr:</span> <span class="string">再怎么看我也不知道怎么描述它的啦！</span></span><br><span class="line">  <span class="attr">swiper_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css</span> <span class="comment">#swiper css依赖</span></span><br><span class="line">  <span class="attr">swiper_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js</span> <span class="comment">#swiper js依赖</span></span><br><span class="line">  <span class="attr">custom_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css</span> <span class="comment"># 适配主题样式补丁</span></span><br><span class="line">  <span class="attr">custom_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js</span> <span class="comment"># swiper初始化方法</span></span><br></pre></td></tr></table></figure><p>3、在文章的 <code>front_matter</code> 中添加 <code>swiper_index</code> 配置项即可。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 文章标题</span><br><span class="line">date: 创建日期</span><br><span class="line">updated: 更新日期</span><br><span class="line">cover: 文章封面</span><br><span class="line">description: 文章描述</span><br><span class="line"><span class="section">swiper<span class="emphasis">_index: 1 #置顶轮播图顺序，非负整数，数字越大越靠前</span></span></span><br><span class="line"><span class="emphasis"><span class="section">---</span></span></span><br></pre></td></tr></table></figure><h2 id="gitcalendar"><a href="#gitcalendar" class="headerlink" title="gitcalendar"></a>gitcalendar</h2><blockquote><p>转自 <a href="https://akilar.top/posts/1f9c68c9/">Akilar《Gitcalendar》</a> 仅用于学习。</p></blockquote><p>1、安装插件，在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-filter-gitcalendar --save</span><br></pre></td></tr></table></figure><p>2、添加配置信息，以下为写法示例<br>在站点配置文件<code>_config.yml</code> 或者主题配置文件如<code>_config.butterfly.yml</code> 中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-filter-gitcalendar</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/1f9c68c9/</span></span><br><span class="line"><span class="attr">gitcalendar:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">/</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="comment"># butterfly挂载容器</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># volantis挂载容器</span></span><br><span class="line">  <span class="comment"># layout:</span></span><br><span class="line">  <span class="comment">#   type: class</span></span><br><span class="line">  <span class="comment">#   name: l_main</span></span><br><span class="line">  <span class="comment">#   index: 0</span></span><br><span class="line">  <span class="comment"># matery挂载容器</span></span><br><span class="line">  <span class="comment"># layout:</span></span><br><span class="line">  <span class="comment">#   type: id</span></span><br><span class="line">  <span class="comment">#   name: indexCard</span></span><br><span class="line">  <span class="comment">#   index: 0</span></span><br><span class="line">  <span class="comment"># mengd挂载容器</span></span><br><span class="line">  <span class="comment"># layout:</span></span><br><span class="line">  <span class="comment">#   type: class</span></span><br><span class="line">  <span class="comment">#   name: content</span></span><br><span class="line">  <span class="comment">#   index: 0</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">Akilarlxh</span> <span class="comment">#git用户名</span></span><br><span class="line">  <span class="attr">apiurl:</span> <span class="string">&#x27;https://gitcalendar.akilar.top&#x27;</span></span><br><span class="line">  <span class="attr">minheight:</span></span><br><span class="line">    <span class="attr">pc:</span> <span class="string">280px</span> <span class="comment">#桌面端最小高度</span></span><br><span class="line">    <span class="attr">mibile:</span> <span class="string">0px</span> <span class="comment">#移动端最小高度</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;[&#x27;#e4dfd7&#x27;, &#x27;#f9f4dc&#x27;, &#x27;#f7e8aa&#x27;, &#x27;#f7e8aa&#x27;, &#x27;#f8df72&#x27;, &#x27;#fcd217&#x27;, &#x27;#fcc515&#x27;, &#x27;#f28e16&#x27;, &#x27;#fb8b05&#x27;, &#x27;#d85916&#x27;, &#x27;#f43e06&#x27;]&quot;</span> <span class="comment">#橘黄色调</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#fdcdec&#x27;, &#x27;#fc9bd9&#x27;, &#x27;#fa6ac5&#x27;, &#x27;#f838b2&#x27;, &#x27;#f5089f&#x27;, &#x27;#c4067e&#x27;, &#x27;#92055e&#x27;, &#x27;#540336&#x27;, &#x27;#48022f&#x27;, &#x27;#30021f&#x27;]&quot; #浅紫色调</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#f0fff4&#x27;, &#x27;#dcffe4&#x27;, &#x27;#bef5cb&#x27;, &#x27;#85e89d&#x27;, &#x27;#34d058&#x27;, &#x27;#28a745&#x27;, &#x27;#22863a&#x27;, &#x27;#176f2c&#x27;, &#x27;#165c26&#x27;, &#x27;#144620&#x27;]&quot; #翠绿色调</span></span><br><span class="line">  <span class="comment"># color: &quot;[&#x27;#ebedf0&#x27;, &#x27;#f1f8ff&#x27;, &#x27;#dbedff&#x27;, &#x27;#c8e1ff&#x27;, &#x27;#79b8ff&#x27;, &#x27;#2188ff&#x27;, &#x27;#0366d6&#x27;, &#x27;#005cc5&#x27;, &#x27;#044289&#x27;, &#x27;#032f62&#x27;, &#x27;#05264c&#x27;]&quot; #天青色调</span></span><br><span class="line">  <span class="attr">container:</span> <span class="string">.recent-post-item(style=&#x27;width:100%;height:auto;padding:10px;&#x27;)</span> <span class="comment">#父元素容器，需要使用pug语法</span></span><br><span class="line">  <span class="attr">gitcalendar_css:</span> <span class="string">https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css</span></span><br><span class="line">  <span class="attr">gitcalendar_js:</span> <span class="string">https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js</span></span><br></pre></td></tr></table></figure><h2 id="侧边栏时钟"><a href="#侧边栏时钟" class="headerlink" title="侧边栏时钟"></a>侧边栏时钟</h2><blockquote><p>转自 <a href="https://akilar.top/posts/4e39cf4a/">Akilar《Sidebar Card Clock》</a> 仅用于学习。</p></blockquote><p>1、安装插件，在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-clock --save</span><br></pre></td></tr></table></figure><p>2、添加配置信息，以下为写法示例<br>在站点配置文件<code>_config.yml</code> 或者主题配置文件<code>_config.butterfly.yml</code> 中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># electric_clock</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/4e39cf4a/</span></span><br><span class="line"><span class="attr">electric_clock:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># 开关</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#过滤器优先权</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># 应用页面</span></span><br><span class="line">  <span class="attr">exclude:</span></span><br><span class="line">    <span class="comment"># - /posts/</span></span><br><span class="line">    <span class="comment"># - /about/</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># 挂载容器类型</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">class</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sticky_layout</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">loading:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-clock/lib/loading.gif</span> <span class="comment">#加载动画自定义</span></span><br><span class="line">  <span class="attr">clock_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.css</span></span><br><span class="line">  <span class="attr">clock_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-clock/lib/clock.min.js</span></span><br><span class="line">  <span class="attr">ip_api:</span> <span class="string">https://pv.sohu.com/cityjson?ie=utf-8</span></span><br></pre></td></tr></table></figure><h2 id="版权申明美化"><a href="#版权申明美化" class="headerlink" title="版权申明美化"></a>版权申明美化</h2><blockquote><p>转自 <a href="https://akilar.top/posts/8322f8e6/">Akilar《Copyright-beautify》</a> 仅用于学习。</p></blockquote><p>1、修改 <code>[Blogroot]\themes\butterfly\layout\includes\post\post-copyright.pug</code>, 直接复制以下内容替换原文件内容。此处多次用到了三元运算符作为默认项设置，在确保有主题配置文件的默认项的情况下，也可以在相应文章的 <code>front-matter</code> 中重新定义作者，原文链接，开源许可协议等内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">if theme.post_copyright.enable &amp;&amp; page.copyright !== false</span><br><span class="line">  - let author = page.copyright_author ? page.copyright_author : config.author</span><br><span class="line">  - let url = page.copyright_url ? page.copyright_url : page.permalink</span><br><span class="line">  - let license = page.license ? page.license : theme.post_copyright.license</span><br><span class="line">  - let license_url = page.license_url ? page.license_url : theme.post_copyright.license_url</span><br><span class="line">  .post-copyright</span><br><span class="line">    .post-copyright__title</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        h #[=page.title]</span><br><span class="line">    .post-copyright__type</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        a(href=url_for(url))= theme.post_copyright.decode ? decodeURI(url) : url</span><br><span class="line">    .post-copyright-m</span><br><span class="line">      .post-copyright-m-info</span><br><span class="line">        .post-copyright-a</span><br><span class="line">            h 作者</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=author</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 发布于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.date, config.date_format)</span><br><span class="line">        .post-copyright-u</span><br><span class="line">            h 更新于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.updated, config.date_format)</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 许可协议</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                a.icon(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=&#x27;Creative Commons&#x27; href=&#x27;https://creativecommons.org/&#x27;)</span><br><span class="line">                  i.fab.fa-creative-commons</span><br><span class="line">                a(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=license href=url_for(license_url))=license</span><br></pre></td></tr></table></figure><p>2、修改 <code>[Blogroot]\themes\butterfly\source\css\_layout\post.styl</code>, 直接复制以下内容，替换原文件。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">beautify</span><span class="params">()</span></span></span><br><span class="line">  <span class="built_in">headStyle</span>(fontsize)</span><br><span class="line">    <span class="attribute">padding-left</span>: unit(fontsize + <span class="number">12</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">margin-left</span>: unit((-(fontsize + <span class="number">6</span>)), <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line">      <span class="attribute">font-size</span>: unit(fontsize, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">padding-left</span>: unit(fontsize + <span class="number">18</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span>,</span><br><span class="line">  <span class="selector-tag">h2</span>,</span><br><span class="line">  <span class="selector-tag">h3</span>,</span><br><span class="line">  <span class="selector-tag">h4</span>,</span><br><span class="line">  <span class="selector-tag">h5</span>,</span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">top</span>: calc(<span class="number">50%</span> - <span class="number">7px</span>)</span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$title</span>-prefix-icon-color</span><br><span class="line">      <span class="attribute">content</span>: <span class="variable">$title</span>-prefix-icon</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">1</span></span><br><span class="line">      <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line">      <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h2</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h3</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h4</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h5</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">li</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">600</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">1.05em</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">        <span class="attribute">color</span>: var(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span></span><br><span class="line">    <span class="attribute">list-style-type</span>: circle</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#article-container</span></span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word</span><br><span class="line">  <span class="attribute">overflow-wrap</span>: break-word</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-link-color</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">text-decoration</span>: underline</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">img</span></span><br><span class="line">    <span class="attribute">display</span>: block</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">20px</span></span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transition</span>: filter <span class="number">375ms</span> ease-in .<span class="number">2s</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">p</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">iframe</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;anchor&#x27;</span>)</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">float</span>: right</span><br><span class="line">        <span class="attribute">color</span>: var(--headline-presudo)</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f0c1&#x27;</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">95em</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">3s</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">color</span>: var(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">h1</span>,</span><br><span class="line">    <span class="selector-tag">h2</span>,</span><br><span class="line">    <span class="selector-tag">h3</span>,</span><br><span class="line">    <span class="selector-tag">h4</span>,</span><br><span class="line">    <span class="selector-tag">h5</span>,</span><br><span class="line">    <span class="selector-tag">h6</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">          <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">            <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">ol</span>,</span><br><span class="line">    <span class="selector-tag">ul</span></span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">li</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">4px</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.enable&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;site&#x27;</span></span><br><span class="line">      <span class="built_in">beautify</span>()</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;post&#x27;</span></span><br><span class="line">      &amp;<span class="selector-class">.post-content</span></span><br><span class="line">        <span class="built_in">beautify</span>()</span><br><span class="line"></span><br><span class="line">  &gt; <span class="selector-pseudo">:last-child</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.tag_share</span></span><br><span class="line">    <span class="selector-class">.post-meta</span></span><br><span class="line">      &amp;__tag-list</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line"></span><br><span class="line">      &amp;__tags</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">8px</span> <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span></span><br><span class="line">        <span class="attribute">width</span>: fit-content</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="variable">$light</span>-blue</span><br><span class="line">          <span class="attribute">color</span>: var(--white)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post_share</span></span><br><span class="line">      <span class="attribute">display</span>: inline-block</span><br><span class="line">      <span class="attribute">float</span>: right</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span>: fit-content</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.social-share</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.social-share-icon</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span></span><br><span class="line">          <span class="attribute">width</span>: w = <span class="number">1.85em</span></span><br><span class="line">          <span class="attribute">height</span>: w</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">1.2em</span></span><br><span class="line">          <span class="attribute">line-height</span>: w</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">16px</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid var(--light-grey)</span><br><span class="line">    <span class="attribute">transition</span>: box-shadow .<span class="number">3s</span> ease-in-out</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span><span class="meta">!important</span></span><br><span class="line">    <span class="attribute">background-color</span>: rgb(<span class="number">239</span> <span class="number">241</span> <span class="number">243</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">background</span> var(--heo-post-blockquote-bg)</span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">right</span> -<span class="number">26px</span></span><br><span class="line">      <span class="attribute">top</span> -<span class="number">120px</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;\f25e&#x27;</span></span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">200px</span></span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Font Awesome 5 Brands&#x27;</span></span><br><span class="line">      <span class="attribute">opacity</span> .<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span> rgba(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">6</span>), <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="number">0</span> rgba(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      &amp;-meta</span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-weight</span>: bold</span><br><span class="line"></span><br><span class="line">      &amp;-info</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">6px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">text-decoration</span>: none</span><br><span class="line">          <span class="attribute">word-break</span>: break-word</span><br><span class="line"></span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="attribute">text-decoration</span>: none</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright-cc-info</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-color;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-outdate-notice</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1.2em</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="variable">$noticeOutdate</span>-bg</span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-color</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;noticeOutdate.style&#x27;</span>) == <span class="string">&#x27;flat&#x27;</span></span><br><span class="line">      <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1em</span> .<span class="number">5em</span> <span class="number">2.6em</span></span><br><span class="line">      <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="variable">$noticeOutdate</span>-border</span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">position</span>: absolute</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">        <span class="attribute">left</span>: .<span class="number">9em</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-border</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f071&#x27;</span></span><br><span class="line">        <span class="attribute">transform</span>: translateY(-<span class="number">50%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.ads-wrap</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span></span><br><span class="line"><span class="selector-class">.post-copyright-m-info</span></span><br><span class="line">  <span class="selector-class">.post-copyright-a</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-c</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-u</span></span><br><span class="line">    <span class="attribute">display</span> inline-block</span><br><span class="line">    <span class="attribute">width</span> fit-content</span><br><span class="line">    <span class="attribute">padding</span> <span class="number">2px</span> <span class="number">5px</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#post</span></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      <span class="attribute">background-color</span> <span class="number">#07080a</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">#bfbeb8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2px</span></span><br><span class="line">      <span class="attribute">border</span> <span class="number">1px</span> solid rgb(<span class="number">19</span> <span class="number">18</span> <span class="number">18</span> / <span class="number">35%</span>)</span><br><span class="line">      <span class="attribute">box-shadow</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> rgb(<span class="number">20</span>, <span class="number">120</span>, <span class="number">210</span>)</span><br><span class="line">      <span class="attribute">animation</span> flashlight <span class="number">1s</span> linear infinite alternate</span><br><span class="line">  <span class="selector-class">.post-copyright-info</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#e0e0e4</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.post-copyright__title</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">22px</span></span><br><span class="line">  <span class="selector-class">.post-copyright__notice</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">15px</span></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">box-shadow</span> <span class="number">2px</span> <span class="number">2px</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure><p>3、默认项的配置</p><ul><li><p>作者：<code>[Blogroot]\_config.yml</code> 中的 <code>author</code> 配置项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Lucifer三思而后行</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">luciferlpc.top</span></span><br><span class="line"><span class="attr">description:</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">三笠ぃ</span> <span class="comment">#默认作者</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>许可协议：<code>[Blogroot]\_config.butterfly.yml</code> 中的 <code>license</code> 和 <code>license_url</code> 配置项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">decode:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line">  <span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure></li></ul><p>4、页面覆写配置项，修改对应文章的 <code>front-matter</code>：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Copyright-beautify # 文章名称</span><br><span class="line">date: 2021-03-02 13:52:46 # 文章发布日期</span><br><span class="line">updated: 2021-03-02 13:52:46 # 文章更新日期</span><br><span class="line">copyright<span class="emphasis">_author: Nesxc # 作者覆写</span></span><br><span class="line"><span class="emphasis">copyright_</span>url: https://www.nesxc.com/post/hexocc.html # 原文链接覆写</span><br><span class="line">license: # 许可协议名称覆写</span><br><span class="line"><span class="section">license<span class="emphasis">_url: # 许可协议链接覆写</span></span></span><br><span class="line"><span class="emphasis"><span class="section">---</span></span></span><br></pre></td></tr></table></figure><h2 id="打赏按钮投币彩蛋效果"><a href="#打赏按钮投币彩蛋效果" class="headerlink" title="打赏按钮投币彩蛋效果"></a>打赏按钮投币彩蛋效果</h2><p>1、修改 <code>[Blogroot]\themes\butterfly\layout\includes\post\reward.pug</code>, 整体替换为以下内容：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">link(rel=<span class="string">&#x27;stylesheet&#x27;</span> href=url_for(theme.CDN.coin_css) media=<span class="string">&quot;defer&quot;</span> onload=<span class="string">&quot;this.media=&#x27;all&#x27;&quot;</span>)</span><br><span class="line">.post-reward</span><br><span class="line">  button.tip-button.reward-button</span><br><span class="line">    span.tip-button__text= _p(<span class="string">&#x27;donate&#x27;</span>)</span><br><span class="line">    .coin-wrapper</span><br><span class="line">      .coin</span><br><span class="line">        .coin__middle</span><br><span class="line">        .coin__back</span><br><span class="line">        .coin__front</span><br><span class="line">    .reward-main</span><br><span class="line">      ul.reward-<span class="built_in">all</span></span><br><span class="line">        each item <span class="keyword">in</span> theme.reward.QR_code</span><br><span class="line">          - var clickTo = (item.itemlist||item).link ? (item.itemlist||item).link : (item.itemlist||item).img</span><br><span class="line">          li.reward-item</span><br><span class="line">            a(href=clickTo target=<span class="string">&#x27;_blank&#x27;</span>)</span><br><span class="line">              img.post-qr-code-img(src=url_for((item.itemlist||item).img) alt=(item.itemlist||item).text)</span><br><span class="line">            .post-qr-code-desc=(item.itemlist||item).text</span><br><span class="line"><span class="keyword">if</span> theme.reward.coinAudio</span><br><span class="line">  - var coinAudio = theme.reward.coinAudio ? url_for(theme.reward.coinAudio) : <span class="string">&#x27;https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3&#x27;</span></span><br><span class="line">  audio<span class="comment">#coinAudio(src=coinAudio)</span></span><br><span class="line">script(defer src=url_for(theme.CDN.coin_js))</span><br></pre></td></tr></table></figure><p>2、新建 <code>[Blogroot]\themes\butterfly\source\css\coin.css</code>：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tip-button</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.25rem</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.6rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: -<span class="number">4rem</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">0%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">50ms</span> ease-in-out;</span><br><span class="line">  <span class="attribute">width</span>: auto;</span><br><span class="line">  -webkit-tap-highlight-<span class="attribute">color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">4deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">150ms</span> ease-in-out <span class="number">1</span> shake;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> <span class="selector-class">.tip-button__text</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">200ms</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">background</span>: $button-hover-color;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> <span class="selector-class">.coin</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: margin-bottom <span class="number">1s</span> linear <span class="number">200ms</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.shrink-landing</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: width <span class="number">200ms</span> ease-in;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.coin-landed</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.coin-landed</span> <span class="selector-class">.coin-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">35%</span> <span class="number">97%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.04rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">45%</span> <span class="number">92%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.02rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">55%</span> <span class="number">98%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.04rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">65%</span> <span class="number">96%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.06rem</span>, transparent <span class="number">0.06rem</span>);</span><br><span class="line">  <span class="attribute">background-position</span>: center bottom;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2</span>) <span class="built_in">translateY</span>(-<span class="number">10px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button__text</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">1.8rem</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">500ms</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.25rem</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">transition</span>: height <span class="number">250ms</span> ease-in-out <span class="number">400ms</span>, width <span class="number">250ms</span> ease-in-out <span class="number">300ms</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;ヾ(≧O≦)〃嗷~&#x27;</span>; <span class="comment">/*点击后显示的内容*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">110%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">20%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">200ms</span> <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.35</span>, <span class="number">1.43</span>);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.coin-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: none;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">18rem</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">transform</span>: none;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">200ms</span> linear <span class="number">100ms</span>, transform <span class="number">300ms</span> ease-out;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.coin</span> &#123;</span><br><span class="line">  <span class="attr">--front-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--back-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-x-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-scale-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-rotation-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--shine-opacity-multiplier</span>: <span class="number">0.4</span>;</span><br><span class="line">  <span class="attr">--shine-bg-multiplier</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-y-multiplier) * <span class="number">1rem</span> - <span class="number">3.5rem</span>);</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">3.5rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">3.05rem</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-x-multiplier) * <span class="number">34%</span> + <span class="number">16%</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="built_in">calc</span>(<span class="number">0.4</span> + <span class="built_in">var</span>(--coin-scale-multiplier))) <span class="built_in">rotate</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-rotation-multiplier) * -<span class="number">1deg</span>));</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">200ms</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">3.5rem</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span>, <span class="selector-class">.coin__middle</span>, <span class="selector-class">.coin__back</span>, <span class="selector-class">.coin</span><span class="selector-pseudo">::before</span>, <span class="selector-class">.coin__front</span><span class="selector-pseudo">::after</span>, <span class="selector-class">.coin__back</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">50%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">115</span>, <span class="number">124</span>, <span class="number">153</span>, <span class="number">0.4</span>) <span class="number">54%</span>, <span class="number">#c2cadf</span> <span class="number">54%</span>), <span class="built_in">linear-gradient</span>(<span class="number">210deg</span>, <span class="number">#8590b3</span> <span class="number">32%</span>, transparent <span class="number">32%</span>), <span class="built_in">linear-gradient</span>(<span class="number">150deg</span>, <span class="number">#8590b3</span> <span class="number">32%</span>, transparent <span class="number">32%</span>), <span class="built_in">linear-gradient</span>(to right, <span class="number">#8590b3</span> <span class="number">22%</span>, transparent <span class="number">22%</span>, transparent <span class="number">78%</span>, <span class="number">#8590b3</span> <span class="number">78%</span>), <span class="built_in">linear-gradient</span>(to bottom, <span class="number">#fcfaf9</span> <span class="number">44%</span>, transparent <span class="number">44%</span>, transparent <span class="number">65%</span>, <span class="number">#fcfaf9</span> <span class="number">65%</span>, <span class="number">#fcfaf9</span> <span class="number">71%</span>, <span class="number">#8590b3</span> <span class="number">71%</span>), <span class="built_in">linear-gradient</span>(to right, transparent <span class="number">28%</span>, <span class="number">#fcfaf9</span> <span class="number">28%</span>, <span class="number">#fcfaf9</span> <span class="number">34%</span>, <span class="number">#8590b3</span> <span class="number">34%</span>, <span class="number">#8590b3</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">47%</span>, <span class="number">#8590b3</span> <span class="number">47%</span>, <span class="number">#8590b3</span> <span class="number">53%</span>, <span class="number">#fcfaf9</span> <span class="number">53%</span>, <span class="number">#fcfaf9</span> <span class="number">60%</span>, <span class="number">#8590b3</span> <span class="number">60%</span>, <span class="number">#8590b3</span> <span class="number">66%</span>, <span class="number">#fcfaf9</span> <span class="number">66%</span>, <span class="number">#fcfaf9</span> <span class="number">72%</span>, transparent <span class="number">72%</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#8590b3</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--front-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--front-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--front-y-multiplier);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__middle</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#737c99</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--middle-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--middle-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__back</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">50%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">115</span>, <span class="number">124</span>, <span class="number">153</span>, <span class="number">0.4</span>) <span class="number">54%</span>, <span class="number">#c2cadf</span> <span class="number">54%</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">23%</span>, transparent <span class="number">23%</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">100%</span>, <span class="number">#fcfaf9</span> <span class="number">35%</span>, transparent <span class="number">35%</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#8590b3</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--back-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--back-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__back</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--back-y-multiplier);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">25%</span> <span class="number">65%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span>) <span class="number">90%</span>), <span class="built_in">linear-gradient</span>(<span class="number">55deg</span>, transparent <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">0%</span>), <span class="number">#e9f4ff</span> <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">0%</span>), transparent <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">50%</span>));</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--shine-opacity-multiplier);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--middle-y-multiplier) * <span class="number">0.3181818182rem</span> / -<span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--middle-scale-multiplier)) <span class="built_in">rotate</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-rotation-multiplier) * <span class="number">1deg</span>));</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#737c99</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.3181818182rem</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> shake &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">4deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">66%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">4deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、新建 <code>[Blogroot]\themes\butterfly\source\js\coin.js</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tipButtons = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.tip-button&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">coinAudio</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> coinAudio = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;coinAudio&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (coinAudio) &#123;</span><br><span class="line">    coinAudio.<span class="title function_">play</span>();<span class="comment">//有音频时播放</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Loop through all buttons (allows for multiple buttons on page)</span></span><br><span class="line">tipButtons.<span class="title function_">forEach</span>(<span class="function">(<span class="params">button</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> coin = button.<span class="title function_">querySelector</span>(<span class="string">&#x27;.coin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The larger the number, the slower the animation</span></span><br><span class="line">  coin.<span class="property">maxMoveLoopCount</span> = <span class="number">90</span></span><br><span class="line"></span><br><span class="line">  button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/Android|webOS|BlackBerry/i</span>.<span class="title function_">test</span>(navigator.<span class="property">userAgent</span>)) <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//媒体选择</span></span><br><span class="line">    <span class="keyword">if</span> (button.<span class="property">clicked</span>) <span class="keyword">return</span></span><br><span class="line">    button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;clicked&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Wait to start flipping th coin because of the button tilt animation</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// Randomize the flipping speeds just for fun</span></span><br><span class="line">      coin.<span class="property">sideRotationCount</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span>) * <span class="number">90</span></span><br><span class="line">      coin.<span class="property">maxFlipAngle</span> = (<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>) + <span class="number">3</span>) * <span class="title class_">Math</span>.<span class="property">PI</span></span><br><span class="line">      button.<span class="property">clicked</span> = <span class="literal">true</span></span><br><span class="line">      <span class="title function_">flipCoin</span>()</span><br><span class="line">      <span class="title function_">coinAudio</span>()</span><br><span class="line">    &#125;, <span class="number">50</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">flipCoin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">moveLoopCount</span> = <span class="number">0</span></span><br><span class="line">    <span class="title function_">flipCoinLoop</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">resetCoin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-x-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-scale-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-rotation-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-opacity-multiplier&#x27;</span>, <span class="number">0.4</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-bg-multiplier&#x27;</span>, <span class="string">&#x27;50%&#x27;</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;opacity&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="comment">// Delay to give the reset animation some time before you can click again</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      button.<span class="property">clicked</span> = <span class="literal">false</span></span><br><span class="line">    &#125;, <span class="number">300</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">flipCoinLoop</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">moveLoopCount</span>++</span><br><span class="line">    <span class="keyword">var</span> percentageCompleted = coin.<span class="property">moveLoopCount</span> / coin.<span class="property">maxMoveLoopCount</span></span><br><span class="line">    coin.<span class="property">angle</span> = -coin.<span class="property">maxFlipAngle</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>((percentageCompleted - <span class="number">1</span>), <span class="number">2</span>) + coin.<span class="property">maxFlipAngle</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the scale and position of the coin moving through the air</span></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-y-multiplier&#x27;</span>, -<span class="number">11</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>(percentageCompleted * <span class="number">2</span> - <span class="number">1</span>, <span class="number">4</span>) + <span class="number">11</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-x-multiplier&#x27;</span>, percentageCompleted)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-scale-multiplier&#x27;</span>, percentageCompleted * <span class="number">0.6</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-rotation-multiplier&#x27;</span>, percentageCompleted * coin.<span class="property">sideRotationCount</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the scale and position values for the different coin faces</span></span><br><span class="line">    <span class="comment">// The math uses sin/cos wave functions to similate the circular motion of 3D spin</span></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--front-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--front-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">sin</span>(coin.<span class="property">angle</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--middle-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--middle-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">cos</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--back-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span> - <span class="title class_">Math</span>.<span class="property">PI</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--back-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">sin</span>(coin.<span class="property">angle</span> - <span class="title class_">Math</span>.<span class="property">PI</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-opacity-multiplier&#x27;</span>, <span class="number">4</span> * <span class="title class_">Math</span>.<span class="title function_">sin</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>) - <span class="number">3.2</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-bg-multiplier&#x27;</span>, -<span class="number">40</span> * (<span class="title class_">Math</span>.<span class="title function_">cos</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>) - <span class="number">0.5</span>) + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Repeat animation loop</span></span><br><span class="line">    <span class="keyword">if</span> (coin.<span class="property">moveLoopCount</span> &lt; coin.<span class="property">maxMoveLoopCount</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (coin.<span class="property">moveLoopCount</span> === coin.<span class="property">maxMoveLoopCount</span> - <span class="number">6</span>) button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;shrink-landing&#x27;</span>)</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(flipCoinLoop)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;coin-landed&#x27;</span>)</span><br><span class="line">      coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;opacity&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        button.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;clicked&#x27;</span>, <span class="string">&#x27;shrink-landing&#x27;</span>, <span class="string">&#x27;coin-landed&#x27;</span>)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">resetCoin</span>()</span><br><span class="line">        &#125;, <span class="number">300</span>)</span><br><span class="line">      &#125;, <span class="number">1500</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>4、修改<code>_config.butterfly.yml</code>, 添加音频文件配置项，添加 CDN 配置项：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  # Sponsor/reward</span><br><span class="line">  reward:</span><br><span class="line">    enable: true</span><br><span class="line"><span class="addition">+   coinAudio: https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3</span></span><br><span class="line">    QR_code:</span><br><span class="line">    。</span><br><span class="line">    。</span><br><span class="line">    。</span><br><span class="line">  CDN:</span><br><span class="line">    # main</span><br><span class="line">    main_css: /css/index.css</span><br><span class="line">    jquery: https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js</span><br><span class="line">    main: /js/main.js</span><br><span class="line">    utils:/js/utils.js</span><br><span class="line"><span class="addition">+    # 打赏按钮投币效果</span></span><br><span class="line"><span class="addition">+   coin_js: /js/coin.js</span></span><br><span class="line"><span class="addition">+   coin_css: /css/coin.css</span></span><br></pre></td></tr></table></figure><p>5、现在的打赏按钮样式需要稍作适配，当前若提示语太长，悬停时会无法显示完全。需要微调一下，修改 <code>[Blogroot]\themes\butterfly\source\css\_layout\reward.styl</code>，整体替换为以下内容：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.post-reward</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">4rem</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.reward-button</span></span><br><span class="line">    <span class="attribute">display</span>: inline-block</span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">2rem</span> <span class="number">1.2rem</span></span><br><span class="line">    <span class="attribute">background</span>: var(--btn-bg)</span><br><span class="line">    <span class="attribute">color</span>: var(--btn-color)</span><br><span class="line">    <span class="attribute">cursor</span>: pointer</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">4s</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: inset <span class="number">15em</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> var(--btn-hover-color)</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-main</span></span><br><span class="line">        <span class="attribute">display</span>: block</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.reward-main</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">bottom</span>: <span class="number">40px</span></span><br><span class="line">      <span class="attribute">left</span>: -<span class="number">25%</span></span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">100</span></span><br><span class="line">      <span class="attribute">display</span>: none</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">150%</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-all</span></span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">1rem</span> .<span class="number">5rem</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">4px</span></span><br><span class="line">        <span class="attribute">background</span>: var(--reward-pop)</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">bottom</span>: -<span class="number">10px</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">          <span class="attribute">height</span>: <span class="number">20px</span></span><br><span class="line">          <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">bottom</span>: <span class="number">2px</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0</span> auto</span><br><span class="line">          <span class="attribute">width</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">height</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">border-top</span>: <span class="number">13px</span> solid var(--reward-pop)</span><br><span class="line">          <span class="attribute">border-right</span>: <span class="number">13px</span> solid transparent</span><br><span class="line">          <span class="attribute">border-left</span>: <span class="number">13px</span> solid transparent</span><br><span class="line">          <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.reward-item</span></span><br><span class="line">          <span class="attribute">display</span>: inline-block</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span></span><br><span class="line">          <span class="attribute">list-style-type</span>: none</span><br><span class="line">          <span class="attribute">vertical-align</span>: top</span><br><span class="line"></span><br><span class="line">          <span class="selector-tag">img</span></span><br><span class="line">            <span class="attribute">width</span>: <span class="number">130px</span></span><br><span class="line">            <span class="attribute">height</span>: <span class="number">130px</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.post-qr-code-desc</span></span><br><span class="line">            <span class="attribute">padding-top</span>: .<span class="number">4rem</span></span><br><span class="line">            <span class="attribute">width</span>: <span class="number">130px</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="variable">$reward</span>-pop-up-color</span><br></pre></td></tr></table></figure><p>还可以针对自己的情况适度调整以下内容：</p><ul><li><p>修改悬停打赏按钮时的颜色填充长度：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="selector-class">.reward-button</span></span><br><span class="line">    <span class="attribute">display</span>: inline-block</span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">2rem</span> <span class="number">1.2rem</span></span><br><span class="line">    <span class="attribute">background</span>: var(--btn-bg)</span><br><span class="line">    <span class="attribute">color</span>: var(--btn-color)</span><br><span class="line">    <span class="attribute">cursor</span>: pointer</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">4s</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">-     <span class="attribute">box-shadow</span>: inset <span class="number">9em</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> var(--btn-hover-color)</span><br><span class="line">+     <span class="attribute">box-shadow</span>: inset <span class="number">20em</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> var(--btn-hover-color)</span><br></pre></td></tr></table></figure></li><li><p>修改打赏二维码的样式（仅针对 2 张二维码的情况，单张不用改动。两张以上需要自己调试这两个参数）</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  .reward-main</span><br><span class="line">    position: absolute</span><br><span class="line">    bottom: 40px</span><br><span class="line"><span class="deletion">-   left: 0</span></span><br><span class="line"><span class="addition">+   left: -25%</span></span><br><span class="line">    z-index: 100</span><br><span class="line">    display: none</span><br><span class="line">    padding: 0 0 15px</span><br><span class="line"><span class="deletion">-   width: 100%</span></span><br><span class="line"><span class="addition">+   width: 150%</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="页脚振翅蝴蝶动效"><a href="#页脚振翅蝴蝶动效" class="headerlink" title="页脚振翅蝴蝶动效"></a>页脚振翅蝴蝶动效</h2><p>1、引入相应的图标资源，修改<code>_config.butterfly.yml</code>，在 <code>inject</code> 配置项添加图标库 js。此处为我的图标库链接，掌握前置教程后可以改成自己的。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/custom.css&quot;</span>  <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span> <span class="comment">#教学用样式</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># 阿里矢量图标</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/font_2032782_8ns648avijk.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>2、新建 <code>[Blogroot]\themes\butterfly\source\css\custom.css</code>, 在里面添加图标默认样式和振翅蝴蝶动画。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*iconfont默认样式*/</span></span><br><span class="line"><span class="selector-class">.icon</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">height</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span><br><span class="line">  fill: currentColor;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/* 页脚蝴蝶振翅动画 */</span></span><br><span class="line"><span class="selector-class">.copyright</span> svg&#123;</span><br><span class="line">  <span class="attribute">animation</span>:butterfly <span class="number">1s</span> linear infinite alternate;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> butterfly &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>:<span class="built_in">rotateY</span>(<span class="number">70deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>:<span class="built_in">rotateY</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、修改 <code>[Blogroot]\themes\butterfly\layout\includes\footer.pug</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  #footer-wrap</span><br><span class="line">    if theme.footer.owner.enable</span><br><span class="line">      - var now = new Date()</span><br><span class="line">      - var nowYear = now.getFullYear()</span><br><span class="line"><span class="deletion">-     if theme.footer.owner.since &amp;&amp; theme.footer.owner.since != nowYear</span></span><br><span class="line"><span class="deletion">-       .copyright!= `&amp;copy;$&#123;theme.footer.owner.since&#125; - $&#123;nowYear&#125; By $&#123;config.author&#125;`</span></span><br><span class="line"><span class="deletion">-     else</span></span><br><span class="line"><span class="deletion">-       .copyright!= `&amp;copy;$&#123;nowYear&#125; By $&#123;config.author&#125;`</span></span><br><span class="line"><span class="addition">+     if theme.footer.owner.since &amp;&amp; theme.footer.owner.since != nowYear</span></span><br><span class="line"><span class="addition">+       .copyright</span></span><br><span class="line"><span class="addition">+           span!= `&amp;copy;$&#123;theme.footer.owner.since&#125; - $&#123;nowYear&#125;`</span></span><br><span class="line"><span class="addition">+           svg(style=&quot;width:1.5em; height:1.5em&quot; aria-hidden=&quot;true&quot;)</span></span><br><span class="line"><span class="addition">+             use(xlink:href=&quot;#icon-Butterfly&quot;)</span></span><br><span class="line"><span class="addition">+           span!= `$&#123;config.author&#125;`</span></span><br><span class="line"><span class="addition">+     else</span></span><br><span class="line"><span class="addition">+       .copyright</span></span><br><span class="line"><span class="addition">+         span!= `&amp;copy;$&#123;nowYear&#125;`</span></span><br><span class="line"><span class="addition">+         svg(style=&quot;width:1.5em; height:1.5em&quot; aria-hidden=&quot;true&quot;)</span></span><br><span class="line"><span class="addition">+           use(xlink:href=&quot;#icon-Butterfly&quot;)</span></span><br><span class="line"><span class="addition">+         span!= `$&#123;config.author&#125;`</span></span><br></pre></td></tr></table></figure><p>4、事实上直接用 <code>emoji</code> 的🦋，配合 <code>fontawesome-animation</code> 也能做到类似效果，甚至还可以使用 <code>base64</code> 的图片，但是图标呈现的不论是色彩还是动效都不如用 <code>iconfont</code> 来的漂亮。这里的动画用到了 <code>rotateY</code>, 三维上其实是图标在绕着 Y 轴旋转，降维到二维以后就呈现出了对折振翅的效果，但是人脑是很神奇的，因为左右半脑的发达程度不均，有的人还是能看到蝴蝶其实是在旋转而不是振翅。当然也不乏切换自如的人才。这个就只能仁者见仁智者见智了。</p><h2 id="友链朋友圈"><a href="#友链朋友圈" class="headerlink" title="友链朋友圈"></a>友链朋友圈</h2><p>你是否经常烦恼于友链过多但没有时间浏览？那么友链朋友圈将解决这一痛点。你可以随时获取友链网站的更新内容，并了解友链的活跃情况 。</p><blockquote><p>参考文档：<a href="https://fcircle-doc.js.cool/">友链朋友圈</a></p></blockquote><p>推荐使用默认的部署方式，即：<code>github+leancloud+vercel</code> ，整个部署均在云端完成。运行原理：</p><ol><li>通过github action启动爬虫抓取友链文章数据</li><li>数据由爬虫推送至数据库保存（默认为leancloud，可以自行更改）</li><li>vercel部署的api从数据库获取数据交付给前端</li></ol><h3 id="后端部署"><a href="#后端部署" class="headerlink" title="后端部署"></a>后端部署</h3><p>fork友链朋友圈的项目仓库，地址：<a href="https://github.com/Rock-Candy-Tea/hexo-circle-of-friends">https://github.com/Rock-Candy-Tea/hexo-circle-of-friends</a></p><p>在<code>fork</code>后仓库中，编辑仓库中的<code>/hexo_circle_of_friends/setting.py</code>文件，必须修改的配置如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LINK = [</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="string">&quot;link&quot;</span>:<span class="string">&quot;https://www.yyyzyyyz.cn/link/&quot;</span>,  <span class="comment"># 友链页地址1，修改为你的友链页地址</span></span><br><span class="line">        <span class="string">&quot;theme&quot;</span>:<span class="string">&quot;butterfly&quot;</span>  <span class="comment"># 友链页地址为https://www.yyyzyyyz.cn/link/，即为butterfly主题，以此类推</span></span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>然后点击仓库的<code>Settings--&gt;Secrets--&gt;New repository secret</code> ：</p><p><img src="https://fcircle-doc.js.cool/QQ%E5%9B%BE%E7%89%8720220205080305.png"></p><p>添加环境变量secert，数据库选择的是leancloud，请添加<code>APPID</code>和<code>APPKEY</code></p><p>下面演示使用leancloud的存储方式，首先需要创建leancloud数据库，创建方式见<a href="https://fcircle-doc.js.cool/#/problems?id=%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BAleancloud%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%9F">这里</a>。</p><blockquote><p>📢注意：前往<a href="https://leancloud.app/">leancloud国际版官网</a>注册账号并登录。</p></blockquote><p>如下图所示，在仓库分别添加<code>APPID</code>和<code>APPKEY</code>，获取方式见<a href="https://fcircle-doc.js.cool/#/problems?id=%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96appid%E5%92%8Cappkey%EF%BC%9F">这里</a>。</p><p><img src="https://fcircle-doc.js.cool/QQ%E5%9B%BE%E7%89%8720220205080840.png"></p><p>启用<code>fork</code>后仓库的 github action，点击<code>Actions--&gt;I understand my workflows, go ahead and enable them</code></p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205081120.png"></p><p>之后点击<code>update-friends-posts</code>并启用<code>workflow</code></p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205081424.png"></p><p>前往 <a href="https://vercel.com/">vercel官网</a>，直接用github创建账号并用手机号绑定。</p><p>点击<code>New Project</code>新建项目</p><p>找到<code>Import Git Repository</code>，应该可以看见你刚刚<code>fork</code>的仓库，点击<code>Import</code>。</p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205082743.png"></p><p>添加环境变量，其中：</p><ul><li>如果数据库使用leancloud，请添加<code>APPID</code>和<code>APPKEY</code></li><li>如果数据库使用mysql，请添加登录用户名<code>MYSQL_USERNAME</code>，登录密码<code>MYSQL_PASSWORD</code>，数据库IP地址<code>MYSQL_IP</code>，要连接到的库的名称<code>MYSQL_DB</code></li><li>如果数据库使用sqlite，不需要配置</li><li>如果数据库选择的是mongodb，请添加<code>MONGODB_URI</code></li></ul><p>添加完成后，点击 <code>Deploy</code>。</p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205083346.png" alt="QQ截图20220205083346"></p><p>回到首页，等待一会，应该会部署完成。</p><p>之后回到点击仓库<code>star</code>来完成第一次程序运行，不出意外的话结果如下图：</p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205081513.png"></p><p>（这时刚刚的leancloud上也能看到上传的数据。）此后在每天的0,6,12,18,21点整，都会自动启动爬虫进行爬取。</p><p>在vercel找到<code>DOMAINS</code>下面的地址，如：<a href="https://hexo-friendcircle4-api.vercel.app/">https://hexo-friendcircle4-api.vercel.app</a> ，前端需要的就是这个地址。</p><p><img src="https://fcircle-doc.js.cool/QQ%E6%88%AA%E5%9B%BE20220205083633.png"></p><p>在这个地址后面拼接<code>/all</code>尝试访问，出现数据就说明配置成功。</p><h3 id="前端方案"><a href="#前端方案" class="headerlink" title="前端方案"></a>前端方案</h3><blockquote><p>转自 <a href="https://akilar.top/posts/62f13a97/">Akilar 《hexo-filter-fcircle》</a> 仅用于学习</p></blockquote><p>1、安装插件，在博客根目录 <code>[Blogroot]</code> 下打开终端，运行以下指令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall hexo-butterfly-fcircle --save</span><br><span class="line">npm install hexo-filter-fcircle --save</span><br></pre></td></tr></table></figure><p>2、添加配置信息<br>在站点配置文件<code>_config.yml</code> 或者主题配置文件例如<code>_config.butterfly.yml</code> 中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fcircle</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/8480b91c/</span></span><br><span class="line"><span class="attr">fcircle:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#控制开关</span></span><br><span class="line">  <span class="attr">apiurl:</span> <span class="string">https://hexo-friendcircle-api.vercel.app/api</span> <span class="comment">#api地址</span></span><br><span class="line">  <span class="attr">initnumber:</span> <span class="number">20</span> <span class="comment">#【可选】页面初始化展示文章数量</span></span><br><span class="line">  <span class="attr">stepnumber:</span> <span class="number">10</span> <span class="comment">#【可选】每次加载增加的篇数</span></span><br><span class="line">  <span class="attr">css:</span> <span class="comment">#【可选】开发者接口，自定义css链接</span></span><br><span class="line">  <span class="attr">js:</span> <span class="comment">#【可选】开发者接口，自定义js链接</span></span><br><span class="line">  <span class="attr">path:</span> <span class="comment">#【可选】fcircle的路径名称。默认为 fcircle，生成的页面为 fcircle/index.html</span></span><br><span class="line">  <span class="attr">front_matter:</span> <span class="comment">#【可选】fcircle页面的 front_matter 配置</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">朋友圈</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> Butterfly </category>
          
          <category> Akilar </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Butterfly </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo+阿里云&amp;GitHub Pages 搭建个人博客教程</title>
      <link href="/post/2d5827fd.html"/>
      <url>/post/2d5827fd.html</url>
      
        <content type="html"><![CDATA[<p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 <a href="http://daringfireball.net/projects/markdown/">Markdown</a>（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p><div class="note success flat"><p>本文参考自 Hexo 官方文档：<a href="https://hexo.io/zh-cn/docs/">https://hexo.io/zh-cn/docs/</a></p></div><h1 id="三种部署方式"><a href="#三种部署方式" class="headerlink" title="三种部署方式"></a>三种部署方式</h1><div class="tabs" id="安装部署"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#安装部署-1">① 本地部署</button></li><li class="tab"><button type="button" data-href="#安装部署-2">② Github Pages部署</button></li><li class="tab"><button type="button" data-href="#安装部署-3">③ 阿里云部署</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="安装部署-1"><p>本地安装 Hexo 相当简单，只需要先安装下列应用程序即可：</p><ul><li><a href="http://nodejs.org/">Node.js</a> (Node.js 版本需不低于 10.13，建议使用 Node.js 12.0 及以上版本)</li><li><a href="http://git-scm.com/">Git</a></li></ul><p>如果您的电脑中已经安装上述必备程序，那么恭喜您！你可以直接跳过安装准备步骤。</p><h2 id="安装准备"><a href="#安装准备" class="headerlink" title="安装准备"></a>安装准备</h2><h3 id="安装-Node-js"><a href="#安装-Node-js" class="headerlink" title="安装 Node.js"></a>安装 Node.js</h3><p>Node.js 为大多数平台提供了官方的 <a href="https://nodejs.org/en/download/">安装程序</a>。对于中国大陆地区用户，可以前往 <a href="https://npm.taobao.org/mirrors/node">淘宝 Node.js 镜像</a> 下载。</p><p>其它的安装方法：</p><ul><li>Windows：通过 <a href="https://github.com/jasongin/nvs/">nvs</a>（推荐）或者 <a href="https://github.com/nvm-sh/nvm">nvm</a> 安装。</li><li>Mac：使用 <a href="https://brew.sh/">Homebrew</a> 或 <a href="http://www.macports.org/">MacPorts</a> 安装。</li><li>Linux（DEB&#x2F;RPM-based）：从 <a href="https://github.com/nodesource/distributions">NodeSource</a> 安装。</li><li>其它：使用相应的软件包管理器进行安装，可以参考由 Node.js 提供的 <a href="https://nodejs.org/en/download/package-manager/">指导</a>。</li></ul><p>对于 Mac 和 Linux 同样建议使用 nvs 或者 nvm，以避免可能会出现的权限问题。</p><h3 id="安装-Git"><a href="#安装-Git" class="headerlink" title="安装 Git"></a>安装 Git</h3><ul><li>Windows：下载并安装 <a href="https://git-scm.com/download/win">git</a>.</li><li>Mac：使用 <a href="http://mxcl.github.com/homebrew/">Homebrew</a>, <a href="http://www.macports.org/">MacPorts</a> 或者下载 <a href="http://sourceforge.net/projects/git-osx-installer/">安装程序</a>。</li><li>Linux (Ubuntu, Debian)：<code>sudo apt-get install git-core</code></li><li>Linux (Fedora, Red Hat, CentOS)：<code>sudo yum install git-core</code></li></ul><h2 id="安装部署"><a href="#安装部署" class="headerlink" title="安装部署"></a>安装部署</h2><p>所有必备的应用程序安装完成后，NPM 一键式安装 Hexo：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 设置淘宝镜像源</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"><span class="comment">## 一键安装 hexo</span></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>初始化 Hexo 博客：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 本地创建一个目录用于存放博客</span></span><br><span class="line">hexo init</span><br><span class="line">hexo generate</span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>本地启动服务器。默认情况下，访问网址为： <code>http://localhost:4000/</code>。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="安装部署-2"><p>如果已经成功在本地部署了 Hexo，为了方便的访问到自己的博客网站，就要考虑如何将 Hexo 部署到 Github Pages。</p><h2 id="注册-Github"><a href="#注册-Github" class="headerlink" title="注册 Github"></a>注册 Github</h2><p>首先我们需要注册一个 Github 账户（免费），使用浏览器（Chrome，Firefox）打开 <a href="https://link.zhihu.com/?target=https://github.com/">GitHub官网</a> 点击 <em><strong>sign up</strong></em> 进行注册即可。</p><h2 id="绑定-Github"><a href="#绑定-Github" class="headerlink" title="绑定 Github"></a>绑定 Github</h2><p>在此步骤前，请确保 GitHub 的注册和 GIt 的安装，接下来就是本地使用 Git 来绑定我们的 Github 账户，为了方便操作一般都选择使用公钥免密登录的方式。</p><h3 id="本地获取公钥"><a href="#本地获取公钥" class="headerlink" title="本地获取公钥"></a>本地获取公钥</h3><p>首先查看本机的公钥：</p><ul><li>Linux 系统：~&#x2F;.ssh</li><li>Mac 系统：~&#x2F;.ssh</li><li>Windows 10 ：C:&#x2F;Users&#x2F;ASUS&#x2F;.ssh</li></ul><p>我的电脑是 macOS：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure><p>将输出结果复制保存。</p><h3 id="Github-绑定-SSH-keys"><a href="#Github-绑定-SSH-keys" class="headerlink" title="Github 绑定 SSH keys"></a>Github 绑定 SSH keys</h3><p>打开 Github 官网，按照以下步骤操作：</p><ul><li><p>点击右上角头像，找到设置</p></li><li><p>打开 SSH and GPG keys 选项</p></li><li><p>新建 SSH key，输入公钥</p></li></ul><p>添加完成后，本地进行测试：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><p>第一次连接测试需要输入 <code>yes</code> ，结果返回如下即代表成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Warning: Permanently added <span class="string">&#x27;github.com&#x27;</span> (ED25519) to the list of known hosts.</span><br><span class="line">Hi pc-study! You<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure><p>请确保 Git 已配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;pc1107750981@163.com&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;pc1107750981@163.com&quot;</span></span><br></pre></td></tr></table></figure><h2 id="Github-克隆和提交"><a href="#Github-克隆和提交" class="headerlink" title="Github 克隆和提交"></a>Github 克隆和提交</h2><p>由于我们要将 Hexo 部署到 Github Pages，所以首先要在 Github 创建一个新的仓库，仓库名设置为：<code>ps-study.github.io</code>。</p><p>创建好仓库后，接下来就是将本地安装好的 Hexo 部署到 Github Pages 上。</p><p>首先打开 Hexo 目录下的 <code>_config.yml</code> 文件，修改 deploy 选项：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">git@github.com:pc-study/pc-study.github.io.git</span>  <span class="comment">#你的仓库地址</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">main</span></span><br></pre></td></tr></table></figure><p>接着回到 Blog 文件夹，使用 NPM 安装 Git 部署插件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>安装完成后，将本地 Hexo 部署推送至 Github 上：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><p>执行完成后，打开 <a href="https://pc-study.github.io/">https://pc-study.github.io</a> 即可访问。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="安装部署-3"><p>最近买了个阿里云服务器，结合之前 Hexo 部署到 Github Pages 的经验，尝试将 Hexo 部署到了阿里云上。</p><h2 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h2><p>本次个人博客大致的搭建步骤如下：</p><ul><li>购买阿里云服务器</li><li>配置阿里云服务器</li><li>服务端安装  Nodejs</li><li>服务端安装 Git</li><li>服务端安装 Nginx</li><li>客户端安装 Hexo</li><li>客户端配置免密登录</li><li>服务端创建 Git 仓库</li><li>Hexo 主题配置</li></ul><h2 id="购买阿里云服务器"><a href="#购买阿里云服务器" class="headerlink" title="购买阿里云服务器"></a>购买阿里云服务器</h2><p>这个比较简单，会花钱就行，尽量找一个新注册的账号，这样可以花几十 money 就可以购买一年的阿里云服务器，例如：</p><p><img src="https://img-blog.csdnimg.cn/45a9902f4c514169b09252d103108915.png"></p><p>嗯没错，就是很香，购买完之后简单配置一下就可以使用了，本文基于 CentOS7.9 系统搭建，所以大家要继续下去的话也只能选择 CentOS7.9 咯。</p><h2 id="配置阿里云服务器"><a href="#配置阿里云服务器" class="headerlink" title="配置阿里云服务器"></a>配置阿里云服务器</h2><p>阿里云服务器的配置很简单，主要有：</p><ul><li>重置实例密码</li><li>配置安全组策略</li></ul><p>配置的步骤都很简单，基本就是几分钟的事。</p><p><strong>重置实例密码：</strong></p><p><strong>配置安全组策略：</strong></p><p>配置好之后，复制一下公网IP，就可以开始建站了。</p><h2 id="服务端安装-Nodejs"><a href="#服务端安装-Nodejs" class="headerlink" title="服务端安装  Nodejs"></a>服务端安装  Nodejs</h2><p>在本地客户端使用 ssh 连接阿里云服务器公网IP：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@公网IP</span><br></pre></td></tr></table></figure><p>一键式安装配置 Nodejs：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp &amp;&amp; wget https://nodejs.org/dist/v17.5.0/node-v17.5.0-linux-x64.tar.xz</span><br><span class="line">tar xf node-v17.5.0-linux-x64.tar.xz</span><br><span class="line"><span class="built_in">mv</span> node-v17.5.0-linux-x64 /usr/local/node</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/node/bin/node /bin/node</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/node/bin/npm /bin/npm</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=/usr/local/node/bin:$PATH&#x27;</span> &gt;&gt; /etc/profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>执行完就安装成功了。</p><h2 id="服务端安装-Git"><a href="#服务端安装-Git" class="headerlink" title="服务端安装 Git"></a>服务端安装 Git</h2><p>一键式安装 Git：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install -y curl-devel expat-devel gettext-devel openssl-devel zlib-devel gcc perl-ExtUtils-MakeMaker</span><br><span class="line"><span class="built_in">cd</span> /tmp &amp;&amp; wget https://www.kernel.org/pub/software/scm/git/git-2.9.5.tar.gz</span><br><span class="line">tar xf git-2.9.5.tar.gz</span><br><span class="line"><span class="built_in">cd</span> git-2.9.5 &amp;&amp; make all prefix=/usr/local/git</span><br><span class="line">make install prefix=/usr/local/git</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=$PATH:/usr/local/git/bin&#x27;</span> &gt;&gt; /etc/bashrc</span><br><span class="line"><span class="built_in">source</span> /etc/bashrc</span><br><span class="line">git version</span><br><span class="line">git config --global user.name <span class="string">&quot;你的账号&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;你的邮箱&quot;</span></span><br></pre></td></tr></table></figure><p>执行完就安装成功了，要注意的是客户端也需要安装一下 Git，图形化一直下一步就行。</p><h2 id="服务端安装-Nginx"><a href="#服务端安装-Nginx" class="headerlink" title="服务端安装 Nginx"></a>服务端安装 Nginx</h2><p>一键式安装 Nginx：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install -y gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel</span><br><span class="line"><span class="built_in">cd</span> /tmp &amp;&amp; wget http://nginx.org/download/nginx-1.9.9.tar.gz</span><br><span class="line">tar xf nginx-1.9.9.tar.gz</span><br><span class="line"><span class="built_in">cd</span> nginx-1.9.9 &amp;&amp; ./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><p>配置 Nginx 服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 创建 hexo 博客存放位置</span></span><br><span class="line"><span class="built_in">mkdir</span> /data/blog</span><br><span class="line"><span class="comment">## 修改 Nginx 配置文件</span></span><br><span class="line">vi /usr/local/nginx/conf/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">## 修改配置文件中以下几点</span></span><br><span class="line"><span class="comment">## 1、server_name，修改域名或ip</span></span><br><span class="line">server_name  服务器公网IP;</span><br><span class="line"><span class="comment">## 2、root index.html，修改为 hexo 博客存放的位置</span></span><br><span class="line">root /data/blog</span><br></pre></td></tr></table></figure><p>打开 Nginx 服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/local/nginx/sbin</span><br><span class="line"><span class="comment"># 启动 nginx</span></span><br><span class="line">./nginx</span><br></pre></td></tr></table></figure><p>至此 Nginx 也安装完成。</p><h2 id="客户端安装-Hexo"><a href="#客户端安装-Hexo" class="headerlink" title="客户端安装 Hexo"></a>客户端安装 Hexo</h2><p>Hexo 也是一键式安装，安装前，设置一下 npm 源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br><span class="line"><span class="comment">## 安装 hexo</span></span><br><span class="line">npm install -g hexo-cli</span><br><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p>本地客户端创建 Hexo 博客目录并初始化启动博客：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 本地创建一个目录用于存放博客</span></span><br><span class="line">hexo init</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>启动之后本地浏览器 localhost:4000 访问一下是否成功。</p><h2 id="配置免密登录"><a href="#配置免密登录" class="headerlink" title="配置免密登录"></a>配置免密登录</h2><p>配置本地客户端与阿里云服务器端的 ssh 免密登录，方便上传仓库时一键式上传。</p><p>在本地客户端生成并上传公共密钥：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 执行完之后一直回车就行</span></span><br><span class="line">ssh-keygen</span><br><span class="line"><span class="comment">## 上传公共密钥到阿里云服务器</span></span><br><span class="line">ssh-copy-id root@阿里云公网IP</span><br><span class="line"><span class="comment">## 测试是否已免密</span></span><br><span class="line">ssh root@阿里云公网IP</span><br></pre></td></tr></table></figure><p>如果无需密码即可登录，说明已经配置完成。</p><h2 id="服务端创建-Git-仓库"><a href="#服务端创建-Git-仓库" class="headerlink" title="服务端创建 Git 仓库"></a>服务端创建 Git 仓库</h2><p>服务器上创建一个 Git 仓库，该仓库中新建一个 post-receive 钩子文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">git init --bare hexo.git</span><br><span class="line">vi ~/hexo.git/hooks/post-receive</span><br><span class="line"><span class="comment">## 填写以下内容，其中的--work-tree 为 hexo 博客目录</span></span><br><span class="line">git --work-tree=/data/blog --git-dir=/root/hexo.git checkout -f</span><br><span class="line"><span class="comment">## 授予钩子文件可执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x ~/hexo.git/hooks/post-receive</span><br><span class="line"><span class="built_in">chmod</span> -R 777 /data/blog</span><br></pre></td></tr></table></figure><p>至此，Git 仓库创建并配置完成，对应的本地客户端也需要配置一下！</p><p>在本地计算机 hexo 的工程目录下，找到 <code>_config.yml</code>，对 deploy 参数进行修改，如下图所示</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: root@公网IP:/root/hexo.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>在本地计算机安装插件: hexo-deployer-git 和 hexo-server，插件的作用分别是使用Git自动部署，和hexo本地简单的服务器：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install hexo-server</span><br><span class="line"><span class="comment">## 配置全局变量</span></span><br><span class="line">git config --global user.name <span class="string">&quot;你的账号&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;你的邮箱&quot;</span></span><br><span class="line"><span class="comment">## 生成发布 Hexo 博客</span></span><br><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><p>此时，便可以通过浏览器访问 http:&#x2F;&#x2F;阿里云公网IP 进入 hexo 我的博客主页了。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note success flat"><p>通过以上3种方式部署 Hexo 博客之后，就拥有了一个最简单的个人博客网站了，下面讲讲博客的简单初始化。</p></div><h1 id="修改网站关键信息"><a href="#修改网站关键信息" class="headerlink" title="修改网站关键信息"></a>修改网站关键信息</h1><p>Hexo 初始化后，博客网站有一些关键信息是默认的，需要修改为我们自己的信息。</p><h2 id="网站资料"><a href="#网站资料" class="headerlink" title="网站资料"></a>网站资料</h2><p>修改网站各种资料，例如标题、副标题和邮箱等个人资料，请修改博客根目录的站点配置文件 _config.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Lucifer三思而后行</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;Lucifer三思而后行&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">三笠ぃ</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://pc-study.github.io/</span></span><br></pre></td></tr></table></figure><h2 id="导航菜单"><a href="#导航菜单" class="headerlink" title="导航菜单"></a>导航菜单</h2><p>修改主题配置文件 _config.butterfly.yml：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-tags</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span></span><br><span class="line">  <span class="comment"># List||fas fa-list:</span></span><br><span class="line">  <span class="comment">#   Music: /music/ || fas fa-music</span></span><br><span class="line">  <span class="comment">#   Movie: /movies/ || fas fa-video</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/link/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-link</span></span><br><span class="line">  <span class="string">关于我:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-heart</span></span><br></pre></td></tr></table></figure><h1 id="博客关键页面生成"><a href="#博客关键页面生成" class="headerlink" title="博客关键页面生成"></a>博客关键页面生成</h1><p>博客有一些关键页面需要手动生成。</p><h2 id="标签页"><a href="#标签页" class="headerlink" title="标签页"></a>标签页</h2><p>进入 Hexo 博客的根目录，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>打开 source&#x2F;tags&#x2F;index.md 文件，修改如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2022-03-11 12:53:45</span><br><span class="line"><span class="section">type: &quot;tags&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><h2 id="分类页"><a href="#分类页" class="headerlink" title="分类页"></a>分类页</h2><p>进入 Hexo 博客的根目录，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>打开 source&#x2F;categories&#x2F;index.md 文件，修改如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">date: 2022-03-11 12:56:06</span><br><span class="line"><span class="section">type: &quot;categories&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><h2 id="友情链接"><a href="#友情链接" class="headerlink" title="友情链接"></a>友情链接</h2><p>进入 Hexo 博客的根目录，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page <span class="built_in">link</span></span><br></pre></td></tr></table></figure><p>打开 source&#x2F;link&#x2F;index.md 文件，修改如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">date: 2022-03-11 12:57:48</span><br><span class="line"><span class="section">type: &quot;link&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><h2 id="关于我"><a href="#关于我" class="headerlink" title="关于我"></a>关于我</h2><p>进入 Hexo 博客的根目录，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page about</span><br></pre></td></tr></table></figure><p>打开 source&#x2F;about-me&#x2F;index.md 文件，修改如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 关于作者</span><br><span class="line">date: 2022-03-11 13:01:21</span><br><span class="line"><span class="section">type: &quot;about&quot;</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure><p>至此，简单的 Hexo 博客框架就完成搭建了，至于更多的美化可以参考：</p><blockquote><p><a href="http://luciferlpc.top/post/794f2e6e.html">Butterfly 主题美化合集</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> 阿里云 </tag>
            
            <tag> GitHub Pages </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>时光不负，对我来说不寻常的一年 | 2021 年终总结</title>
      <link href="/post/6c952b6c.html"/>
      <url>/post/6c952b6c.html</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>大家好呀，我是博主 <code>Lucifer三思而后行</code>，😊 江湖人送外号：<b><code>三哥</code></b>，爱看海贼王，喜欢 <code>索隆</code> 和 <code>艾斯</code>。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/ab2f076c9595ff1b1914eadcaa28db61.png"></p><p>⌚️ 时光荏苒，如指尖的流沙，通过文字记录一个又一个难忘的瞬间；<code>2021</code> 已然接近尾声，回头盘点过去的一年，年初的Flag 🚩实现了哪些？今年又有哪些工作的事情超出预期？生活中有哪些遗憾点滴……</p><h1 id="人生转折"><a href="#人生转折" class="headerlink" title="人生转折"></a>人生转折</h1><p>2021 年之前，生活上总体平平淡淡，毕业之后找一份工作，三点一线，乏味的混混日子，打打游戏，健健身，觉得生活也不过如此了，没有太多的抱怨，也没什么太大的包袱，人生简简单单的挺悠闲！（😄 <strong>PS：没错我就是一个咸鱼！</strong>）所以是什么导致这么佛系的我走上了自媒体创作这条道路呢？</p><p><strong><font color='orage'>转折点 🪜 我是怎么接触到写作平台和自媒体创作的呢？</font></strong></p><p>由于我平时工作经常会遇到一些问题以及解决方案，当时想着写下来记录作为笔记，思来想去觉得还是放在博客平台上比较方便，可以随时随地的查阅。然而，一次偶然的机会，在 <code>CSDN</code> 上写的笔记文章 🔥 了，突然多了几十个粉丝，仿佛给我平淡的生活注射💉了一剂 ”强心针”！</p><p>没想到我随手写的工作笔记竟然也能火，通过和粉丝的交流沟通发现，我的文章有帮助到他们很多，得到了粉丝的赞美和鼓励之后，我决定了要好好开始创作。</p><p>慢慢地，从 <strong>CSDN</strong> 的 <code>新星计划前十</code>到 <code>原力计划作者</code>，渐渐成为了 <strong>万粉博主</strong>。后来被掘金运营邀请来掘金写文章，又自己开了公众号，慢慢的走上互联网写作的道路，也多了一个称号：<code>博主</code>。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/4b35aa7de3323b4cc55ab692c8f28e99.png"></p><h1 id="关于写作"><a href="#关于写作" class="headerlink" title="关于写作"></a>关于写作</h1><p>满打满算，目前为止我也写了有一年多的文章了，总体感觉来说：写作过程枯燥且耗费时间，写完之后的成就感却令人满足，每一篇文章都像是一个”孩子“般。</p><p><strong>疑问❓新手适合创作吗？</strong></p><p>个人觉得，写作是不分新手和老手的，只要你输出的内容是正向且有用的，你就是在创作，<strong>个人拙见，有口勿喷</strong>；老手无非就是思路上更清晰，排版更加整洁，这些都是可以后期培养的，每个人都有自己的写作风格。<strong>重要的是你要开始写，不管写什么，只要坚持下去，就可以慢慢写出干货！</strong></p><p>我的文章大多数都是<code>偏实战性</code>的技术文章，以思路清晰和过程详细著称。当然了，这背后离不开我一篇文章要做 <code>2-3</code> 遍实战操作，尽量做到思路清晰，一个命令一个截图，高亮备注，以确保文章没有错误和逻辑问题，能够让读者跟着文章操作就可以得到想要的结果，而不是像我自己学习时遇到的各种坑，一步一个错。属于极其良心的博主了，<strong>还不关注一波，以兹鼓励？</strong></p><p>当然了，如果你有优秀的文章，但是自己不想发，可以投稿给我哦，让更多的人看到！🎉</p><p><img src="https://img-blog.csdnimg.cn/img_convert/59e997b79d90f4ef331c8cdd4b3de26b.png"></p><h1 id="技术进步"><a href="#技术进步" class="headerlink" title="技术进步"></a>技术进步</h1><p>很多朋友会问，你哪来那么多干货来输出？感觉每篇文章都很干货，是怎么做到的？</p><p><strong>答案：</strong> 天底下没有白来的知识，当然是逼着自己输入呀，以前玩游戏刷抖音的时间，现在坐在电脑前学习，一学就是一天，根本停不下来。毕竟，每天那么多 “嗷嗷待哺” 的粉丝在催更呢，输出倒逼输入，强迫自己学习，高效利用时间。</p><p>写了一年多文章，技术上确实进步了不少，从以前懵懵懂懂的小白，进化成了满腹干货的博主，平时还能给大家解决一些疑难杂症了，自学上是没什么大的问题，基本遇到问题都可以自行解决，说到问问题，这里分享一个提问问题的思维导图：</p><p><img src="https://img-blog.csdnimg.cn/img_convert/d04a595994b3de842fbf5b364904e20b.png"></p><p>希望大家都能有所收获，有时候并非大家不想理你，而是你的方式不对！</p><h1 id="白嫖福利"><a href="#白嫖福利" class="headerlink" title="白嫖福利"></a>白嫖福利</h1><p>自媒体创作有什么福利吗？或者说可以作为一门副业吗？<strong>答案：肯定的！</strong></p><p><strong>🎁 为什么写文章还会有福利呢？</strong></p><p>很好奇吧？我没接触到这一区域的时候，我也是不知道的。其实很简单，由于现在网络上有很多写作平台，再加上现在一个内卷化很严重的社会现象，导致各大平台都开展了很多很多的活动来吸引创作者们在他们的平台上发文创作。</p><p>我参加过活动比较多，经常写作，也算良心的几个平台来说 [<code>排名不分先后</code>]：</p><ul><li>掘金</li><li>墨天轮</li><li>华为云</li><li>CSDN</li></ul><p>就给大家各个展开说说吧！</p><h2 id="掘金"><a href="#掘金" class="headerlink" title="掘金"></a>掘金</h2><p>我的掘金主页，👏🏻 欢迎大家关注 <a href="https://juejin.cn/user/4169810296974189">🔗 Lucifer三思而后行</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/db635adb204f74373cb37f0ba02f1c3d.png"></p><p>掘金是我在全网有了万粉之后，才开始在掘金写作的，当时是被掘金运营人员邀请来的（<strong>PS：我才不会告诉你其实是因为掘金那数不胜数的福利活动和奖品</strong>），确实，掘金的奖品是最丰厚的，一度被戏称为：<code>批发市场，兄弟又去掘金进货了？</code>！哈哈开个玩笑，不过确实掘金这方面还是很大方的，各种奖品薅了不少，因为我没有拍照片，这里借用一张朋友的图片给大家展示一下，<strong>有过之而无不及！</strong></p><p><img src="https://img-blog.csdnimg.cn/img_convert/5b68e074a32953f309682c7a6e4b64cc.png"></p><p><strong>我在掘金参加过的活动：</strong></p><ul><li><a href="https://juejin.cn/post/6967194882926444557">6月更文挑战</a> 由于刚来掘金，得了个 <code>三等奖</code>；</li><li><a href="https://juejin.cn/post/6978685539985653767">7月好文征集</a> 荣获<code>第三名</code>，500元大奖；</li><li><a href="https://juejin.cn/post/6979532761954533390">Python主题月活动</a> 得了个 <code>Python 优质作者</code>；</li><li><a href="https://juejin.cn/post/6987962113788493831">8月更文挑战</a> <code>全勤奖</code> + <code>老司机奖</code>；</li><li><a href="https://juejin.cn/post/7005854773941370911">Linux技术专题征文</a> 荣获 <code>第一名</code>；</li><li><a href="https://juejin.cn/post/7008476801634680869">程序员必懂小知识挑战</a> 获得 <code>精英矿工</code> 满勤奖；</li><li><a href="https://juejin.cn/post/7024369534119182367">用代码“吸猫”</a> 拿了个 <code>二等奖</code>；</li><li><a href="https://juejin.cn/post/7023643374569816095">2021最后一次更文挑战</a> <code>满勤奖</code>！</li></ul><p>还有各种周榜月榜的就不一一罗列了，总之感谢掘金让我<code>进了这么多货</code>！</p><h2 id="墨天轮"><a href="#墨天轮" class="headerlink" title="墨天轮"></a>墨天轮</h2><p>我的墨天轮主页，👏🏻 欢迎大家关注 <a href="https://www.modb.pro/u/395407">🔗 Lucifer三思而后行</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/0401680f42ca901d587af825e3244b92.png"></p><p>墨天轮是国内有名的数据库社区，由于我的工作是数据库相关，因此在这个平台活动的也很频繁，经常参加一些活动以及知识的分享，常年蝉联热榜前五，同时也认识了很多忠实粉丝和朋友！当然了，也得到了不少奖品，随便晒几张吧~</p><table><thead><tr><th>🎁 奖品展示</th><th></th></tr></thead><tbody><tr><td><img src="https://img-blog.csdnimg.cn/img_convert/804c049c081c72f45d33e079bc437f99.png"></td><td><img src="https://img-blog.csdnimg.cn/img_convert/6651d48f782e0ba8e4a6388482487df7.png"> </br> <img src="https://img-blog.csdnimg.cn/img_convert/d0243d011bed6d13d4e80dba75aa034d.png"></td></tr></tbody></table><p><strong>我在墨天轮参加过的活动：</strong></p><ul><li><a href="https://www.modb.pro/db/99588">我和达梦的故事</a> 荣获 <code>二等奖</code>；</li><li><a href="https://www.modb.pro/issue">问答模块答主</a> 蝉联 <code>6</code> 期榜首；</li><li><a href="https://www.modb.pro/db/110375">openGauss训练营第二期</a> 顺利结业，取得证书；</li><li><a href="https://www.modb.pro/db/142952">墨力计划</a> 喜提 <code>第一名</code>；</li><li><a href="https://www.modb.pro/db/178828">openGauss每日一练</a> 正在参加，预计满勤；</li><li><a href="https://www.modb.pro/db/181647">Vertica 技术文章征集令</a> 正在努力学习，希望得奖！</li></ul><h2 id="华为云"><a href="#华为云" class="headerlink" title="华为云"></a>华为云</h2><p>我的华为云主页，👏🏻 欢迎大家关注 <a href="https://bbs.huaweicloud.com/community/usersnew/id_1627715368747717">🔗 Lucifer三思而后行</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/11d05dde869eeb2d94f141a9ff5fc01e.png"></p><p>华为云的文章阅读量不高，但是缺失最卷的平台，没有之一！因为他的活动都是按照文章篇数来排名的，可想而知，我被你们卷死了 😭，动不动就是一个月 <code>100</code> 多篇。也算是薅了一些奖品，进了一些货！</p><table><thead><tr><th>🎁 奖品展示</th><th></th></tr></thead><tbody><tr><td><img src="https://img-blog.csdnimg.cn/img_convert/c460f23f925294afa755945224a26a6b.png"></td><td><img src="https://img-blog.csdnimg.cn/img_convert/80dc6a7b685a0ddf486d255ea41a79b2.png"></td></tr></tbody></table><p>在华为云参加的活动就不一一列举了，主要就是每个月的更文活动，谁多谁得奖，我基本都是佛系更几篇，拿个佛系更文奖。</p><h2 id="CSDN"><a href="#CSDN" class="headerlink" title="CSDN"></a>CSDN</h2><p>我的 CSDN 主页，👏🏻 欢迎大家关注 <a href="https://luciferliu.blog.csdn.net/">🔗 Lucifer三思而后行</a></p><p><img src="https://img-blog.csdnimg.cn/img_convert/e1c65ce59aa05d36e8cc671e139a2507.png"></p><p>CSDN 算是我今年收获最大的平台了，收获了近 <code>5w</code> 粉丝儿，虽然没有白嫖到啥奖品，但是这是我写作的起源地，还是有些感慨的，这一年平台改变了不少，期待做的越来越好，虽然大家对他的口碑依然不是很好，我还是给个大拇哥👍 ，<strong>吃水不忘挖井人</strong>！</p><p><strong>我在 CSDN 参加过的活动：</strong></p><ul><li><a href="https://blog.csdn.net/blogdevteam/article/details/118392106">新星计划</a> 获得<code>前十名</code>，出道之战，尤为艰辛，内卷至极；</li><li><a href="https://bss.csdn.net/m/topic/force">原力计划</a> 官方流量扶持，增强文章曝光，良心增粉计划；</li><li><a href="">CSDN1024直播间神评活动</a> 获得前 50 名！</li></ul><p>CSDN 的活动相对来说不是很多，全靠博主自行发展，但是有全站热榜，所以内卷程度也很高！</p><p><img src="https://img-blog.csdnimg.cn/img_convert/57290808fe6d377092500715d8761b48.png"></p><h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>总结回望下来，发现自从开始创作之后，每一天都过得满满当当，再也没有当初的悠闲日子，游戏也不打了，直播也只看技术直播了，充实的有点过分。每天不是在学习的路上，就是在写作的路上！</p><p>当然了，大家如果也想要写文章搞副业，一定要在主业做好的前提下哦，毕竟还是要分清主次的呀！</p><p><strong>最后，祝大家年年有今日，岁岁有今朝，2022 暴富，变美，变瘦，走上人生巅峰~</strong></p><p><img src="https://img-blog.csdnimg.cn/img_convert/441de2ac9622a639c4ab8d182d11de9c.png"></p>]]></content>
      
      
      <categories>
          
          <category> 年终总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 年终总结 </tag>
            
            <tag> 2021 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
